<html>
    <head>
        <title> Output </title>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
    </head>
    <body>
        <p><h2> eudtrg\__init__.py : 6 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.varfunc</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.ctrlstru</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.stdfunc</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.maprw</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\__init__.py : 6 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.allocator</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.eudobj</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.trigger</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.mapdata</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\allocator\payload.py : 128 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">rlocint</span><span class="p">,</span> <span class="n">pbuffer</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">scaddr</span>


<span class="n">_searched_objects</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">_searched_objects_set</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">_unsearched_objects</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">_alloctable</span> <span class="o">=</span> <span class="bp">None</span>


<span class="k">class</span> <span class="nc">ObjCollector</span><span class="p">:</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Object having PayloadBuffer-like interfaces. Collects all objects by</span>
<span class="sd">    calling RegisterObject() for every related objects.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">StartWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">EndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">WriteByte</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">WriteWord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">WriteDword</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="n">scaddr</span><span class="o">.</span><span class="n">Evaluate</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">WritePack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structformat</span><span class="p">,</span> <span class="o">*</span><span class="n">arglist</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">arglist</span><span class="p">:</span>
            <span class="n">scaddr</span><span class="o">.</span><span class="n">Evaluate</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">WriteBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">pass</span>


<span class="n">PHASE_COLLECTING</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">PHASE_WRITING</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">phase</span> <span class="o">=</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">CollectObjects</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">phase</span>
    <span class="k">global</span> <span class="n">_searched_objects</span><span class="p">,</span> <span class="n">_searched_objects_set</span>
    <span class="k">global</span> <span class="n">_unsearched_objects</span>

    <span class="n">phase</span> <span class="o">=</span> <span class="n">PHASE_COLLECTING</span>

    <span class="n">objc</span> <span class="o">=</span> <span class="n">ObjCollector</span><span class="p">()</span>
    <span class="n">_searched_objects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_searched_objects_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">_unsearched_objects</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c"># _unsearched_objects.append(root) won&#39;t work here, since root can also be</span>
    <span class="c"># Forward() object pointing to Trigger(). Forward().WritePayload() is not</span>
    <span class="c"># defined.</span>
    <span class="c"># Instead, we evaluate root to register objects associated with root to</span>
    <span class="c"># register naturally with GetObjectAddr()</span>
    <span class="n">scaddr</span><span class="o">.</span><span class="n">Evaluate</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">_unsearched_objects</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">_unsearched_objects</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">_searched_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">_searched_objects_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">WritePayload</span><span class="p">(</span><span class="n">objc</span><span class="p">)</span>

    <span class="n">_searched_objects_set</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">ConstructPayload</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">phase</span>
    <span class="k">global</span> <span class="n">_searched_objects</span>
    <span class="k">global</span> <span class="n">_alloctable</span>

    <span class="n">phase</span> <span class="o">=</span> <span class="n">PHASE_WRITING</span>
    <span class="n">pbuf</span> <span class="o">=</span> <span class="n">pbuffer</span><span class="o">.</span><span class="n">PayloadBuffer</span><span class="p">()</span>

    <span class="n">_alloctable</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">lastoffset</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">_searched_objects</span><span class="p">:</span>
        <span class="n">objsize</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetDataSize</span><span class="p">()</span>
        <span class="n">objaddr</span> <span class="o">=</span> <span class="n">lastoffset</span>
        <span class="n">lastoffset</span> <span class="o">+=</span> <span class="p">(</span><span class="n">objsize</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">3</span>
        <span class="n">_alloctable</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">objaddr</span><span class="p">,</span> <span class="n">objsize</span><span class="p">]</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Registering object </span><span class="si">%s</span><span class="s"> at 0x</span><span class="si">%08X</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">objaddr</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">_searched_objects</span><span class="p">:</span>
        <span class="n">objsize</span> <span class="o">=</span> <span class="n">_alloctable</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">pbuf</span><span class="o">.</span><span class="n">StartWrite</span><span class="p">()</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">WritePayload</span><span class="p">(</span><span class="n">pbuf</span><span class="p">)</span>
        <span class="n">written_byten</span> <span class="o">=</span> <span class="n">pbuf</span><span class="o">.</span><span class="n">EndWrite</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">written_byten</span> <span class="o">==</span> <span class="n">objsize</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;obj.GetDataSize()(</span><span class="si">%d</span><span class="s">) != Real payload size(</span><span class="si">%d</span><span class="s">)&#39;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">objsize</span><span class="p">,</span> <span class="n">written_byten</span><span class="p">))</span>

    <span class="n">phase</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">pbuf</span><span class="o">.</span><span class="n">CreatePayload</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">CreatePayload</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
    <span class="n">CollectObjects</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ConstructPayload</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">GetObjectAddr</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">_alloctable</span>
    <span class="k">global</span> <span class="n">_searched_objects</span>
    <span class="k">global</span> <span class="n">_unsearched_objects</span>

    <span class="k">if</span> <span class="n">phase</span> <span class="o">==</span> <span class="n">PHASE_COLLECTING</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_searched_objects</span><span class="p">:</span>
            <span class="n">_unsearched_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rlocint</span><span class="o">.</span><span class="n">RlocInt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">phase</span> <span class="o">==</span> <span class="n">PHASE_WRITING</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">rlocint</span><span class="o">.</span><span class="n">RlocInt</span><span class="p">(</span><span class="n">_alloctable</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\allocator\pbuffer.py : 144 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">scaddr</span><span class="p">,</span> <span class="n">rlocint</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">binio</span>


<span class="k">class</span> <span class="nc">Payload</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">prttable</span><span class="p">,</span> <span class="n">orttable</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prttable</span> <span class="o">=</span> <span class="n">prttable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orttable</span> <span class="o">=</span> <span class="n">orttable</span>


<span class="n">_packerlist</span> <span class="o">=</span> <span class="p">{}</span>


<span class="k">class</span> <span class="nc">PayloadBuffer</span><span class="p">:</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Buffer where EUDObject should write to.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datalen</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prttable</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orttable</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tablebr</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prttable</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orttable</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">StartWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datastart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datalen</span>

    <span class="k">def</span> <span class="nf">EndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">written_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datalen</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datastart</span>
        <span class="n">padding_byten</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">written_bytes</span> <span class="o">&amp;</span> <span class="mh">0x3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">WriteBytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">padding_byten</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">written_bytes</span>

    <span class="k">def</span> <span class="nf">WriteByte</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">scaddr</span><span class="o">.</span><span class="n">Evaluate</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">number</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;Non-constant given.&#39;</span>
        <span class="n">number</span><span class="o">.</span><span class="n">offset</span> <span class="o">&amp;=</span> <span class="mh">0xFF</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_datas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binio</span><span class="o">.</span><span class="n">i2b1</span><span class="p">(</span><span class="n">number</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datalen</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">WriteWord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">scaddr</span><span class="o">.</span><span class="n">Evaluate</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">number</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;Non-constant given.&#39;</span>
        <span class="n">number</span><span class="o">.</span><span class="n">offset</span> <span class="o">&amp;=</span> <span class="mh">0xFFFF</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_datas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binio</span><span class="o">.</span><span class="n">i2b2</span><span class="p">(</span><span class="n">number</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datalen</span> <span class="o">+=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">WriteDword</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">scaddr</span><span class="o">.</span><span class="n">Evaluate</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
        <span class="n">number</span><span class="o">.</span><span class="n">offset</span> <span class="o">&amp;=</span> <span class="mh">0xFFFFFFFF</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&#39;0x</span><span class="si">%08X</span><span class="s"> : </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_datalen</span><span class="p">,</span> <span class="n">number</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">number</span><span class="o">.</span><span class="n">rlocmode</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tablebr</span><span class="p">[</span><span class="n">number</span><span class="o">.</span><span class="n">rlocmode</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_datalen</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_datas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binio</span><span class="o">.</span><span class="n">i2b4</span><span class="p">(</span><span class="n">number</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datalen</span> <span class="o">+=</span> <span class="mi">4</span>

    <span class="k">def</span> <span class="nf">WritePack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structformat</span><span class="p">,</span> <span class="o">*</span><span class="n">arglist</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        ======= =======</span>
<span class="sd">          Char   Type</span>
<span class="sd">        ======= =======</span>
<span class="sd">           B     Byte</span>
<span class="sd">           H     Word</span>
<span class="sd">           I     Dword</span>
<span class="sd">        ======= =======</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="n">structformat</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_packerlist</span><span class="p">:</span>
            <span class="n">_packerlist</span><span class="p">[</span><span class="n">structformat</span><span class="p">]</span> <span class="o">=</span> <span class="n">_CreateStructPacker</span><span class="p">(</span><span class="n">structformat</span><span class="p">)</span>

        <span class="n">_packerlist</span><span class="p">[</span><span class="n">structformat</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arglist</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">WriteBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Write bytes object to buffer.</span>

<span class="sd">        :param b: bytes object to write.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datalen</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="c"># Internally used</span>
    <span class="k">def</span> <span class="nf">CreatePayload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Payload</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_datas</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prttable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orttable</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_CreateStructPacker</span><span class="p">(</span><span class="n">structformat</span><span class="p">):</span>
    <span class="n">sizedict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;B&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;I&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
    <span class="n">anddict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;B&#39;</span><span class="p">:</span> <span class="mh">0xff</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">:</span> <span class="mh">0xffff</span><span class="p">,</span> <span class="s">&#39;I&#39;</span><span class="p">:</span> <span class="mh">0xffffffff</span><span class="p">}</span>

    <span class="n">dataoffsetlist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">andvallist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sizelist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">structlen</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">structformat</span><span class="p">:</span>
        <span class="n">datasize</span> <span class="o">=</span> <span class="n">sizedict</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
        <span class="n">dataoffsetlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">structlen</span><span class="p">)</span>
        <span class="n">structlen</span> <span class="o">+=</span> <span class="n">datasize</span>

        <span class="n">andvallist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">anddict</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
        <span class="n">sizelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datasize</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">packer</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="o">*</span><span class="n">arglist</span><span class="p">):</span>
        <span class="n">dlen</span> <span class="o">=</span> <span class="n">buf</span><span class="o">.</span><span class="n">_datalen</span>

        <span class="n">evals</span> <span class="o">=</span> <span class="p">[</span><span class="n">scaddr</span><span class="o">.</span><span class="n">Evaluate</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">arglist</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ri</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">evals</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">ri</span><span class="p">)</span> <span class="ow">is</span> <span class="n">rlocint</span><span class="o">.</span><span class="n">RlocInt</span>
        <span class="n">evalnum</span> <span class="o">=</span> <span class="p">[</span><span class="n">ri</span><span class="o">.</span><span class="n">offset</span> <span class="o">&amp;</span> <span class="n">andvallist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ri</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">evals</span><span class="p">)]</span>

        <span class="c"># 1. Add binary data</span>
        <span class="n">packed</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">structformat</span><span class="p">,</span> <span class="o">*</span><span class="n">evalnum</span><span class="p">)</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">_datas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">packed</span><span class="p">)</span>

        <span class="c"># 2. Update relocation table</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ri</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">evals</span><span class="p">):</span>
            <span class="k">assert</span> <span class="p">(</span><span class="n">ri</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">sizelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">ri</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">buf</span><span class="o">.</span><span class="n">_prttable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dlen</span> <span class="o">+</span> <span class="n">dataoffsetlist</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">ri</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">buf</span><span class="o">.</span><span class="n">_orttable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dlen</span> <span class="o">+</span> <span class="n">dataoffsetlist</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">buf</span><span class="o">.</span><span class="n">_datalen</span> <span class="o">+=</span> <span class="n">structlen</span>

    <span class="k">return</span> <span class="n">packer</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\allocator\rlocint.py : 68 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">RlocInt</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">rlocmode</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rlocmode</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="p">(</span>
            <span class="s">&#39;Invalid argument for RlocInt constructor&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">=</span> <span class="n">rlocmode</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">toRlocInt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">RlocInt</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">rlocmode</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">toRlocInt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">RlocInt</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">rlocmode</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">other</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">toRlocInt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">toRlocInt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;Cannot multiply two non-const RlocInts&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">RlocInt</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">rlocmode</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">toRlocInt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">other</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;Cannot divide RlocInt with non-const&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;Divide by zero&#39;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">%</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">%</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">(</span>
            <span class="s">&#39;RlocInt not divisible by </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">RlocInt</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">//</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">//</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;Rlocint(0x</span><span class="si">%08X</span><span class="s">, </span><span class="si">%d</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">toRlocInt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">RlocInt</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">RlocInt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\allocator\scaddr.py : 116 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">rlocint</span>


<span class="k">class</span> <span class="nc">SCMemAddr</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseobj</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rlocmode</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span> <span class="o">=</span> <span class="n">baseobj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">=</span> <span class="n">rlocmode</span>

    <span class="k">def</span> <span class="nf">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="k">return</span> <span class="n">SCMemAddr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="k">return</span> <span class="n">SCMemAddr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SCMemAddr</span><span class="p">):</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">baseobj</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">rlocmode</span><span class="p">),</span> <span class="p">(</span>
                <span class="s">&#39;Cannot subtract between addresses btw two objects&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SCMemAddr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">-</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SCMemAddr</span><span class="p">):</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">baseobj</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">rlocmode</span><span class="p">),</span> <span class="p">(</span>
                <span class="s">&#39;Cannot subtract between addresses btw two distinct objects&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SCMemAddr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span><span class="p">,</span> <span class="n">other</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="k">return</span> <span class="n">SCMemAddr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="k">return</span> <span class="n">SCMemAddr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">%</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">%</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">(</span>
            <span class="s">&#39;Address not divisible&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SCMemAddr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">//</span> <span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlocmode</span> <span class="o">//</span> <span class="n">k</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Forward</span><span class="p">(</span><span class="n">SCMemAddr</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39; Class for late definition</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__lshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;Reforwarding without reset is not allowed&#39;</span>
        <span class="k">assert</span> <span class="n">expr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;Cannot forward to None&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span> <span class="o">=</span> <span class="n">expr</span>
        <span class="k">return</span> <span class="n">expr</span>

    <span class="k">def</span> <span class="nf">IsSet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">Reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;Forward not initialized&#39;</span>
        <span class="k">return</span> <span class="n">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Evaluate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Evaluate expressions</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">rlocint</span><span class="o">.</span><span class="n">RlocInt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">Evaluate</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">IsValidSCMemAddr</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">SCMemAddr</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\allocator\__init__.py : 11 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.scaddr</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SCMemAddr</span><span class="p">,</span>
    <span class="n">Forward</span><span class="p">,</span>
    <span class="n">Evaluate</span><span class="p">,</span>
    <span class="n">IsValidSCMemAddr</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.payload</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CreatePayload</span>
<span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\eudobj\bytedump.py : 15 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.eudobj</span> <span class="kn">import</span> <span class="n">EUDObject</span>


<span class="k">class</span> <span class="nc">Db</span><span class="p">(</span><span class="n">EUDObject</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">GetDataSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">WritePayload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbuffer</span><span class="p">):</span>
        <span class="n">pbuffer</span><span class="o">.</span><span class="n">WriteBytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\eudobj\eudobj.py : 21 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..allocator</span> <span class="kn">import</span> <span class="n">SCMemAddr</span>
<span class="kn">from</span> <span class="nn">..allocator.payload</span> <span class="kn">import</span> <span class="n">GetObjectAddr</span>


<span class="k">class</span> <span class="nc">EUDObject</span><span class="p">(</span><span class="n">SCMemAddr</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;Class for standalone object</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">GetObjectAddr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">GetDataSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;Override&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">WritePayload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbuffer</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;Override&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\eudobj\__init__.py : 3 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.eudobj</span> <span class="kn">import</span> <span class="n">EUDObject</span>
<span class="kn">from</span> <span class="nn">.bytedump</span> <span class="kn">import</span> <span class="n">Db</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\mapdata\chktok.py : 131 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130</pre></div></td><td class="code"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">scenario.chk section tokenizer. Internally used in eudtrg.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">ubconv</span><span class="p">,</span> <span class="n">binio</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">General CHK class.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">sectionname_format</span><span class="p">(</span><span class="n">sn</span><span class="p">):</span>
    <span class="n">sn</span> <span class="o">=</span> <span class="n">ubconv</span><span class="o">.</span><span class="n">u2b</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">sn</span> <span class="o">+=</span> <span class="n">b</span><span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">sn</span><span class="p">))</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&#39;Length of section name cannot be longer than 4&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sn</span>


<span class="k">class</span> <span class="nc">CHK</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">loadblank</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">loadchk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="c"># this code won&#39;t handle protection methods properly such as...</span>
        <span class="c">#  - duplicate section name</span>
        <span class="c">#  - jump section protection</span>
        <span class="c">#</span>
        <span class="c"># this program although handles</span>
        <span class="c">#  - invalid section length (too high)</span>
        <span class="c">#  - unused sections</span>

        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span>  <span class="c"># temporarilly store</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="c"># read data</span>
            <span class="n">sectionname</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">index</span><span class="p">:</span> <span class="n">index</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">sectionlength</span> <span class="o">=</span> <span class="n">binio</span><span class="o">.</span><span class="n">b2i4</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">sectionlength</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c"># jsp with negative section size.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">t</span>
                <span class="k">return</span> <span class="bp">False</span>

            <span class="n">section</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">8</span><span class="p">:</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">sectionlength</span><span class="p">]</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="n">sectionlength</span> <span class="o">+</span> <span class="mi">8</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">sectionname</span><span class="p">]</span> <span class="o">=</span> <span class="n">section</span>

        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">savechk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># calculate output size</span>
        <span class="n">blist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">binary</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">blist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="n">binio</span><span class="o">.</span><span class="n">i2b4</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">binary</span><span class="p">))</span> <span class="o">+</span> <span class="n">binary</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">blist</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">enumsection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">getsection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sectionname</span><span class="p">):</span>
        <span class="n">sectionname</span> <span class="o">=</span> <span class="n">sectionname_format</span><span class="p">(</span><span class="n">sectionname</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">sectionname</span><span class="p">]</span>  <span class="c"># Nameerror may be raised.</span>

    <span class="k">def</span> <span class="nf">setsection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sectionname</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">sectionname</span> <span class="o">=</span> <span class="n">sectionname_format</span><span class="p">(</span><span class="n">sectionname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">sectionname</span><span class="p">]</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delsection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sectionname</span><span class="p">):</span>
        <span class="n">sectionname</span> <span class="o">=</span> <span class="n">sectionname_format</span><span class="p">(</span><span class="n">sectionname</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">sectionname</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">optimize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c"># Delete unused sections</span>
        <span class="n">used_section</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">b</span><span class="s">&#39;VER &#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;VCOD&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;OWNR&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;ERA &#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;DIM &#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;SIDE&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;MTXM&#39;</span><span class="p">,</span>
            <span class="n">b</span><span class="s">&#39;UNIT&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;THG2&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;MASK&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;STR &#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;UPRP&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;MRGN&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;TRIG&#39;</span><span class="p">,</span>
            <span class="n">b</span><span class="s">&#39;MBRF&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;SPRP&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;FORC&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;COLR&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;PUNI&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;PUPx&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;PTEx&#39;</span><span class="p">,</span>
            <span class="n">b</span><span class="s">&#39;UNIx&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;UPGx&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s">&#39;TECx&#39;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">unused_section</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">sn</span> <span class="k">for</span> <span class="n">sn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">sn</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used_section</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">sn</span> <span class="ow">in</span> <span class="n">unused_section</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">sn</span><span class="p">]</span>

        <span class="c"># Terrain optimization</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getsection</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;DIM &#39;</span><span class="p">)</span>
        <span class="n">mapw</span> <span class="o">=</span> <span class="n">binio</span><span class="o">.</span><span class="n">b2i2</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">maph</span> <span class="o">=</span> <span class="n">binio</span><span class="o">.</span><span class="n">b2i2</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">terrainsize</span> <span class="o">=</span> <span class="n">mapw</span> <span class="o">*</span> <span class="n">maph</span>

        <span class="c"># MASK optimization : cancel 0xFFs.</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getsection</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;MASK&#39;</span><span class="p">)</span>
        <span class="n">clippos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">terrainsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mh">0xff</span><span class="p">:</span>
                <span class="n">clippos</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">break</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">[:</span><span class="n">clippos</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setsection</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;MASK&#39;</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

        <span class="c"># MTXM optimization</span>
        <span class="c"># MASK optimization : cancel 0xFFs.</span>
        <span class="n">mtxm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getsection</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;MTXM&#39;</span><span class="p">)</span>
        <span class="n">clippos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">terrainsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mtxm</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mh">0x00</span> <span class="ow">or</span> <span class="n">mtxm</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mh">0x00</span><span class="p">:</span>
                <span class="n">clippos</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">break</span>

        <span class="n">mtxm</span> <span class="o">=</span> <span class="n">mtxm</span><span class="p">[:</span><span class="mi">2</span> <span class="o">*</span> <span class="n">clippos</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setsection</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;MTXM&#39;</span><span class="p">,</span> <span class="n">mtxm</span><span class="p">)</span>

        <span class="c"># More optimization would be possible, but I don&#39;t care.</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\mapdata\mapdata.py : 34 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.stringmap</span> <span class="kn">import</span> <span class="n">InitStringMap</span><span class="p">,</span> <span class="n">ApplyStringMap</span>
<span class="kn">from</span> <span class="nn">.proptable</span> <span class="kn">import</span> <span class="n">InitPropertyMap</span><span class="p">,</span> <span class="n">ApplyPropertyMap</span>

<span class="n">_inited</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">_chkt</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">_rawfile</span> <span class="o">=</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">InitMapData</span><span class="p">(</span><span class="n">chkt</span><span class="p">,</span> <span class="n">rawfile</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">_inited</span><span class="p">,</span> <span class="n">_chkt</span><span class="p">,</span> <span class="n">_rawfile</span>
    <span class="n">_chkt</span> <span class="o">=</span> <span class="n">chkt</span>
    <span class="n">_rawfile</span> <span class="o">=</span> <span class="n">rawfile</span>

    <span class="n">InitStringMap</span><span class="p">(</span><span class="n">chkt</span><span class="p">)</span>
    <span class="n">InitPropertyMap</span><span class="p">(</span><span class="n">chkt</span><span class="p">)</span>
    <span class="n">_inited</span> <span class="o">=</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">UpdateMapData</span><span class="p">():</span>
    <span class="n">ApplyStringMap</span><span class="p">(</span><span class="n">_chkt</span><span class="p">)</span>
    <span class="n">ApplyPropertyMap</span><span class="p">(</span><span class="n">_chkt</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">IsMapdataInitalized</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">_inited</span>


<span class="k">def</span> <span class="nf">GetChkTokenized</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">_chkt</span>


<span class="k">def</span> <span class="nf">GetRawFile</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">_rawfile</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\mapdata\mpqapi.py : 257 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256</pre></div></td><td class="code"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">SFmpq.dll wrapper. Used internally inside eudtrg.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># @UnusedWildImport</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">..utils.ubconv</span> <span class="kn">import</span> <span class="n">u2b</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">find where sfmpq.dll is.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c"># These can be an argument to for MpqWrite.PutWave</span>
<span class="n">WAVCOMP_NOCOMPRESSION</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">WAVCOMP_HIGHQUALITY</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">WAVCOMP_MIDQUALITY</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">WAVCOMP_LOWQUALITY</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">SFmpq</span> <span class="o">=</span> <span class="bp">None</span>

<span class="n">currentdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">InitMpqLibrary</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">SFmpq</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">struct</span><span class="o">.</span><span class="n">calcsize</span><span class="p">(</span><span class="s">&quot;P&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>  <span class="c"># 32bit</span>
            <span class="n">SFmpq</span> <span class="o">=</span> <span class="n">WinDLL</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">currentdir</span><span class="p">,</span> <span class="s">&#39;SFmpq32.dll&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">SFmpq</span> <span class="o">=</span> <span class="n">WinDLL</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">currentdir</span><span class="p">,</span> <span class="s">&#39;SFmpq64.dll&#39;</span><span class="p">))</span>

        <span class="c"># for MpqRead</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileOpenArchive</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileCloseArchive</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileOpenFileEx</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileGetFileSize</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileReadFile</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileCloseFile</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>

        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileOpenArchive</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_void_p</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileCloseArchive</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileOpenFileEx</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_void_p</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileGetFileSize</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_void_p</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileReadFile</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_int</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileCloseFile</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">]</span>

        <span class="c"># for MpqWrite</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqOpenArchiveForUpdate</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqAddFileFromBuffer</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqAddWaveFromBuffer</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqRenameFile</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqDeleteFile</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqCloseUpdatedArchive</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqCompactArchive</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>

        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqOpenArchiveForUpdate</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqAddFileFromBuffer</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_int</span><span class="p">,</span> <span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqAddWaveFromBuffer</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_int</span><span class="p">,</span> <span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqRenameFile</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqDeleteFile</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqCloseUpdatedArchive</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>
        <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqCompactArchive</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Loading SFmpq failed.&#39;</span><span class="p">)</span>
        <span class="n">SFmpq</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">False</span>


<span class="k">class</span> <span class="nc">MpqRead</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SFmpq</span> <span class="o">=</span> <span class="n">SFmpq</span>  <span class="c"># SFmpq are global variable. We cannot rely on it</span>

    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">Open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;double open&quot;</span><span class="p">)</span>

        <span class="n">h</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileOpenArchive</span><span class="p">(</span><span class="n">u2b</span><span class="p">(</span><span class="n">fname</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">Close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileCloseArchive</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">EnumFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># using listfile.</span>
        <span class="n">lst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Extract</span><span class="p">(</span><span class="s">&#39;(listfile)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lst</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="n">lst</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="c"># Open file</span>
        <span class="n">fileh</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileOpenFileEx</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">,</span> <span class="n">u2b</span><span class="p">(</span><span class="n">fname</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">fileh</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="n">fileh</span> <span class="o">=</span> <span class="n">fileh</span><span class="o">.</span><span class="n">value</span>

        <span class="c"># Get file size &amp; allocate buffer</span>
        <span class="c"># Note : this version only supports 32bit mpq file</span>
        <span class="n">fsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileGetFileSize</span><span class="p">(</span><span class="n">fileh</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="n">fsize</span><span class="p">)</span>
        <span class="n">readleft</span> <span class="o">=</span> <span class="n">fsize</span>
        <span class="n">read</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c"># read data</span>
        <span class="k">while</span> <span class="n">readleft</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">buffer</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="n">readleft</span><span class="p">)</span>
            <span class="n">readbyte</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">()</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileReadFile</span><span class="p">(</span>
                <span class="n">fileh</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">,</span> <span class="n">readleft</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">readbyte</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">readbyte</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="n">readleft</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span> <span class="ow">or</span> <span class="n">readbyte</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c"># read failed</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileCloseFile</span><span class="p">(</span><span class="n">fileh</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">None</span>

            <span class="n">f</span><span class="p">[</span><span class="n">read</span><span class="p">:</span><span class="n">read</span> <span class="o">+</span> <span class="n">readbyte</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="nb">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">readbyte</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
            <span class="n">readleft</span> <span class="o">-=</span> <span class="n">readbyte</span><span class="o">.</span><span class="n">value</span>
            <span class="n">read</span> <span class="o">+=</span> <span class="n">readbyte</span><span class="o">.</span><span class="n">value</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SFmpq</span><span class="o">.</span><span class="n">SFileCloseFile</span><span class="p">(</span><span class="n">fileh</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">raw</span>


<span class="c"># flags internally used by MpqWrite</span>
<span class="n">MOAU_OPEN_ALWAYS</span> <span class="o">=</span> <span class="mh">0x20</span>
<span class="n">MOAU_CREATE_ALWAYS</span> <span class="o">=</span> <span class="mh">0x08</span>
<span class="n">MOAU_MAINTAIN_LISTFILE</span> <span class="o">=</span> <span class="mh">0x01</span>

<span class="n">MAFA_MODCRYPTKEY</span> <span class="o">=</span> <span class="mh">0x00020000</span>
<span class="n">MAFA_ENCRYPT</span> <span class="o">=</span> <span class="mh">0x00010000</span>
<span class="n">MAFA_COMPRESS</span> <span class="o">=</span> <span class="mh">0x00000200</span>
<span class="n">MAFA_REPLACE_EXISTING</span> <span class="o">=</span> <span class="mh">0x00000001</span>
<span class="n">MAFA_COMPRESS_STANDARD</span> <span class="o">=</span> <span class="mh">0x08</span>

<span class="c"># NEVER USE THESE FOR MpqWrite.PutWave!!!!!!</span>
<span class="n">MAWA_QUALITY_HIGH</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">MAWA_QUALITY_MEDIUM</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">MAWA_QUALITY_LOW</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">WaveCmpDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">WAVCOMP_NOCOMPRESSION</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">WAVCOMP_HIGHQUALITY</span><span class="p">:</span> <span class="n">MAWA_QUALITY_HIGH</span><span class="p">,</span>
    <span class="n">WAVCOMP_MIDQUALITY</span><span class="p">:</span> <span class="n">MAWA_QUALITY_MEDIUM</span><span class="p">,</span>
    <span class="n">WAVCOMP_LOWQUALITY</span><span class="p">:</span> <span class="n">MAWA_QUALITY_LOW</span>
<span class="p">}</span>
<span class="c"># NEVER USE THESE FOR MpqWrite.PutWave!!!!!!</span>


<span class="k">class</span> <span class="nc">MpqWrite</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">Open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">preserve_content</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;double open&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">preserve_content</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="n">MOAU_OPEN_ALWAYS</span> <span class="o">|</span> <span class="n">MOAU_MAINTAIN_LISTFILE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="n">MOAU_CREATE_ALWAYS</span> <span class="o">|</span> <span class="n">MOAU_MAINTAIN_LISTFILE</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqOpenArchiveForUpdate</span><span class="p">(</span><span class="n">u2b</span><span class="p">(</span><span class="n">fname</span><span class="p">),</span> <span class="n">flag</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span> <span class="o">=</span> <span class="n">ret</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">Close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="c"># Close archive</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqCloseUpdatedArchive</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flist</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">PutFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="c"># Replace file if existing</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">MAFA_ENCRYPT</span> <span class="o">|</span> <span class="n">MAFA_COMPRESS</span> <span class="o">|</span> <span class="n">MAFA_REPLACE_EXISTING</span>
        <span class="n">cmptype</span> <span class="o">=</span> <span class="n">MAFA_COMPRESS_STANDARD</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqAddFileFromBufferEx</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">buffer</span><span class="p">),</span> <span class="n">u2b</span><span class="p">(</span><span class="n">fname</span><span class="p">),</span> <span class="n">flag</span><span class="p">,</span> <span class="n">cmptype</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">PutWave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">,</span> <span class="n">complev</span><span class="o">=</span><span class="n">WAVCOMP_LOWQUALITY</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">cmplevel</span> <span class="o">=</span> <span class="n">WaveCmpDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">complev</span><span class="p">,</span> <span class="n">MAWA_QUALITY_HIGH</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmplevel</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PutFile</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">)</span>

        <span class="n">flag</span> <span class="o">=</span> <span class="n">MAFA_ENCRYPT</span> <span class="o">|</span> <span class="n">MAFA_COMPRESS</span> <span class="o">|</span> <span class="n">MAFA_REPLACE_EXISTING</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqAddWaveFromBuffer</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">buffer</span><span class="p">),</span> <span class="n">u2b</span><span class="p">(</span><span class="n">fname</span><span class="p">),</span> <span class="n">flag</span><span class="p">,</span> <span class="n">cmplevel</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">Compact</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">SFmpq</span><span class="o">.</span><span class="n">MpqCompactArchive</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpqh</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">True</span>


<span class="k">if</span> <span class="ow">not</span> <span class="n">InitMpqLibrary</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Cannot load SFmpq.dll. SFmpq not initalized&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\mapdata\proptable.py : 36 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Unit property table manager.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">.unitprp</span> <span class="kn">import</span> <span class="n">UnitProperty</span>

<span class="n">_uprpdict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">_uprptable</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">def</span> <span class="nf">InitPropertyMap</span><span class="p">(</span><span class="n">chkt</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">_prptable</span><span class="p">,</span> <span class="n">_uprpdict</span>
    <span class="n">_uprpdict</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">_uprptable</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">GetPropertyIndex</span><span class="p">(</span><span class="n">prop</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">UnitProperty</span><span class="p">)</span>

    <span class="n">prop</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_uprpdict</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c"># SC counts unit properties from 1. Sucks</span>

    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">uprpindex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_uprptable</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">uprpindex</span> <span class="o">&lt;</span> <span class="mi">64</span><span class="p">,</span> <span class="s">&#39;Unit property table overflow&#39;</span>

        <span class="n">_uprptable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="n">_uprpdict</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">uprpindex</span>
        <span class="k">return</span> <span class="n">uprpindex</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c"># SC counts unit properties from 1. Sucks</span>


<span class="k">def</span> <span class="nf">ApplyPropertyMap</span><span class="p">(</span><span class="n">chkt</span><span class="p">):</span>
    <span class="n">uprpdata</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_uprptable</span><span class="p">)</span> <span class="o">+</span> <span class="nb">bytes</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="p">(</span><span class="mi">64</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">_uprptable</span><span class="p">)))</span>
    <span class="n">chkt</span><span class="o">.</span><span class="n">setsection</span><span class="p">(</span><span class="s">&#39;UPRP&#39;</span><span class="p">,</span> <span class="n">uprpdata</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\mapdata\stringmap.py : 88 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">tblformat</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">b2i2</span><span class="p">,</span> <span class="n">b2i4</span>


<span class="k">class</span> <span class="nc">StringIdMap</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_s2id</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">AddItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">string</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_s2id</span><span class="p">:</span>  <span class="c"># ambigious string</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_s2id</span><span class="p">[</span><span class="n">string</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_s2id</span><span class="p">[</span><span class="n">string</span><span class="p">]</span> <span class="o">=</span> <span class="nb">id</span>

    <span class="k">def</span> <span class="nf">GetStringIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_s2id</span><span class="p">[</span><span class="n">string</span><span class="p">]</span>


<span class="n">strmap</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">unitmap</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">locmap</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">swmap</span> <span class="o">=</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">IgnoreColor</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="p">(</span><span class="mh">0x01</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mh">0x1F</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="mh">0x7F</span><span class="p">),</span> <span class="n">s</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">InitStringMap</span><span class="p">(</span><span class="n">chkt</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">strmap</span><span class="p">,</span> <span class="n">unitmap</span><span class="p">,</span> <span class="n">locmap</span><span class="p">,</span> <span class="n">swmap</span>

    <span class="n">strmap</span> <span class="o">=</span> <span class="n">tblformat</span><span class="o">.</span><span class="n">TBL</span><span class="p">(</span><span class="n">chkt</span><span class="o">.</span><span class="n">getsection</span><span class="p">(</span><span class="s">&#39;STR&#39;</span><span class="p">))</span>
    <span class="n">unitmap</span> <span class="o">=</span> <span class="n">StringIdMap</span><span class="p">()</span>
    <span class="n">locmap</span> <span class="o">=</span> <span class="n">StringIdMap</span><span class="p">()</span>
    <span class="n">swmap</span> <span class="o">=</span> <span class="n">StringIdMap</span><span class="p">()</span>

    <span class="n">unix</span> <span class="o">=</span> <span class="n">chkt</span><span class="o">.</span><span class="n">getsection</span><span class="p">(</span><span class="s">&#39;UNIx&#39;</span><span class="p">)</span>
    <span class="n">mrgn</span> <span class="o">=</span> <span class="n">chkt</span><span class="o">.</span><span class="n">getsection</span><span class="p">(</span><span class="s">&#39;MRGN&#39;</span><span class="p">)</span>
    <span class="n">swnm</span> <span class="o">=</span> <span class="n">chkt</span><span class="o">.</span><span class="n">getsection</span><span class="p">(</span><span class="s">&#39;SWNM&#39;</span><span class="p">)</span>

    <span class="c"># Get location names</span>
    <span class="k">if</span> <span class="n">mrgn</span><span class="p">:</span>
        <span class="n">locn</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mrgn</span><span class="p">)</span> <span class="o">//</span> <span class="mi">20</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">locn</span><span class="p">):</span>
            <span class="n">locstrid</span> <span class="o">=</span> <span class="n">b2i2</span><span class="p">(</span><span class="n">mrgn</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span>
            <span class="n">locstr</span> <span class="o">=</span> <span class="n">strmap</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">locstrid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">locstr</span><span class="p">:</span>
                <span class="n">locmap</span><span class="o">.</span><span class="n">AddItem</span><span class="p">(</span><span class="n">locstr</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="c"># Get unit names</span>
    <span class="k">if</span> <span class="n">unix</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">228</span><span class="p">):</span>
            <span class="n">unitstrid</span> <span class="o">=</span> <span class="n">b2i2</span><span class="p">(</span><span class="n">unix</span><span class="p">,</span> <span class="mi">3192</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">unitstr</span> <span class="o">=</span> <span class="n">strmap</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">unitstrid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">unitstr</span><span class="p">:</span>
                <span class="n">unitmap</span><span class="o">.</span><span class="n">AddItem</span><span class="p">(</span><span class="n">unitstr</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">unitmap</span><span class="o">.</span><span class="n">AddItem</span><span class="p">(</span><span class="n">IgnoreColor</span><span class="p">(</span><span class="n">unitstr</span><span class="p">),</span> <span class="n">i</span><span class="p">)</span>

    <span class="c"># Get switch names</span>
    <span class="k">if</span> <span class="n">swnm</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
            <span class="n">switchstrid</span> <span class="o">=</span> <span class="n">b2i4</span><span class="p">(</span><span class="n">swnm</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">switchstr</span> <span class="o">=</span> <span class="n">strmap</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">switchstrid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">switchstr</span><span class="p">:</span>
                <span class="n">swmap</span><span class="o">.</span><span class="n">AddItem</span><span class="p">(</span><span class="n">switchstr</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">GetLocationIndex</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">locmap</span><span class="o">.</span><span class="n">GetStringIndex</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">GetStringIndex</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">strmap</span><span class="o">.</span><span class="n">GetStringIndex</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">GetSwitchIndex</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">swmap</span><span class="o">.</span><span class="n">GetStringIndex</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">GetUnitIndex</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">unitmap</span><span class="o">.</span><span class="n">GetStringIndex</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">ApplyStringMap</span><span class="p">(</span><span class="n">chkt</span><span class="p">):</span>
    <span class="n">chkt</span><span class="o">.</span><span class="n">setsection</span><span class="p">(</span><span class="s">&#39;STR&#39;</span><span class="p">,</span> <span class="n">strmap</span><span class="o">.</span><span class="n">SaveTBL</span><span class="p">())</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\mapdata\tblformat.py : 107 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106</pre></div></td><td class="code"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">String table manager. Internally used in eudtrg.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">binio</span><span class="p">,</span> <span class="n">ubconv</span>


<span class="k">class</span> <span class="nc">TBL</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c">#</span>
        <span class="c"># datatb : table of strings                       : string data table</span>
        <span class="c"># dataindextb : string id -&gt; data id              : string offset table</span>
        <span class="c"># stringmap : string -&gt; representative string id</span>
        <span class="c">#</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_datatb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stringmap</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataindextb</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># String starts from #1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_capacity</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c"># Size of STR section</span>

        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LoadTBL</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">LoadTBL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datatb</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stringmap</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_capacity</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="n">stringcount</span> <span class="o">=</span> <span class="n">binio</span><span class="o">.</span><span class="n">b2i2</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">stringcount</span><span class="p">):</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">stringoffset</span> <span class="o">=</span> <span class="n">binio</span><span class="o">.</span><span class="n">b2i2</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">send</span> <span class="o">=</span> <span class="n">stringoffset</span>
            <span class="k">while</span> <span class="n">content</span><span class="p">[</span><span class="n">send</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">send</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">string</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="n">stringoffset</span><span class="p">:</span><span class="n">send</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AddString</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">AddString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">ubconv</span><span class="o">.</span><span class="n">u2b</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>  <span class="c"># Starcraft uses multibyte encoding.</span>

        <span class="n">stringindex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataindextb</span><span class="p">)</span>

        <span class="c"># If duplicate text exist -&gt; just proxy it</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">repr_stringid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stringmap</span><span class="p">[</span><span class="n">string</span><span class="p">]</span>
            <span class="n">dataindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataindextb</span><span class="p">[</span><span class="n">repr_stringid</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dataindextb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataindex</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_capacity</span> <span class="o">+=</span> <span class="mi">2</span>  <span class="c"># just string offset</span>

        <span class="c"># Else -&gt; Create new entry</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">dataindex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_datatb</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stringmap</span><span class="p">[</span><span class="n">string</span><span class="p">]</span> <span class="o">=</span> <span class="n">stringindex</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_datatb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dataindextb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataindex</span><span class="p">)</span>
            <span class="c"># string + b&#39;\0&#39; + string offset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_capacity</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_capacity</span> <span class="o">&lt;</span> <span class="mi">65536</span><span class="p">,</span> <span class="s">&#39;String table overflow&#39;</span>

        <span class="k">return</span> <span class="n">stringindex</span>

    <span class="k">def</span> <span class="nf">GetString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dataindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataindextb</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datatb</span><span class="p">[</span><span class="n">dataindex</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">GetStringIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stringmap</span><span class="p">[</span><span class="n">string</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AddString</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">SaveTBL</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outbytes</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c"># calculate offset of each string</span>
        <span class="n">stroffset</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">outindex</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataindextb</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datatb</span><span class="p">:</span>
            <span class="n">stroffset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outindex</span><span class="p">)</span>
            <span class="n">outindex</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="c"># String count</span>
        <span class="n">outbytes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binio</span><span class="o">.</span><span class="n">i2b2</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataindextb</span><span class="p">)))</span>

        <span class="c"># String offsets</span>
        <span class="k">for</span> <span class="n">dataidx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataindextb</span><span class="p">:</span>
            <span class="n">outbytes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binio</span><span class="o">.</span><span class="n">i2b2</span><span class="p">(</span><span class="n">stroffset</span><span class="p">[</span><span class="n">dataidx</span><span class="p">]))</span>

        <span class="c"># String data</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datatb</span><span class="p">:</span>
            <span class="n">outbytes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">outbytes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\0</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outbytes</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\mapdata\unitprp.py : 118 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="o">*</span>


<span class="k">class</span> <span class="nc">UnitProperty</span><span class="p">(</span><span class="n">LittleEndianStructure</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    UnitProperty class. Used in &#39;Create Unit with Properties&#39; action.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s">&#39;sprpvalid&#39;</span><span class="p">,</span> <span class="n">c_ushort</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;prpvalid&#39;</span><span class="p">,</span> <span class="n">c_ushort</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;player&#39;</span><span class="p">,</span> <span class="n">c_byte</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;hitpoint&#39;</span><span class="p">,</span> <span class="n">c_byte</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;shield&#39;</span><span class="p">,</span> <span class="n">c_byte</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;energy&#39;</span><span class="p">,</span> <span class="n">c_byte</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;resource&#39;</span><span class="p">,</span> <span class="n">c_uint</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;hanger&#39;</span><span class="p">,</span> <span class="n">c_ushort</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;sprpflag&#39;</span><span class="p">,</span> <span class="n">c_ushort</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;unused&#39;</span><span class="p">,</span> <span class="n">c_uint</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">hitpoint</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">shield</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">energy</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">resource</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">hanger</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">clocked</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">burrowed</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">intransit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">hallucinated</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">invincible</span><span class="o">=</span><span class="bp">None</span>
    <span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Properties : Value/None (Don&#39;t care)</span>

<span class="sd">        - hitpoint : 0~100(%)  if) When unit&#39;s hitpoint is greater than 167772,</span>
<span class="sd">        - shield   : 0~100(%)   you should give hitpoint None to make 100%% HP.</span>
<span class="sd">        - energy   : 0~100(%)</span>
<span class="sd">        - resource : 0~4294967295</span>
<span class="sd">        - hanger   : 0~65536 (Count)</span>

<span class="sd">        Special properties : True(Enabled)/False(Disabled)/None(Don&#39;t care)</span>

<span class="sd">        - clocked      : Unit is clocked.</span>
<span class="sd">        - burrowed     : Unit is burrowed.</span>
<span class="sd">        - intransit    : Unit is lifted. (In transit)</span>
<span class="sd">        - hallucinated : Unit is hallucination.</span>
<span class="sd">        - invincible   : Unit is invincible.</span>

<span class="sd">        &gt;&gt;&gt; UnitProperty(hitpoint = 50, burrowed = True) # HP 50%, burrowed</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">assert</span> <span class="n">hitpoint</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">hitpoint</span> <span class="o">&lt;=</span> <span class="mi">100</span>
        <span class="k">assert</span> <span class="n">shield</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">shield</span> <span class="o">&lt;=</span> <span class="mi">100</span>
        <span class="k">assert</span> <span class="n">energy</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">energy</span> <span class="o">&lt;=</span> <span class="mi">100</span>
        <span class="k">assert</span> <span class="n">resource</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">resource</span>
        <span class="k">assert</span> <span class="n">hanger</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">hanger</span> <span class="o">&lt;=</span> <span class="mi">255</span>

        <span class="k">assert</span> <span class="n">clocked</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">burrowed</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">intransit</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">hallucinated</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">invincible</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">prop2int</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">p</span>

        <span class="k">def</span> <span class="nf">prop2valid</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">v</span>

        <span class="k">def</span> <span class="nf">prop2flag</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c"># Set properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hitpoint</span> <span class="o">=</span> <span class="n">prop2int</span><span class="p">(</span><span class="n">hitpoint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shield</span> <span class="o">=</span> <span class="n">prop2int</span><span class="p">(</span><span class="n">shield</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">prop2int</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">prop2int</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hanger</span> <span class="o">=</span> <span class="n">prop2int</span><span class="p">(</span><span class="n">hanger</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prpvalid</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">prop2valid</span><span class="p">(</span><span class="n">hitpoint</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2valid</span><span class="p">(</span><span class="n">shield</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2valid</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2valid</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2valid</span><span class="p">(</span><span class="n">hanger</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c"># Set special properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sprpvalid</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">prop2valid</span><span class="p">(</span><span class="n">clocked</span><span class="p">,</span>      <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2valid</span><span class="p">(</span><span class="n">burrowed</span><span class="p">,</span>     <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2valid</span><span class="p">(</span><span class="n">intransit</span><span class="p">,</span>    <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2valid</span><span class="p">(</span><span class="n">hallucinated</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2valid</span><span class="p">(</span><span class="n">invincible</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sprpflag</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">prop2flag</span><span class="p">(</span><span class="n">clocked</span><span class="p">,</span>      <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2flag</span><span class="p">(</span><span class="n">burrowed</span><span class="p">,</span>     <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2flag</span><span class="p">(</span><span class="n">intransit</span><span class="p">,</span>    <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2flag</span><span class="p">(</span><span class="n">hallucinated</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span>
            <span class="n">prop2flag</span><span class="p">(</span><span class="n">invincible</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\mapdata\__init__.py : 16 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.stringmap</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">GetLocationIndex</span><span class="p">,</span>
    <span class="n">GetStringIndex</span><span class="p">,</span>
    <span class="n">GetSwitchIndex</span><span class="p">,</span>
    <span class="n">GetUnitIndex</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.proptable</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">GetPropertyIndex</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.mapdata</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">IsMapdataInitalized</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.tblformat</span> <span class="kn">import</span> <span class="n">TBL</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\trigger\action.py : 95 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..allocator</span> <span class="kn">import</span> <span class="n">SCMemAddr</span><span class="p">,</span> <span class="n">Evaluate</span><span class="p">,</span> <span class="n">IsValidSCMemAddr</span>


<span class="k">class</span> <span class="nc">Action</span><span class="p">(</span><span class="n">SCMemAddr</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Action class.</span>

<span class="sd">    Memory layout.</span>

<span class="sd">     ======  ============= ========  ==========</span>
<span class="sd">     Offset  Field Name    Position  EPD Player</span>
<span class="sd">     ======  ============= ========  ==========</span>
<span class="sd">       +00   locid1         dword0   EPD(act)+0</span>
<span class="sd">       +04   strid          dword1   EPD(act)+1</span>
<span class="sd">       +08   wavid          dword2   EPD(act)+2</span>
<span class="sd">       +0C   time           dword3   EPD(act)+3</span>
<span class="sd">       +10   player1        dword4   EPD(act)+4</span>
<span class="sd">       +14   player2        dword5   EPD(act)+5</span>
<span class="sd">       +18   unitid         dword6   EPD(act)+6</span>
<span class="sd">       +1A   acttype</span>
<span class="sd">       +1B   amount</span>
<span class="sd">       +1C   flags          dword7   EPD(act)+7</span>
<span class="sd">       +1D   internal[3</span>
<span class="sd">     ======  ============= ========  ==========</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locid1</span><span class="p">,</span> <span class="n">strid</span><span class="p">,</span> <span class="n">wavid</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">player1</span><span class="p">,</span> <span class="n">player2</span><span class="p">,</span>
                 <span class="n">unitid</span><span class="p">,</span> <span class="n">acttype</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">flags</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        See :mod:`eudtrg.base.stocktrg` for stock actions list.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">locid1</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">locid1</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">strid</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">strid</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">wavid</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">wavid</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">time</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">player1</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">player1</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">player2</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">player2</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">unitid</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">unitid</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">acttype</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">acttype</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">amount</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">amount</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">flags</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_locid1</span> <span class="o">=</span> <span class="n">locid1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_strid</span> <span class="o">=</span> <span class="n">strid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wavid</span> <span class="o">=</span> <span class="n">wavid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_player1</span> <span class="o">=</span> <span class="n">player1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_player2</span> <span class="o">=</span> <span class="n">player2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unitid</span> <span class="o">=</span> <span class="n">unitid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_acttype</span> <span class="o">=</span> <span class="n">acttype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_amount</span> <span class="o">=</span> <span class="n">amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flags</span> <span class="o">=</span> <span class="n">flags</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_parenttrg</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actindex</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">Disable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flags</span> <span class="o">|=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">SetParentTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trg</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parenttrg</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;Action cannot be shared by two triggers.&#39;</span>
            <span class="s">&#39;Deep copy each conditions&#39;</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">trg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;Trigger should not be null.&#39;</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">64</span><span class="p">,</span> <span class="s">&#39;WTF&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_parenttrg</span> <span class="o">=</span> <span class="n">trg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actindex</span> <span class="o">=</span> <span class="n">index</span>

    <span class="c"># -------</span>

    <span class="k">def</span> <span class="nf">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parenttrg</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">320</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actindex</span>

    <span class="k">def</span> <span class="nf">WritePayload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbuffer</span><span class="p">):</span>
        <span class="n">pbuffer</span><span class="o">.</span><span class="n">WritePack</span><span class="p">(</span>
            <span class="s">&#39;IIIIIIHBBBBH&#39;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_locid1</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_strid</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wavid</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_player1</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_player2</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unitid</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_acttype</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_amount</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mi">0</span>
        <span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\trigger\condition.py : 85 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..allocator</span> <span class="kn">import</span> <span class="n">SCMemAddr</span><span class="p">,</span> <span class="n">Evaluate</span><span class="p">,</span> <span class="n">IsValidSCMemAddr</span>


<span class="k">class</span> <span class="nc">Condition</span><span class="p">(</span><span class="n">SCMemAddr</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Condition class.</span>

<span class="sd">    Memory layout:</span>

<span class="sd">     ======  =============  ========  ===========</span>
<span class="sd">     Offset  Field name     Position  EPD Player</span>
<span class="sd">     ======  =============  ========  ===========</span>
<span class="sd">       +00   locid           dword0   EPD(cond)+0</span>
<span class="sd">       +04   player          dword1   EPD(cond)+1</span>
<span class="sd">       +08   amount          dword2   EPD(cond)+2</span>
<span class="sd">       +0C   unitid          dword3   EPD(cond)+3</span>
<span class="sd">       +0E   comparison</span>
<span class="sd">       +0F   condtype</span>
<span class="sd">       +10   restype         dword4   EPD(cond)+4</span>
<span class="sd">       +11   flags</span>
<span class="sd">       +12   internal[2]</span>
<span class="sd">     ======  =============  ========  ===========</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locid</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">unitid</span><span class="p">,</span>
                 <span class="n">comparison</span><span class="p">,</span> <span class="n">condtype</span><span class="p">,</span> <span class="n">restype</span><span class="p">,</span> <span class="n">flags</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">locid</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">locid</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">player</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">player</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">amount</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">amount</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">unitid</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">unitid</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">comparison</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">comparison</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">condtype</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">condtype</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">restype</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">restype</span>
        <span class="k">assert</span> <span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span> <span class="s">&#39;Invalid arg </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">flags</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_locid</span> <span class="o">=</span> <span class="n">locid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_player</span> <span class="o">=</span> <span class="n">player</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_amount</span> <span class="o">=</span> <span class="n">amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unitid</span> <span class="o">=</span> <span class="n">unitid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comparison</span> <span class="o">=</span> <span class="n">comparison</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_condtype</span> <span class="o">=</span> <span class="n">condtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_restype</span> <span class="o">=</span> <span class="n">restype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flags</span> <span class="o">=</span> <span class="n">flags</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_parenttrg</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_condindex</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">Disable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flags</span> <span class="o">|=</span> <span class="mi">2</span>

    <span class="c"># -------</span>

    <span class="k">def</span> <span class="nf">SetParentTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trg</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parenttrg</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;Condition cannot be shared by two triggers. &#39;</span>
            <span class="s">&#39;Deep copy each conditions&#39;</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">trg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;Trigger should not be null.&#39;</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">,</span> <span class="s">&#39;WTF&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_parenttrg</span> <span class="o">=</span> <span class="n">trg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_condindex</span> <span class="o">=</span> <span class="n">index</span>

    <span class="k">def</span> <span class="nf">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parenttrg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;Orphan condition&#39;</span>
        <span class="k">return</span> <span class="n">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parenttrg</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_condindex</span> <span class="o">*</span> <span class="mi">20</span>

    <span class="k">def</span> <span class="nf">WritePayload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbuffer</span><span class="p">):</span>
        <span class="n">pbuffer</span><span class="o">.</span><span class="n">WritePack</span><span class="p">(</span>
            <span class="s">&#39;IIIHBBBBH&#39;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_locid</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_player</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_amount</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unitid</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_comparison</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_condtype</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_restype</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">,</span>
            <span class="mi">0</span>
        <span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\trigger\constenc.py : 329 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.strenc</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EncodeAIScript</span><span class="p">,</span>
    <span class="n">EncodeLocation</span><span class="p">,</span>
    <span class="n">EncodeString</span><span class="p">,</span>
    <span class="n">EncodeSwitch</span><span class="p">,</span>
    <span class="n">EncodeUnit</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">..mapdata</span> <span class="kn">import</span> <span class="n">GetPropertyIndex</span>


<span class="k">class</span> <span class="nc">_Unique</span><span class="p">:</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">_KillsSpecialized</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internalf</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

<span class="n">All</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Enemy</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Ally</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">AlliedVictory</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">AtLeast</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">AtMost</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Exactly</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">SetTo</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Add</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Subtract</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Move</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Patrol</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Attack</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P1</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P2</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P3</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P4</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P5</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P6</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P7</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P8</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P9</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P10</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P11</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">P12</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player1</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player2</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player3</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player4</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player5</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player6</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player7</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player8</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player9</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player10</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player11</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Player12</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">CurrentPlayer</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Foes</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Allies</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">NeutralPlayers</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">AllPlayers</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Force1</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Force2</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Force3</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Force4</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">NonAlliedVictoryPlayers</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Enable</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Disable</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Toggle</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Ore</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Gas</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">OreAndGas</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Total</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Units</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Buildings</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">UnitsAndBuildings</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Kills</span> <span class="o">=</span> <span class="n">_KillsSpecialized</span><span class="p">()</span>  <span class="c"># Condition name &amp; Constant name conflict. See stockcond</span>
<span class="n">Razings</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">KillsAndRazings</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Custom</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Set</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Clear</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Random</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>
<span class="n">Cleared</span> <span class="o">=</span> <span class="n">_Unique</span><span class="p">()</span>

<span class="n">AllyStatusDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Enemy</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">Ally</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">AlliedVictory</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">ComparisonDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">AtLeast</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">AtMost</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">Exactly</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">ModifierDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">SetTo</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">Add</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="n">Subtract</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">OrderDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Move</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">Patrol</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">Attack</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">PlayerDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">P1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">P2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">P3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">P4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">P5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">P6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">P7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">P8</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">P9</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="n">P10</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="n">P11</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">P12</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="n">Player1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">Player2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">Player3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">Player4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">Player5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">Player6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">Player7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">Player8</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">Player9</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="n">Player10</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="n">Player11</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">Player12</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="n">CurrentPlayer</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
    <span class="n">Foes</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
    <span class="n">Allies</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">NeutralPlayers</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
    <span class="n">AllPlayers</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
    <span class="n">Force1</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
    <span class="n">Force2</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="n">Force3</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">Force4</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">NonAlliedVictoryPlayers</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">PropStateDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Enable</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">Disable</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">Toggle</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">ResourceDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Ore</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">Gas</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">OreAndGas</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">ScoreDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Total</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">Units</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">Buildings</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">UnitsAndBuildings</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">Kills</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">Razings</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">KillsAndRazings</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">Custom</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">SwitchActionDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Set</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">Clear</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">Toggle</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">Random</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">SwitchStateDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Set</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">Cleared</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">_EncodeConst</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c"># unhashable type</span>
        <span class="k">return</span> <span class="n">s</span>


<span class="k">def</span> <span class="nf">EncodeAllyStatus</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert [Enemy, Ally, AlliedVictory] to number [0, 1, 2].</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">_EncodeConst</span><span class="p">(</span><span class="n">AllyStatusDict</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeComparison</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert [AtLeast, AtMost, Exactly] to number [0, 1, 10].</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">_EncodeConst</span><span class="p">(</span><span class="n">ComparisonDict</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeModifier</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert [SetTo, Add, Subtract] to number [7, 8, 9].</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">_EncodeConst</span><span class="p">(</span><span class="n">ModifierDict</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeOrder</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert [Move, Patrol, Attack] to number [0, 1, 2].</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">_EncodeConst</span><span class="p">(</span><span class="n">OrderDict</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodePlayer</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert player identifier to corresponding number.</span>

<span class="sd">    ======================= ========</span>
<span class="sd">        Identifier           Number</span>
<span class="sd">    ======================= ========</span>
<span class="sd">    P1                         0</span>
<span class="sd">    P2                         1</span>
<span class="sd">    P3                         2</span>
<span class="sd">    P4                         3</span>
<span class="sd">    P5                         4</span>
<span class="sd">    P6                         5</span>
<span class="sd">    P7                         6</span>
<span class="sd">    P8                         7</span>
<span class="sd">    P9                         8</span>
<span class="sd">    P10                        9</span>
<span class="sd">    P11                        10</span>
<span class="sd">    P12                        11</span>
<span class="sd">    Player1                    0</span>
<span class="sd">    Player2                    1</span>
<span class="sd">    Player3                    2</span>
<span class="sd">    Player4                    3</span>
<span class="sd">    Player5                    4</span>
<span class="sd">    Player6                    5</span>
<span class="sd">    Player7                    6</span>
<span class="sd">    Player8                    7</span>
<span class="sd">    Player9                    8</span>
<span class="sd">    Player10                   9</span>
<span class="sd">    Player11                   10</span>
<span class="sd">    Player12                   11</span>
<span class="sd">    CurrentPlayer              13</span>
<span class="sd">    Foes                       14</span>
<span class="sd">    Allies                     15</span>
<span class="sd">    NeutralPlayers             16</span>
<span class="sd">    AllPlayers                 17</span>
<span class="sd">    Force1                     18</span>
<span class="sd">    Force2                     19</span>
<span class="sd">    Force3                     20</span>
<span class="sd">    Force4                     21</span>
<span class="sd">    NonAlliedVictoryPlayers    26</span>
<span class="sd">    ======================= ========</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">_EncodeConst</span><span class="p">(</span><span class="n">PlayerDict</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodePropState</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert [Enable, Disable, Toogle] to number [4, 5, 6]</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">_EncodeConst</span><span class="p">(</span><span class="n">PropStateDict</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeResource</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert [Ore, Gas, OreAndGas] to [0, 1, 2]</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">_EncodeConst</span><span class="p">(</span><span class="n">ResourceDict</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeScore</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert score type identifier to number.</span>

<span class="sd">    ================= ========</span>
<span class="sd">        Score type     Number</span>
<span class="sd">    ================= ========</span>
<span class="sd">    Total                0</span>
<span class="sd">    Units                1</span>
<span class="sd">    Buildings            2</span>
<span class="sd">    UnitsAndBuildings    3</span>
<span class="sd">    Kills                4</span>
<span class="sd">    Razings              5</span>
<span class="sd">    KillsAndRazings      6</span>
<span class="sd">    Custom               7</span>
<span class="sd">    ================= ========</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">_EncodeConst</span><span class="p">(</span><span class="n">ScoreDict</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeSwitchAction</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert [Set, Clear, Toogle, Random] to [4, 5, 6, 11].</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">_EncodeConst</span><span class="p">(</span><span class="n">SwitchActionDict</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeSwitchState</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert [Set, Cleared] to [2, 3].</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">_EncodeConst</span><span class="p">(</span><span class="n">SwitchStateDict</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeCount</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert [All, (other numbers)] to number [0, (as-is)].</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">All</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">s</span>

<span class="c"># ========================</span>


<span class="k">def</span> <span class="nf">EncodeProperty</span><span class="p">(</span><span class="n">prop</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">GetPropertyIndex</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\trigger\stockact.py : 382 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.action</span> <span class="kn">import</span> <span class="n">Action</span>
<span class="kn">from</span> <span class="nn">.constenc</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EncodeAIScript</span><span class="p">,</span>
    <span class="n">EncodeAllyStatus</span><span class="p">,</span>
    <span class="n">EncodeCount</span><span class="p">,</span>
    <span class="n">EncodeModifier</span><span class="p">,</span>
    <span class="n">EncodeOrder</span><span class="p">,</span>
    <span class="n">EncodePlayer</span><span class="p">,</span>
    <span class="n">EncodeProperty</span><span class="p">,</span>
    <span class="n">EncodePropState</span><span class="p">,</span>
    <span class="n">EncodeResource</span><span class="p">,</span>
    <span class="n">EncodeScore</span><span class="p">,</span>
    <span class="n">EncodeSwitchAction</span><span class="p">,</span>
    <span class="n">EncodeLocation</span><span class="p">,</span>
    <span class="n">EncodeString</span><span class="p">,</span>
    <span class="n">EncodeSwitch</span><span class="p">,</span>
    <span class="n">EncodeUnit</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">EPD</span>


<span class="k">def</span> <span class="nf">NoAction</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Victory</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Defeat</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">PreserveTrigger</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Wait</span><span class="p">(</span><span class="n">Time</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Time</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">PauseGame</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">UnpauseGame</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Transmission</span><span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Where</span><span class="p">,</span> <span class="n">WAVName</span><span class="p">,</span> <span class="n">TimeModifier</span><span class="p">,</span>
                 <span class="n">Time</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">AlwaysDisplay</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="n">WAVName</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">WAVName</span><span class="p">)</span>
    <span class="n">TimeModifier</span> <span class="o">=</span> <span class="n">EncodeModifier</span><span class="p">(</span><span class="n">TimeModifier</span><span class="p">)</span>
    <span class="n">Text</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">WAVName</span><span class="p">,</span> <span class="n">Time</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="n">Unit</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">TimeModifier</span><span class="p">,</span> <span class="n">AlwaysDisplay</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">PlayWAV</span><span class="p">(</span><span class="n">WAVName</span><span class="p">):</span>
    <span class="n">WAVName</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">WAVName</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WAVName</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">DisplayText</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="n">AlwaysDisplay</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">Text</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">AlwaysDisplay</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">CenterView</span><span class="p">(</span><span class="n">Where</span><span class="p">):</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">CreateUnitWithProperties</span><span class="p">(</span><span class="n">Count</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Where</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Properties</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Properties</span> <span class="o">=</span> <span class="n">EncodeProperty</span><span class="p">(</span><span class="n">Properties</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Properties</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetMissionObjectives</span><span class="p">(</span><span class="n">Text</span><span class="p">):</span>
    <span class="n">Text</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetSwitch</span><span class="p">(</span><span class="n">Switch</span><span class="p">,</span> <span class="n">State</span><span class="p">):</span>
    <span class="n">Switch</span> <span class="o">=</span> <span class="n">EncodeSwitch</span><span class="p">(</span><span class="n">Switch</span><span class="p">)</span>
    <span class="n">State</span> <span class="o">=</span> <span class="n">EncodeSwitchAction</span><span class="p">(</span><span class="n">State</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Switch</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="n">State</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetCountdownTimer</span><span class="p">(</span><span class="n">TimeModifier</span><span class="p">,</span> <span class="n">Time</span><span class="p">):</span>
    <span class="n">TimeModifier</span> <span class="o">=</span> <span class="n">EncodeModifier</span><span class="p">(</span><span class="n">TimeModifier</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Time</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">TimeModifier</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">RunAIScript</span><span class="p">(</span><span class="n">Script</span><span class="p">):</span>
    <span class="n">Script</span> <span class="o">=</span> <span class="n">EncodeAIScript</span><span class="p">(</span><span class="n">Script</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Script</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">RunAIScriptAt</span><span class="p">(</span><span class="n">Script</span><span class="p">,</span> <span class="n">Where</span><span class="p">):</span>
    <span class="n">Script</span> <span class="o">=</span> <span class="n">EncodeAIScript</span><span class="p">(</span><span class="n">Script</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Script</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardControl</span><span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Label</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Label</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardControlAt</span><span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Label</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Location</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Location</span><span class="p">)</span>
    <span class="n">Label</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Location</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardResources</span><span class="p">(</span><span class="n">ResourceType</span><span class="p">,</span> <span class="n">Label</span><span class="p">):</span>
    <span class="n">ResourceType</span> <span class="o">=</span> <span class="n">EncodeResource</span><span class="p">(</span><span class="n">ResourceType</span><span class="p">)</span>
    <span class="n">Label</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ResourceType</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardKills</span><span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Label</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Label</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardScore</span><span class="p">(</span><span class="n">ScoreType</span><span class="p">,</span> <span class="n">Label</span><span class="p">):</span>
    <span class="n">ScoreType</span> <span class="o">=</span> <span class="n">EncodeScore</span><span class="p">(</span><span class="n">ScoreType</span><span class="p">)</span>
    <span class="n">Label</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ScoreType</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">KillUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Player</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">KillUnitAt</span><span class="p">(</span><span class="n">Count</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Where</span><span class="p">,</span> <span class="n">ForPlayer</span><span class="p">):</span>
    <span class="n">Count</span> <span class="o">=</span> <span class="n">EncodeCount</span><span class="p">(</span><span class="n">Count</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="n">ForPlayer</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">ForPlayer</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ForPlayer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">RemoveUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Player</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">RemoveUnitAt</span><span class="p">(</span><span class="n">Count</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Where</span><span class="p">,</span> <span class="n">ForPlayer</span><span class="p">):</span>
    <span class="n">Count</span> <span class="o">=</span> <span class="n">EncodeCount</span><span class="p">(</span><span class="n">Count</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="n">ForPlayer</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">ForPlayer</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ForPlayer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetResources</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">Modifier</span><span class="p">,</span> <span class="n">Amount</span><span class="p">,</span> <span class="n">ResourceType</span><span class="p">):</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Modifier</span> <span class="o">=</span> <span class="n">EncodeModifier</span><span class="p">(</span><span class="n">Modifier</span><span class="p">)</span>
    <span class="n">ResourceType</span> <span class="o">=</span> <span class="n">EncodeResource</span><span class="p">(</span><span class="n">ResourceType</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Amount</span><span class="p">,</span> <span class="n">ResourceType</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="n">Modifier</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetScore</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">Modifier</span><span class="p">,</span> <span class="n">Amount</span><span class="p">,</span> <span class="n">ScoreType</span><span class="p">):</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Modifier</span> <span class="o">=</span> <span class="n">EncodeModifier</span><span class="p">(</span><span class="n">Modifier</span><span class="p">)</span>
    <span class="n">ScoreType</span> <span class="o">=</span> <span class="n">EncodeScore</span><span class="p">(</span><span class="n">ScoreType</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Amount</span><span class="p">,</span> <span class="n">ScoreType</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="n">Modifier</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">MinimapPing</span><span class="p">(</span><span class="n">Where</span><span class="p">):</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">TalkingPortrait</span><span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Time</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Time</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">MuteUnitSpeech</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">UnMuteUnitSpeech</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardComputerPlayers</span><span class="p">(</span><span class="n">State</span><span class="p">):</span>
    <span class="n">State</span> <span class="o">=</span> <span class="n">EncodePropState</span><span class="p">(</span><span class="n">State</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">State</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardGoalControl</span><span class="p">(</span><span class="n">Goal</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Label</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Label</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Goal</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardGoalControlAt</span><span class="p">(</span><span class="n">Goal</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Label</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Location</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Location</span><span class="p">)</span>
    <span class="n">Label</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Location</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Goal</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardGoalResources</span><span class="p">(</span><span class="n">Goal</span><span class="p">,</span> <span class="n">ResourceType</span><span class="p">,</span> <span class="n">Label</span><span class="p">):</span>
    <span class="n">ResourceType</span> <span class="o">=</span> <span class="n">EncodeResource</span><span class="p">(</span><span class="n">ResourceType</span><span class="p">)</span>
    <span class="n">Label</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Goal</span><span class="p">,</span> <span class="n">ResourceType</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardGoalKills</span><span class="p">(</span><span class="n">Goal</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Label</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Label</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Goal</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardGoalScore</span><span class="p">(</span><span class="n">Goal</span><span class="p">,</span> <span class="n">ScoreType</span><span class="p">,</span> <span class="n">Label</span><span class="p">):</span>
    <span class="n">ScoreType</span> <span class="o">=</span> <span class="n">EncodeScore</span><span class="p">(</span><span class="n">ScoreType</span><span class="p">)</span>
    <span class="n">Label</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Goal</span><span class="p">,</span> <span class="n">ScoreType</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">MoveLocation</span><span class="p">(</span><span class="n">Location</span><span class="p">,</span> <span class="n">OnUnit</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">DestLocation</span><span class="p">):</span>
    <span class="n">Location</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Location</span><span class="p">)</span>
    <span class="n">OnUnit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">OnUnit</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">DestLocation</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">DestLocation</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">DestLocation</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Location</span><span class="p">,</span> <span class="n">OnUnit</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">MoveUnit</span><span class="p">(</span><span class="n">Count</span><span class="p">,</span> <span class="n">UnitType</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">StartLocation</span><span class="p">,</span> <span class="n">DestLocation</span><span class="p">):</span>
    <span class="n">Count</span> <span class="o">=</span> <span class="n">EncodeCount</span><span class="p">(</span><span class="n">Count</span><span class="p">)</span>
    <span class="n">UnitType</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">StartLocation</span><span class="p">)</span>
    <span class="n">DestLocation</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">DestLocation</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">StartLocation</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">DestLocation</span><span class="p">,</span>
                  <span class="n">UnitType</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeaderBoardGreed</span><span class="p">(</span><span class="n">Goal</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Goal</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetNextScenario</span><span class="p">(</span><span class="n">ScenarioName</span><span class="p">):</span>
    <span class="n">ScenarioName</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">ScenarioName</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ScenarioName</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetDoodadState</span><span class="p">(</span><span class="n">State</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Where</span><span class="p">):</span>
    <span class="n">State</span> <span class="o">=</span> <span class="n">EncodePropState</span><span class="p">(</span><span class="n">State</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="n">State</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetInvincibility</span><span class="p">(</span><span class="n">State</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Where</span><span class="p">):</span>
    <span class="n">State</span> <span class="o">=</span> <span class="n">EncodePropState</span><span class="p">(</span><span class="n">State</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="n">State</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">CreateUnit</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Where</span><span class="p">,</span> <span class="n">ForPlayer</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="n">ForPlayer</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">ForPlayer</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ForPlayer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetDeaths</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">Modifier</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">):</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Modifier</span> <span class="o">=</span> <span class="n">EncodeModifier</span><span class="p">(</span><span class="n">Modifier</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">Modifier</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Order</span><span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">StartLocation</span><span class="p">,</span> <span class="n">OrderType</span><span class="p">,</span> <span class="n">DestLocation</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">StartLocation</span><span class="p">)</span>
    <span class="n">OrderType</span> <span class="o">=</span> <span class="n">EncodeOrder</span><span class="p">(</span><span class="n">OrderType</span><span class="p">)</span>
    <span class="n">DestLocation</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">DestLocation</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">StartLocation</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">DestLocation</span><span class="p">,</span>
                  <span class="n">Unit</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="n">OrderType</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Comment</span><span class="p">(</span><span class="n">Text</span><span class="p">):</span>
    <span class="n">Text</span> <span class="o">=</span> <span class="n">EncodeString</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">GiveUnits</span><span class="p">(</span><span class="n">Count</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Where</span><span class="p">,</span> <span class="n">NewOwner</span><span class="p">):</span>
    <span class="n">Count</span> <span class="o">=</span> <span class="n">EncodeCount</span><span class="p">(</span><span class="n">Count</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="n">NewOwner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">NewOwner</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">NewOwner</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">ModifyUnitHitPoints</span><span class="p">(</span><span class="n">Count</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Where</span><span class="p">,</span> <span class="n">Percent</span><span class="p">):</span>
    <span class="n">Count</span> <span class="o">=</span> <span class="n">EncodeCount</span><span class="p">(</span><span class="n">Count</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Percent</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">ModifyUnitEnergy</span><span class="p">(</span><span class="n">Count</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Where</span><span class="p">,</span> <span class="n">Percent</span><span class="p">):</span>
    <span class="n">Count</span> <span class="o">=</span> <span class="n">EncodeCount</span><span class="p">(</span><span class="n">Count</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Percent</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">ModifyUnitShields</span><span class="p">(</span><span class="n">Count</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Where</span><span class="p">,</span> <span class="n">Percent</span><span class="p">):</span>
    <span class="n">Count</span> <span class="o">=</span> <span class="n">EncodeCount</span><span class="p">(</span><span class="n">Count</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Percent</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">ModifyUnitResourceAmount</span><span class="p">(</span><span class="n">Count</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Where</span><span class="p">,</span> <span class="n">NewValue</span><span class="p">):</span>
    <span class="n">Count</span> <span class="o">=</span> <span class="n">EncodeCount</span><span class="p">(</span><span class="n">Count</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">ModifyUnitHangarCount</span><span class="p">(</span><span class="n">Add</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Where</span><span class="p">):</span>
    <span class="n">Count</span> <span class="o">=</span> <span class="n">EncodeCount</span><span class="p">(</span><span class="n">Count</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Owner</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
    <span class="n">Where</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Where</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="n">Where</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Owner</span><span class="p">,</span> <span class="n">Add</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="n">Count</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">PauseTimer</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">UnpauseTimer</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Draw</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetAllianceStatus</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">Status</span><span class="p">):</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Status</span> <span class="o">=</span> <span class="n">EncodeAllyStatus</span><span class="p">(</span><span class="n">Status</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Status</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetMemory</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">modtype</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">SetDeaths</span><span class="p">(</span><span class="n">EPD</span><span class="p">(</span><span class="n">dest</span><span class="p">),</span> <span class="n">modtype</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetNextPtr</span><span class="p">(</span><span class="n">trg</span><span class="p">,</span> <span class="n">dest</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">SetMemory</span><span class="p">(</span><span class="n">trg</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\trigger\stockcond.py : 176 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">types</span>

<span class="kn">from</span> <span class="nn">.condition</span> <span class="kn">import</span> <span class="n">Condition</span>
<span class="kn">from</span> <span class="nn">.constenc</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EncodeComparison</span><span class="p">,</span>
    <span class="n">EncodePlayer</span><span class="p">,</span>
    <span class="n">EncodeResource</span><span class="p">,</span>
    <span class="n">EncodeScore</span><span class="p">,</span>
    <span class="n">EncodeSwitchState</span><span class="p">,</span>
    <span class="n">EncodeLocation</span><span class="p">,</span>
    <span class="n">EncodeSwitch</span><span class="p">,</span>
    <span class="n">EncodeUnit</span><span class="p">,</span>
    <span class="n">Kills</span>  <span class="c"># for __calls__ binding</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">EPD</span>


<span class="k">def</span> <span class="nf">NoCondition</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">CountdownTimer</span><span class="p">(</span><span class="n">Comparison</span><span class="p">,</span> <span class="n">Time</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks countdown timer.</span>

<span class="sd">    Example::</span>

<span class="sd">        CountdownTimer(AtLeast, 10)</span>

<span class="sd">    Memory Layout::</span>

<span class="sd">        0000 0000 0000 0000 TTTT TTTT 0000 CP01 0000</span>

<span class="sd">        T : Time, CP : Comparison.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Comparison</span> <span class="o">=</span> <span class="n">EncodeComparison</span><span class="p">(</span><span class="n">Comparison</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Time</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Command</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;[Player] commands [Comparison] [Number] [Unit].</span>

<span class="sd">    Example::</span>
<span class="sd">        Command(Player1, AtLeast, 30, &quot;Terran Marine&quot;)</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Comparison</span> <span class="o">=</span> <span class="n">EncodeComparison</span><span class="p">(</span><span class="n">Comparison</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Bring</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Location</span><span class="p">):</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Comparison</span> <span class="o">=</span> <span class="n">EncodeComparison</span><span class="p">(</span><span class="n">Comparison</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Location</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Location</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="n">Location</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Accumulate</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">ResourceType</span><span class="p">):</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Comparison</span> <span class="o">=</span> <span class="n">EncodeComparison</span><span class="p">(</span><span class="n">Comparison</span><span class="p">)</span>
    <span class="n">ResourceType</span> <span class="o">=</span> <span class="n">EncodeResource</span><span class="p">(</span><span class="n">ResourceType</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ResourceType</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="c"># &#39;Kills&#39; is already defined inside constenc, so we just add __call__ method</span>
<span class="c"># to there instead of creating new function</span>
<span class="k">def</span> <span class="nf">__Kills__internal</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">):</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Comparison</span> <span class="o">=</span> <span class="n">EncodeComparison</span><span class="p">(</span><span class="n">Comparison</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">Kills</span><span class="o">.</span><span class="n">_internalf</span> <span class="o">=</span> <span class="n">__Kills__internal</span>


<span class="k">def</span> <span class="nf">CommandMost</span><span class="p">(</span><span class="n">Unit</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">CommandMostAt</span><span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Location</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Location</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Location</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="n">Location</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">MostKills</span><span class="p">(</span><span class="n">Unit</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">HighestScore</span><span class="p">(</span><span class="n">ScoreType</span><span class="p">):</span>
    <span class="n">ScoreType</span> <span class="o">=</span> <span class="n">EncodeScore</span><span class="p">(</span><span class="n">ScoreType</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">ScoreType</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">MostResources</span><span class="p">(</span><span class="n">ResourceType</span><span class="p">):</span>
    <span class="n">ResourceType</span> <span class="o">=</span> <span class="n">EncodeResource</span><span class="p">(</span><span class="n">ResourceType</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">ResourceType</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Switch</span><span class="p">(</span><span class="n">Switch</span><span class="p">,</span> <span class="n">State</span><span class="p">):</span>
    <span class="n">Switch</span> <span class="o">=</span> <span class="n">EncodeSwitch</span><span class="p">(</span><span class="n">Switch</span><span class="p">)</span>
    <span class="n">State</span> <span class="o">=</span> <span class="n">EncodeSwitchState</span><span class="p">(</span><span class="n">State</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">State</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">Switch</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">ElapsedTime</span><span class="p">(</span><span class="n">Comparison</span><span class="p">,</span> <span class="n">Time</span><span class="p">):</span>
    <span class="n">Comparison</span> <span class="o">=</span> <span class="n">EncodeComparison</span><span class="p">(</span><span class="n">Comparison</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Time</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Briefing</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Opponents</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Comparison</span> <span class="o">=</span> <span class="n">EncodeComparison</span><span class="p">(</span><span class="n">Comparison</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Deaths</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">):</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">Comparison</span> <span class="o">=</span> <span class="n">EncodeComparison</span><span class="p">(</span><span class="n">Comparison</span><span class="p">)</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">CommandLeast</span><span class="p">(</span><span class="n">Unit</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">CommandLeastAt</span><span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Location</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="n">Location</span> <span class="o">=</span> <span class="n">EncodeLocation</span><span class="p">(</span><span class="n">Location</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="n">Location</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeastKills</span><span class="p">(</span><span class="n">Unit</span><span class="p">):</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">EncodeUnit</span><span class="p">(</span><span class="n">Unit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LowestScore</span><span class="p">(</span><span class="n">ScoreType</span><span class="p">):</span>
    <span class="n">ScoreType</span> <span class="o">=</span> <span class="n">EncodeScore</span><span class="p">(</span><span class="n">ScoreType</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="n">ScoreType</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">LeastResources</span><span class="p">(</span><span class="n">ResourceType</span><span class="p">):</span>
    <span class="n">ResourceType</span> <span class="o">=</span> <span class="n">EncodeResource</span><span class="p">(</span><span class="n">ResourceType</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">ResourceType</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Score</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span> <span class="n">ScoreType</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
    <span class="n">Player</span> <span class="o">=</span> <span class="n">EncodePlayer</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span>
    <span class="n">ScoreType</span> <span class="o">=</span> <span class="n">EncodeScore</span><span class="p">(</span><span class="n">ScoreType</span><span class="p">)</span>
    <span class="n">Comparison</span> <span class="o">=</span> <span class="n">EncodeComparison</span><span class="p">(</span><span class="n">Comparison</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Player</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Comparison</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="n">ScoreType</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Always</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Never</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Memory</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">cmptype</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Deaths</span><span class="p">(</span><span class="n">EPD</span><span class="p">(</span><span class="n">dest</span><span class="p">),</span> <span class="n">cmptype</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\trigger\strdict.py : 549 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">DefLocationDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="nb">list</span><span class="p">({</span><span class="s">&quot;Location </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">255</span><span class="p">)}</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">+</span>
    <span class="p">[(</span><span class="s">&#39;Anywhere&#39;</span><span class="p">,</span> <span class="mi">63</span><span class="p">)]</span>
<span class="p">)</span>

<span class="n">DefSwitchDict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Switch </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">)}</span>

<span class="c"># ======================================</span>

<span class="n">DefUnitDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;Terran Marine&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s">&quot;Terran Ghost&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Terran Vulture&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s">&quot;Terran Goliath&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s">&quot;Goliath Turret&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s">&quot;Terran Siege Tank (Tank Mode)&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s">&quot;Siege Tank Turret (Tank Mode)&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s">&quot;Terran SCV&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s">&quot;Terran Wraith&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s">&quot;Terran Science Vessel&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="s">&quot;Gui Montag (Firebat)&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s">&quot;Terran Dropship&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="s">&quot;Terran Battlecruiser&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="s">&quot;Spider Mine&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
    <span class="s">&quot;Nuclear Missile&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
    <span class="s">&quot;Terran Civilian&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s">&quot;Sarah Kerrigan (Ghost)&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
    <span class="s">&quot;Alan Schezar (Goliath)&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
    <span class="s">&quot;Alan Schezar Turret&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
    <span class="s">&quot;Jim Raynor (Vulture)&quot;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="s">&quot;Jim Raynor (Marine)&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s">&quot;Tom Kazansky (Wraith)&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
    <span class="s">&quot;Magellan (Science Vessel)&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
    <span class="s">&quot;Edmund Duke (Tank Mode)&quot;</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span>
    <span class="s">&quot;Edmund Duke Turret (Tank Mode)&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
    <span class="s">&quot;Edmund Duke (Siege Mode)&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
    <span class="s">&quot;Edmund Duke Turret (Siege Mode)&quot;</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span>
    <span class="s">&quot;Arcturus Mengsk (Battlecruiser)&quot;</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span>
    <span class="s">&quot;Hyperion (Battlecruiser)&quot;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
    <span class="s">&quot;Norad II (Battlecruiser)&quot;</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span>
    <span class="s">&quot;Terran Siege Tank (Siege Mode)&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s">&quot;Siege Tank Turret (Siege Mode)&quot;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
    <span class="s">&quot;Terran Firebat&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
    <span class="s">&quot;Scanner Sweep&quot;</span><span class="p">:</span> <span class="mi">33</span><span class="p">,</span>
    <span class="s">&quot;Terran Medic&quot;</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span>
    <span class="s">&quot;Zerg Larva&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
    <span class="s">&quot;Zerg Egg&quot;</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span>
    <span class="s">&quot;Zerg Zergling&quot;</span><span class="p">:</span> <span class="mi">37</span><span class="p">,</span>
    <span class="s">&quot;Zerg Hydralisk&quot;</span><span class="p">:</span> <span class="mi">38</span><span class="p">,</span>
    <span class="s">&quot;Zerg Ultralisk&quot;</span><span class="p">:</span> <span class="mi">39</span><span class="p">,</span>
    <span class="s">&quot;Zerg Broodling&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="s">&quot;Zerg Drone&quot;</span><span class="p">:</span> <span class="mi">41</span><span class="p">,</span>
    <span class="s">&quot;Zerg Overlord&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="s">&quot;Zerg Mutalisk&quot;</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span>
    <span class="s">&quot;Zerg Guardian&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
    <span class="s">&quot;Zerg Queen&quot;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
    <span class="s">&quot;Zerg Defiler&quot;</span><span class="p">:</span> <span class="mi">46</span><span class="p">,</span>
    <span class="s">&quot;Zerg Scourge&quot;</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span>
    <span class="s">&quot;Torrasque (Ultralisk)&quot;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span>
    <span class="s">&quot;Matriarch (Queen)&quot;</span><span class="p">:</span> <span class="mi">49</span><span class="p">,</span>
    <span class="s">&quot;Infested Terran&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="s">&quot;Infested Kerrigan (Infested Terran)&quot;</span><span class="p">:</span> <span class="mi">51</span><span class="p">,</span>
    <span class="s">&quot;Unclean One (Defiler)&quot;</span><span class="p">:</span> <span class="mi">52</span><span class="p">,</span>
    <span class="s">&quot;Hunter Killer (Hydralisk)&quot;</span><span class="p">:</span> <span class="mi">53</span><span class="p">,</span>
    <span class="s">&quot;Devouring One (Zergling)&quot;</span><span class="p">:</span> <span class="mi">54</span><span class="p">,</span>
    <span class="s">&quot;Kukulza (Mutalisk)&quot;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
    <span class="s">&quot;Kukulza (Guardian)&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span>
    <span class="s">&quot;Yggdrasill (Overlord)&quot;</span><span class="p">:</span> <span class="mi">57</span><span class="p">,</span>
    <span class="s">&quot;Terran Valkyrie&quot;</span><span class="p">:</span> <span class="mi">58</span><span class="p">,</span>
    <span class="s">&quot;Mutalisk Cocoon&quot;</span><span class="p">:</span> <span class="mi">59</span><span class="p">,</span>
    <span class="s">&quot;Protoss Corsair&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
    <span class="s">&quot;Protoss Dark Templar (Unit)&quot;</span><span class="p">:</span> <span class="mi">61</span><span class="p">,</span>
    <span class="s">&quot;Zerg Devourer&quot;</span><span class="p">:</span> <span class="mi">62</span><span class="p">,</span>
    <span class="s">&quot;Protoss Dark Archon&quot;</span><span class="p">:</span> <span class="mi">63</span><span class="p">,</span>
    <span class="s">&quot;Protoss Probe&quot;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
    <span class="s">&quot;Protoss Zealot&quot;</span><span class="p">:</span> <span class="mi">65</span><span class="p">,</span>
    <span class="s">&quot;Protoss Dragoon&quot;</span><span class="p">:</span> <span class="mi">66</span><span class="p">,</span>
    <span class="s">&quot;Protoss High Templar&quot;</span><span class="p">:</span> <span class="mi">67</span><span class="p">,</span>
    <span class="s">&quot;Protoss Archon&quot;</span><span class="p">:</span> <span class="mi">68</span><span class="p">,</span>
    <span class="s">&quot;Protoss Shuttle&quot;</span><span class="p">:</span> <span class="mi">69</span><span class="p">,</span>
    <span class="s">&quot;Protoss Scout&quot;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
    <span class="s">&quot;Protoss Arbiter&quot;</span><span class="p">:</span> <span class="mi">71</span><span class="p">,</span>
    <span class="s">&quot;Protoss Carrier&quot;</span><span class="p">:</span> <span class="mi">72</span><span class="p">,</span>
    <span class="s">&quot;Protoss Interceptor&quot;</span><span class="p">:</span> <span class="mi">73</span><span class="p">,</span>
    <span class="s">&quot;Protoss Dark Templar (Hero)&quot;</span><span class="p">:</span> <span class="mi">74</span><span class="p">,</span>
    <span class="s">&quot;Zeratul (Dark Templar)&quot;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
    <span class="s">&quot;Tassadar/Zeratul (Archon)&quot;</span><span class="p">:</span> <span class="mi">76</span><span class="p">,</span>
    <span class="s">&quot;Fenix (Zealot)&quot;</span><span class="p">:</span> <span class="mi">77</span><span class="p">,</span>
    <span class="s">&quot;Fenix (Dragoon)&quot;</span><span class="p">:</span> <span class="mi">78</span><span class="p">,</span>
    <span class="s">&quot;Tassadar (Templar)&quot;</span><span class="p">:</span> <span class="mi">79</span><span class="p">,</span>
    <span class="s">&quot;Mojo (Scout)&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
    <span class="s">&quot;Warbringer (Reaver)&quot;</span><span class="p">:</span> <span class="mi">81</span><span class="p">,</span>
    <span class="s">&quot;Gantrithor (Carrier)&quot;</span><span class="p">:</span> <span class="mi">82</span><span class="p">,</span>
    <span class="s">&quot;Protoss Reaver&quot;</span><span class="p">:</span> <span class="mi">83</span><span class="p">,</span>
    <span class="s">&quot;Protoss Observer&quot;</span><span class="p">:</span> <span class="mi">84</span><span class="p">,</span>
    <span class="s">&quot;Protoss Scarab&quot;</span><span class="p">:</span> <span class="mi">85</span><span class="p">,</span>
    <span class="s">&quot;Danimoth (Arbiter)&quot;</span><span class="p">:</span> <span class="mi">86</span><span class="p">,</span>
    <span class="s">&quot;Aldaris (Templar)&quot;</span><span class="p">:</span> <span class="mi">87</span><span class="p">,</span>
    <span class="s">&quot;Artanis (Scout)&quot;</span><span class="p">:</span> <span class="mi">88</span><span class="p">,</span>
    <span class="s">&quot;Rhynadon (Badlands Critter)&quot;</span><span class="p">:</span> <span class="mi">89</span><span class="p">,</span>
    <span class="s">&quot;Bengalaas (Jungle Critter)&quot;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
    <span class="s">&quot;Cargo Ship (Unused)&quot;</span><span class="p">:</span> <span class="mi">91</span><span class="p">,</span>
    <span class="s">&quot;Mercenary Gunship (Unused)&quot;</span><span class="p">:</span> <span class="mi">92</span><span class="p">,</span>
    <span class="s">&quot;Scantid (Desert Critter)&quot;</span><span class="p">:</span> <span class="mi">93</span><span class="p">,</span>
    <span class="s">&quot;Kakaru (Twilight Critter)&quot;</span><span class="p">:</span> <span class="mi">94</span><span class="p">,</span>
    <span class="s">&quot;Ragnasaur (Ashworld Critter)&quot;</span><span class="p">:</span> <span class="mi">95</span><span class="p">,</span>
    <span class="s">&quot;Ursadon (Ice World Critter)&quot;</span><span class="p">:</span> <span class="mi">96</span><span class="p">,</span>
    <span class="s">&quot;Lurker Egg&quot;</span><span class="p">:</span> <span class="mi">97</span><span class="p">,</span>
    <span class="s">&quot;Raszagal (Corsair)&quot;</span><span class="p">:</span> <span class="mi">98</span><span class="p">,</span>
    <span class="s">&quot;Samir Duran (Ghost)&quot;</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span>
    <span class="s">&quot;Alexei Stukov (Ghost)&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s">&quot;Map Revealer&quot;</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
    <span class="s">&quot;Gerard DuGalle (BattleCruiser)&quot;</span><span class="p">:</span> <span class="mi">102</span><span class="p">,</span>
    <span class="s">&quot;Zerg Lurker&quot;</span><span class="p">:</span> <span class="mi">103</span><span class="p">,</span>
    <span class="s">&quot;Infested Duran (Infested Terran)&quot;</span><span class="p">:</span> <span class="mi">104</span><span class="p">,</span>
    <span class="s">&quot;Disruption Web&quot;</span><span class="p">:</span> <span class="mi">105</span><span class="p">,</span>
    <span class="s">&quot;Terran Command Center&quot;</span><span class="p">:</span> <span class="mi">106</span><span class="p">,</span>
    <span class="s">&quot;Terran Comsat Station&quot;</span><span class="p">:</span> <span class="mi">107</span><span class="p">,</span>
    <span class="s">&quot;Terran Nuclear Silo&quot;</span><span class="p">:</span> <span class="mi">108</span><span class="p">,</span>
    <span class="s">&quot;Terran Supply Depot&quot;</span><span class="p">:</span> <span class="mi">109</span><span class="p">,</span>
    <span class="s">&quot;Terran Refinery&quot;</span><span class="p">:</span> <span class="mi">110</span><span class="p">,</span>
    <span class="s">&quot;Terran Barracks&quot;</span><span class="p">:</span> <span class="mi">111</span><span class="p">,</span>
    <span class="s">&quot;Terran Academy&quot;</span><span class="p">:</span> <span class="mi">112</span><span class="p">,</span>
    <span class="s">&quot;Terran Factory&quot;</span><span class="p">:</span> <span class="mi">113</span><span class="p">,</span>
    <span class="s">&quot;Terran Starport&quot;</span><span class="p">:</span> <span class="mi">114</span><span class="p">,</span>
    <span class="s">&quot;Terran Control Tower&quot;</span><span class="p">:</span> <span class="mi">115</span><span class="p">,</span>
    <span class="s">&quot;Terran Science Facility&quot;</span><span class="p">:</span> <span class="mi">116</span><span class="p">,</span>
    <span class="s">&quot;Terran Covert Ops&quot;</span><span class="p">:</span> <span class="mi">117</span><span class="p">,</span>
    <span class="s">&quot;Terran Physics Lab&quot;</span><span class="p">:</span> <span class="mi">118</span><span class="p">,</span>
    <span class="s">&quot;Starbase (Unused)&quot;</span><span class="p">:</span> <span class="mi">119</span><span class="p">,</span>
    <span class="s">&quot;Terran Machine Shop&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
    <span class="s">&quot;Repair Bay (Unused)&quot;</span><span class="p">:</span> <span class="mi">121</span><span class="p">,</span>
    <span class="s">&quot;Terran Engineering Bay&quot;</span><span class="p">:</span> <span class="mi">122</span><span class="p">,</span>
    <span class="s">&quot;Terran Armory&quot;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
    <span class="s">&quot;Terran Missile Turret&quot;</span><span class="p">:</span> <span class="mi">124</span><span class="p">,</span>
    <span class="s">&quot;Terran Bunker&quot;</span><span class="p">:</span> <span class="mi">125</span><span class="p">,</span>
    <span class="s">&quot;Norad II (Crashed)&quot;</span><span class="p">:</span> <span class="mi">126</span><span class="p">,</span>
    <span class="s">&quot;Ion Cannon&quot;</span><span class="p">:</span> <span class="mi">127</span><span class="p">,</span>
    <span class="s">&quot;Uraj Crystal&quot;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
    <span class="s">&quot;Khalis Crystal&quot;</span><span class="p">:</span> <span class="mi">129</span><span class="p">,</span>
    <span class="s">&quot;Infested Command Center&quot;</span><span class="p">:</span> <span class="mi">130</span><span class="p">,</span>
    <span class="s">&quot;Zerg Hatchery&quot;</span><span class="p">:</span> <span class="mi">131</span><span class="p">,</span>
    <span class="s">&quot;Zerg Lair&quot;</span><span class="p">:</span> <span class="mi">132</span><span class="p">,</span>
    <span class="s">&quot;Zerg Hive&quot;</span><span class="p">:</span> <span class="mi">133</span><span class="p">,</span>
    <span class="s">&quot;Zerg Nydus Canal&quot;</span><span class="p">:</span> <span class="mi">134</span><span class="p">,</span>
    <span class="s">&quot;Zerg Hydralisk Den&quot;</span><span class="p">:</span> <span class="mi">135</span><span class="p">,</span>
    <span class="s">&quot;Zerg Defiler Mound&quot;</span><span class="p">:</span> <span class="mi">136</span><span class="p">,</span>
    <span class="s">&quot;Zerg Greater Spire&quot;</span><span class="p">:</span> <span class="mi">137</span><span class="p">,</span>
    <span class="s">&quot;Zerg Queen&#39;s Nest&quot;</span><span class="p">:</span> <span class="mi">138</span><span class="p">,</span>
    <span class="s">&quot;Zerg Evolution Chamber&quot;</span><span class="p">:</span> <span class="mi">139</span><span class="p">,</span>
    <span class="s">&quot;Zerg Ultralisk Cavern&quot;</span><span class="p">:</span> <span class="mi">140</span><span class="p">,</span>
    <span class="s">&quot;Zerg Spire&quot;</span><span class="p">:</span> <span class="mi">141</span><span class="p">,</span>
    <span class="s">&quot;Zerg Spawning Pool&quot;</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span>
    <span class="s">&quot;Zerg Creep Colony&quot;</span><span class="p">:</span> <span class="mi">143</span><span class="p">,</span>
    <span class="s">&quot;Zerg Spore Colony&quot;</span><span class="p">:</span> <span class="mi">144</span><span class="p">,</span>
    <span class="s">&quot;Unused Zerg Building1&quot;</span><span class="p">:</span> <span class="mi">145</span><span class="p">,</span>
    <span class="s">&quot;Zerg Sunken Colony&quot;</span><span class="p">:</span> <span class="mi">146</span><span class="p">,</span>
    <span class="s">&quot;Zerg Overmind (With Shell)&quot;</span><span class="p">:</span> <span class="mi">147</span><span class="p">,</span>
    <span class="s">&quot;Zerg Overmind&quot;</span><span class="p">:</span> <span class="mi">148</span><span class="p">,</span>
    <span class="s">&quot;Zerg Extractor&quot;</span><span class="p">:</span> <span class="mi">149</span><span class="p">,</span>
    <span class="s">&quot;Mature Chrysalis&quot;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
    <span class="s">&quot;Zerg Cerebrate&quot;</span><span class="p">:</span> <span class="mi">151</span><span class="p">,</span>
    <span class="s">&quot;Zerg Cerebrate Daggoth&quot;</span><span class="p">:</span> <span class="mi">152</span><span class="p">,</span>
    <span class="s">&quot;Unused Zerg Building2&quot;</span><span class="p">:</span> <span class="mi">153</span><span class="p">,</span>
    <span class="s">&quot;Protoss Nexus&quot;</span><span class="p">:</span> <span class="mi">154</span><span class="p">,</span>
    <span class="s">&quot;Protoss Robotics Facility&quot;</span><span class="p">:</span> <span class="mi">155</span><span class="p">,</span>
    <span class="s">&quot;Protoss Pylon&quot;</span><span class="p">:</span> <span class="mi">156</span><span class="p">,</span>
    <span class="s">&quot;Protoss Assimilator&quot;</span><span class="p">:</span> <span class="mi">157</span><span class="p">,</span>
    <span class="s">&quot;Unused Protoss Building1&quot;</span><span class="p">:</span> <span class="mi">158</span><span class="p">,</span>
    <span class="s">&quot;Protoss Observatory&quot;</span><span class="p">:</span> <span class="mi">159</span><span class="p">,</span>
    <span class="s">&quot;Protoss Gateway&quot;</span><span class="p">:</span> <span class="mi">160</span><span class="p">,</span>
    <span class="s">&quot;Unused Protoss Building2&quot;</span><span class="p">:</span> <span class="mi">161</span><span class="p">,</span>
    <span class="s">&quot;Protoss Photon Cannon&quot;</span><span class="p">:</span> <span class="mi">162</span><span class="p">,</span>
    <span class="s">&quot;Protoss Citadel of Adun&quot;</span><span class="p">:</span> <span class="mi">163</span><span class="p">,</span>
    <span class="s">&quot;Protoss Cybernetics Core&quot;</span><span class="p">:</span> <span class="mi">164</span><span class="p">,</span>
    <span class="s">&quot;Protoss Templar Archives&quot;</span><span class="p">:</span> <span class="mi">165</span><span class="p">,</span>
    <span class="s">&quot;Protoss Forge&quot;</span><span class="p">:</span> <span class="mi">166</span><span class="p">,</span>
    <span class="s">&quot;Protoss Stargate&quot;</span><span class="p">:</span> <span class="mi">167</span><span class="p">,</span>
    <span class="s">&quot;Stasis Cell/Prison&quot;</span><span class="p">:</span> <span class="mi">168</span><span class="p">,</span>
    <span class="s">&quot;Protoss Fleet Beacon&quot;</span><span class="p">:</span> <span class="mi">169</span><span class="p">,</span>
    <span class="s">&quot;Protoss Arbiter Tribunal&quot;</span><span class="p">:</span> <span class="mi">170</span><span class="p">,</span>
    <span class="s">&quot;Protoss Robotics Support Bay&quot;</span><span class="p">:</span> <span class="mi">171</span><span class="p">,</span>
    <span class="s">&quot;Protoss Shield Battery&quot;</span><span class="p">:</span> <span class="mi">172</span><span class="p">,</span>
    <span class="s">&quot;Khaydarin Crystal Formation&quot;</span><span class="p">:</span> <span class="mi">173</span><span class="p">,</span>
    <span class="s">&quot;Protoss Temple&quot;</span><span class="p">:</span> <span class="mi">174</span><span class="p">,</span>
    <span class="s">&quot;Xel&#39;Naga Temple&quot;</span><span class="p">:</span> <span class="mi">175</span><span class="p">,</span>
    <span class="s">&quot;Mineral Field (Type 1)&quot;</span><span class="p">:</span> <span class="mi">176</span><span class="p">,</span>
    <span class="s">&quot;Mineral Field (Type 2)&quot;</span><span class="p">:</span> <span class="mi">177</span><span class="p">,</span>
    <span class="s">&quot;Mineral Field (Type 3)&quot;</span><span class="p">:</span> <span class="mi">178</span><span class="p">,</span>
    <span class="s">&quot;Cave (Unused)&quot;</span><span class="p">:</span> <span class="mi">179</span><span class="p">,</span>
    <span class="s">&quot;Cave-in (Unused)&quot;</span><span class="p">:</span> <span class="mi">180</span><span class="p">,</span>
    <span class="s">&quot;Cantina (Unused)&quot;</span><span class="p">:</span> <span class="mi">181</span><span class="p">,</span>
    <span class="s">&quot;Mining Platform (Unused)&quot;</span><span class="p">:</span> <span class="mi">182</span><span class="p">,</span>
    <span class="s">&quot;Independent Command Center (Unused)&quot;</span><span class="p">:</span> <span class="mi">183</span><span class="p">,</span>
    <span class="s">&quot;Independent Starport (Unused)&quot;</span><span class="p">:</span> <span class="mi">184</span><span class="p">,</span>
    <span class="s">&quot;Independent Jump Gate (Unused)&quot;</span><span class="p">:</span> <span class="mi">185</span><span class="p">,</span>
    <span class="s">&quot;Ruins (Unused)&quot;</span><span class="p">:</span> <span class="mi">186</span><span class="p">,</span>
    <span class="s">&quot;Khaydarin Crystal Formation (Unused)&quot;</span><span class="p">:</span> <span class="mi">187</span><span class="p">,</span>
    <span class="s">&quot;Vespene Geyser&quot;</span><span class="p">:</span> <span class="mi">188</span><span class="p">,</span>
    <span class="s">&quot;Warp Gate&quot;</span><span class="p">:</span> <span class="mi">189</span><span class="p">,</span>
    <span class="s">&quot;Psi Disrupter&quot;</span><span class="p">:</span> <span class="mi">190</span><span class="p">,</span>
    <span class="s">&quot;Zerg Marker&quot;</span><span class="p">:</span> <span class="mi">191</span><span class="p">,</span>
    <span class="s">&quot;Terran Marker&quot;</span><span class="p">:</span> <span class="mi">192</span><span class="p">,</span>
    <span class="s">&quot;Protoss Marker&quot;</span><span class="p">:</span> <span class="mi">193</span><span class="p">,</span>
    <span class="s">&quot;Zerg Beacon&quot;</span><span class="p">:</span> <span class="mi">194</span><span class="p">,</span>
    <span class="s">&quot;Terran Beacon&quot;</span><span class="p">:</span> <span class="mi">195</span><span class="p">,</span>
    <span class="s">&quot;Protoss Beacon&quot;</span><span class="p">:</span> <span class="mi">196</span><span class="p">,</span>
    <span class="s">&quot;Zerg Flag Beacon&quot;</span><span class="p">:</span> <span class="mi">197</span><span class="p">,</span>
    <span class="s">&quot;Terran Flag Beacon&quot;</span><span class="p">:</span> <span class="mi">198</span><span class="p">,</span>
    <span class="s">&quot;Protoss Flag Beacon&quot;</span><span class="p">:</span> <span class="mi">199</span><span class="p">,</span>
    <span class="s">&quot;Power Generator&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s">&quot;Overmind Cocoon&quot;</span><span class="p">:</span> <span class="mi">201</span><span class="p">,</span>
    <span class="s">&quot;Dark Swarm&quot;</span><span class="p">:</span> <span class="mi">202</span><span class="p">,</span>
    <span class="s">&quot;Floor Missile Trap&quot;</span><span class="p">:</span> <span class="mi">203</span><span class="p">,</span>
    <span class="s">&quot;Floor Hatch (Unused)&quot;</span><span class="p">:</span> <span class="mi">204</span><span class="p">,</span>
    <span class="s">&quot;Left Upper Level Door&quot;</span><span class="p">:</span> <span class="mi">205</span><span class="p">,</span>
    <span class="s">&quot;Right Upper Level Door&quot;</span><span class="p">:</span> <span class="mi">206</span><span class="p">,</span>
    <span class="s">&quot;Left Pit Door&quot;</span><span class="p">:</span> <span class="mi">207</span><span class="p">,</span>
    <span class="s">&quot;Right Pit Door&quot;</span><span class="p">:</span> <span class="mi">208</span><span class="p">,</span>
    <span class="s">&quot;Floor Gun Trap&quot;</span><span class="p">:</span> <span class="mi">209</span><span class="p">,</span>
    <span class="s">&quot;Left Wall Missile Trap&quot;</span><span class="p">:</span> <span class="mi">210</span><span class="p">,</span>
    <span class="s">&quot;Left Wall Flame Trap&quot;</span><span class="p">:</span> <span class="mi">211</span><span class="p">,</span>
    <span class="s">&quot;Right Wall Missile Trap&quot;</span><span class="p">:</span> <span class="mi">212</span><span class="p">,</span>
    <span class="s">&quot;Right Wall Flame Trap&quot;</span><span class="p">:</span> <span class="mi">213</span><span class="p">,</span>
    <span class="s">&quot;Start Location&quot;</span><span class="p">:</span> <span class="mi">214</span><span class="p">,</span>
    <span class="s">&quot;Flag&quot;</span><span class="p">:</span> <span class="mi">215</span><span class="p">,</span>
    <span class="s">&quot;Young Chrysalis&quot;</span><span class="p">:</span> <span class="mi">216</span><span class="p">,</span>
    <span class="s">&quot;Psi Emitter&quot;</span><span class="p">:</span> <span class="mi">217</span><span class="p">,</span>
    <span class="s">&quot;Data Disc&quot;</span><span class="p">:</span> <span class="mi">218</span><span class="p">,</span>
    <span class="s">&quot;Khaydarin Crystal&quot;</span><span class="p">:</span> <span class="mi">219</span><span class="p">,</span>
    <span class="s">&quot;Mineral Cluster Type 1&quot;</span><span class="p">:</span> <span class="mi">220</span><span class="p">,</span>
    <span class="s">&quot;Mineral Cluster Type 2&quot;</span><span class="p">:</span> <span class="mi">221</span><span class="p">,</span>
    <span class="s">&quot;Protoss Vespene Gas Orb Type 1&quot;</span><span class="p">:</span> <span class="mi">222</span><span class="p">,</span>
    <span class="s">&quot;Protoss Vespene Gas Orb Type 2&quot;</span><span class="p">:</span> <span class="mi">223</span><span class="p">,</span>
    <span class="s">&quot;Zerg Vespene Gas Sac Type 1&quot;</span><span class="p">:</span> <span class="mi">224</span><span class="p">,</span>
    <span class="s">&quot;Zerg Vespene Gas Sac Type 2&quot;</span><span class="p">:</span> <span class="mi">225</span><span class="p">,</span>
    <span class="s">&quot;Terran Vespene Gas Tank Type 1&quot;</span><span class="p">:</span> <span class="mi">226</span><span class="p">,</span>
    <span class="s">&quot;Terran Vespene Gas Tank Type 2&quot;</span><span class="p">:</span> <span class="mi">227</span><span class="p">,</span>
    <span class="s">&quot;(any unit)&quot;</span><span class="p">:</span> <span class="mi">229</span><span class="p">,</span>
    <span class="s">&quot;(men)&quot;</span><span class="p">:</span> <span class="mi">230</span><span class="p">,</span>
    <span class="s">&quot;(buildings)&quot;</span><span class="p">:</span> <span class="mi">231</span><span class="p">,</span>
    <span class="s">&quot;(factories)&quot;</span><span class="p">:</span> <span class="mi">232</span>
<span class="p">}</span>

<span class="c"># ======================================</span>

<span class="c"># Data from http://cafe.daum.net/rpgguild/6cWR/158</span>
<span class="c"># Original data from ScAIEdit</span>
<span class="n">DefAIScriptDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c"># Custom AI Scripts</span>
    <span class="n">b</span><span class="s">&#39;Terran Custom Level&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TMCu&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg Custom Level&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZMCu&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss Custom Level&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PMCu&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran Expansion Custom Level&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TMCx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg Expansion Custom Level&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZMCx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss Expansion Custom Level&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PMCx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran Campaign Easy&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TLOf&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran Campaign Medium&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TMED&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran Campaign Difficult&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;THIf&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran Campaign Insane&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TSUP&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran Campaign Area Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TARE&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg Campaign Easy&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZLOf&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg Campaign Medium&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZMED&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg Campaign Difficult&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZHIf&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg Campaign Insane&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZSUP&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg Campaign Area Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZARE&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss Campaign Easy&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PLOf&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss Campaign Medium&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PMED&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss Campaign Difficult&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PHIf&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss Campaign Insane&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PSUP&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss Campaign Area Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PARE&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Terran Campaign Easy&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TLOx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Terran Campaign Medium&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TMEx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Terran Campaign Difficult&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;THIx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Terran Campaign Insane&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TSUx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Terran Campaign Area Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TARx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Zerg Campaign Easy&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZLOx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Zerg Campaign Medium&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZMEx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Zerg Campaign Difficult&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZHIx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Zerg Campaign Insane&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZSUx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Zerg Campaign Area Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZARx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Protoss Campaign Easy&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PLOx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Protoss Campaign Medium&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PMEx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Protoss Campaign Difficult&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PHIx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Protoss Campaign Insane&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PSUx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Expansion Protoss Campaign Area Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PARx&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Send All Units on Strategic Suicide Missions&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Suic&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Send All Units on Random Suicide Missions&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;SuiR&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Switch Computer Player to Rescue Passive&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Rscu&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn ON Shared Vision for Player 1&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;+Vi0&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn ON Shared Vision for Player 2&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;+Vi1&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn ON Shared Vision for Player 3&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;+Vi2&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn ON Shared Vision for Player 4&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;+Vi3&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn ON Shared Vision for Player 5&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;+Vi4&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn ON Shared Vision for Player 6&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;+Vi5&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn ON Shared Vision for Player 7&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;+Vi6&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn ON Shared Vision for Player 8&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;+Vi7&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn OFF Shared Vision for Player 1&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;-Vi0&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn OFF Shared Vision for Player 2&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;-Vi1&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn OFF Shared Vision for Player 3&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;-Vi2&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn OFF Shared Vision for Player 4&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;-Vi3&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn OFF Shared Vision for Player 5&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;-Vi4&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn OFF Shared Vision for Player 6&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;-Vi5&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn OFF Shared Vision for Player 7&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;-Vi6&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Turn OFF Shared Vision for Player 8&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;-Vi7&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Move Dark Templars to Region&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;MvTe&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Clear Previous Combat Data&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ClrC&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Set Player to Enemy&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Enmy&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Set Player to Ally  &#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;y   &#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Value This Area Higher&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;VluA&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Enter Closest Bunker&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;EnBk&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Set Generic Command Target&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;StTg&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Make These Units Patrol&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;StPt&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Enter Transport&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;EnTr&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Exit Transport&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ExTr&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;AI Nuke Here&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;NuHe&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;AI Harass Here&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;HaHe&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Set Unit Order To: Junk Yard Dog&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;JYDg&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Disruption Web Here&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;DWHe&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Recall Here&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ReHe&#39;</span><span class="p">,</span>

    <span class="c"># StarCraft AI Scripts</span>
    <span class="n">b</span><span class="s">&#39;Terran 3 - Zerg Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Ter3&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 5 - Terran Main Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Ter5&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 5 - Terran Harvest Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Te5H&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 6 - Air Attack Zerg&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Ter6&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 6 - Ground Attack Zerg&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Te6b&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 6 - Zerg Support Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Te6c&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 7 - Bottom Zerg Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Ter7&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 7 - Right Zerg Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Te7s&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 7 - Middle Zerg Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Te7m&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 8 - Confederate Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Ter8&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 9 - Light Attack&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Tr9L&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 9 - Heavy Attack&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Tr9H&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 10 - Confederate Towns&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Te10&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 11 - Zerg Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;T11z&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 11 - Lower Protoss Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;T11a&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 11 - Upper Protoss Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;T11b&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 12 - Nuke Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;T12N&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 12 - Phoenix Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;T12P&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 12 - Tank Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;T12T&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 1 - Electronic Distribution&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TED1&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 2 - Electronic Distribution&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TED2&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 3 - Electronic Distribution&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TED3&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 1 - Shareware&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TSW1&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 2 - Shareware&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TSW2&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 3 - Shareware&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TSW3&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 4 - Shareware&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TSW4&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Terran 5 - Shareware&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TSW5&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 1 - Terran Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Zer1&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 2 - Protoss Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Zer2&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 3 - Terran Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Zer3&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 4 - Right Terran Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Zer4&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 4 - Lower Terran Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Ze4S&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 6 - Protoss Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Zer6&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 7 - Air Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Zr7a&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 7 - Ground Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Zr7g&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 7 - Support Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Zr7s&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 8 - Scout Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Zer8&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 8 - Templar Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Ze8T&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 9 - Teal Protoss&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Zer9&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 9 - Left Yellow Protoss&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Z9ly&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 9 - Right Yellow Protoss&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Z9ry&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 9 - Left Orange Protoss&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Z9lo&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 9 - Right Orange Protoss&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Z9ro&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 10 - Left Teal (Attack&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Z10a&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 10 - Right Teal (Support&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Z10b&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 10 - Left Yellow (Support&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Z10c&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 10 - Right Yellow (Attack&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Z10d&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Zerg 10 - Red Protoss&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Z10e&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 1 - Zerg Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pro1&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 2 - Zerg Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pro2&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 3 - Air Zerg Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr3R&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 3 - Ground Zerg Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr3G&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 4 - Zerg Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pro4&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 5 - Zerg Town Island&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr5I&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 5 - Zerg Town Base&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr5B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 7 - Left Protoss Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pro7&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 7 - Right Protoss Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr7B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 7 - Shrine Protoss&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr7S&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 8 - Left Protoss Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pro8&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 8 - Right Protoss Town&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr8B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 8 - Protoss Defenders&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr8D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 9 - Ground Zerg&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pro9&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 9 - Air Zerg&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr9W&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 9 - Spell Zerg&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr9Y&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 10 - Mini-Towns&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;Pr10&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 10 - Mini-Town Master&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;P10C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Protoss 10 - Overmind Defenders&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;P10o&#39;</span><span class="p">,</span>

    <span class="c"># Brood Wars AI Scripts</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 1 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB1A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 1 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB1B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 1 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB1C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 1 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB1D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 1 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB1E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 1 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB1F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 2 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB2A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 2 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB2B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 2 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB2C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 2 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB2D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 2 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB2E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 2 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB2F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 3 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB3A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 3 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB3B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 3 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB3C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 3 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB3D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 3 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB3E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 3 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB3F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 4 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB4A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 4 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB4B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 4 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB4C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 4 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB4D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 4 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB4E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 4 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB4F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 5 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB5A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 5 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB5B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 5 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB5C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 5 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB5D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 5 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB5E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 5 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB5F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 6 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB6A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 6 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB6B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 6 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB6C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 6 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB6D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 6 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB6E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 6 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB6F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 7 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB7A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 7 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB7B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 7 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB7C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 7 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB7D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 7 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB7E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 7 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB7F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 8 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB8A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 8 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB8B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 8 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB8C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 8 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB8D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 8 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB8E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Protoss 8 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;PB8F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 1 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB1A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 1 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB1B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 1 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB1C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 1 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB1D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 1 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB1E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 1 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB1F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 2 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB2A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 2 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB2B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 2 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB2C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 2 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB2D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 2 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB2E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 2 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB2F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 3 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB3A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 3 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB3B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 3 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB3C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 3 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB3D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 3 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB3E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 3 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB3F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 4 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB4A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 4 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB4B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 4 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB4C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 4 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB4D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 4 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB4E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 4 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB4F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 5 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB5A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 5 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB5B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 5 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB5C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 5 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB5D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 5 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB5E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 5 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB5F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 6 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB6A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 6 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB6B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 6 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB6C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 6 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB6D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 6 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB6E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 6 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB6F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 7 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB7A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 7 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB7B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 7 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB7C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 7 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB7D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 7 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB7E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 7 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB7F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 8 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB8A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 8 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB8B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 8 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB8C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 8 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB8D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 8 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB8E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Terran 8 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;TB8F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 1 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB1A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 1 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB1B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 1 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB1C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 1 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB1D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 1 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB1E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 1 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB1F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 2 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB2A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 2 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB2B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 2 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB2C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 2 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB2D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 2 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB2E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 2 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB2F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 3 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB3A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 3 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB3B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 3 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB3C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 3 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB3D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 3 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB3E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 3 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB3F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 4 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB4A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 4 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB4B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 4 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB4C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 4 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB4D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 4 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB4E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 4 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB4F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 5 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB5A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 5 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB5B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 5 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB5C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 5 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB5D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 5 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB5E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 5 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB5F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 6 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB6A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 6 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB6B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 6 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB6C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 6 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB6D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 6 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB6E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 6 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB6F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 7 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB7A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 7 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB7B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 7 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB7C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 7 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB7D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 7 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB7E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 7 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB7F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 8 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB8A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 8 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB8B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 8 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB8C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 8 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB8D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 8 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB8E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 8 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB8F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 9 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB9A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 9 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB9B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 9 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB9C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 9 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB9D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 9 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB9E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 9 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB9F&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 10 - Town A&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB0A&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 10 - Town B&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB0B&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 10 - Town C&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB0C&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 10 - Town D&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB0D&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 10 - Town E&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB0E&#39;</span><span class="p">,</span>
    <span class="n">b</span><span class="s">&#39;Brood Wars Zerg 10 - Town F&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s">&#39;ZB0F&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\trigger\strenc.py : 62 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..mapdata</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">GetLocationIndex</span><span class="p">,</span>
    <span class="n">GetStringIndex</span><span class="p">,</span>
    <span class="n">GetSwitchIndex</span><span class="p">,</span>
    <span class="n">GetUnitIndex</span><span class="p">,</span>
    <span class="n">IsMapdataInitalized</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">u2b</span><span class="p">,</span> <span class="n">b2i4</span>

<span class="kn">from</span> <span class="nn">.strdict</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DefAIScriptDict</span><span class="p">,</span>
    <span class="n">DefLocationDict</span><span class="p">,</span>
    <span class="n">DefSwitchDict</span><span class="p">,</span>
    <span class="n">DefUnitDict</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeAIScript</span><span class="p">(</span><span class="n">ais</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ais</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">ais</span> <span class="o">=</span> <span class="n">u2b</span><span class="p">(</span><span class="n">ais</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ais</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ais</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;AIScript name too short&#39;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ais</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">b2i4</span><span class="p">(</span><span class="n">DefAIScriptDict</span><span class="p">[</span><span class="n">ais</span><span class="p">])</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ais</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">b2i4</span><span class="p">(</span><span class="n">ais</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ais</span>


<span class="k">def</span> <span class="nf">_EncodeAny</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dl</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c"># unhashable</span>
            <span class="k">return</span> <span class="n">s</span>


<span class="k">def</span> <span class="nf">EncodeLocation</span><span class="p">(</span><span class="n">loc</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_EncodeAny</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">GetLocationIndex</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DefLocationDict</span><span class="p">,</span> <span class="n">loc</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeString</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_EncodeAny</span><span class="p">(</span><span class="n">GetStringIndex</span><span class="p">,</span> <span class="p">{},</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeSwitch</span><span class="p">(</span><span class="n">sw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_EncodeAny</span><span class="p">(</span><span class="n">GetSwitchIndex</span><span class="p">,</span> <span class="n">DefSwitchDict</span><span class="p">,</span> <span class="n">sw</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EncodeUnit</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_EncodeAny</span><span class="p">(</span><span class="n">GetUnitIndex</span><span class="p">,</span> <span class="n">DefUnitDict</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\trigger\trigger.py : 77 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..eudobj</span> <span class="kn">import</span> <span class="n">EUDObject</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">FlattenList</span>
<span class="kn">from</span> <span class="nn">.triggerscope</span> <span class="kn">import</span> <span class="n">NextTrigger</span><span class="p">,</span> <span class="n">_RegisterTrigger</span>
<span class="kn">from</span> <span class="nn">.condition</span> <span class="kn">import</span> <span class="n">Condition</span>
<span class="kn">from</span> <span class="nn">.action</span> <span class="kn">import</span> <span class="n">Action</span>


<span class="k">class</span> <span class="nc">Trigger</span><span class="p">(</span><span class="n">EUDObject</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nextptr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">conditions</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">actions</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">preserved</span><span class="o">=</span><span class="bp">True</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

        <span class="n">_RegisterTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c"># This should be called before (1)</span>

        <span class="k">if</span> <span class="n">nextptr</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">nextptr</span> <span class="o">=</span> <span class="n">NextTrigger</span><span class="p">()</span>  <span class="c"># (1)</span>

        <span class="k">if</span> <span class="n">conditions</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">conditions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">actions</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">conditions</span> <span class="o">=</span> <span class="n">FlattenList</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">FlattenList</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">16</span><span class="p">,</span> <span class="s">&#39;Too many conditions&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">64</span><span class="p">,</span> <span class="s">&#39;Too many actions&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_nextptr</span> <span class="o">=</span> <span class="n">nextptr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conditions</span> <span class="o">=</span> <span class="n">conditions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_preserved</span> <span class="o">=</span> <span class="n">preserved</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cond</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_conditions</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">Condition</span><span class="p">)</span>
            <span class="n">cond</span><span class="o">.</span><span class="n">SetParentTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">act</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">act</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
            <span class="n">act</span><span class="o">.</span><span class="n">SetParentTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">GetDataSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2408</span>

    <span class="k">def</span> <span class="nf">WritePayload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbuffer</span><span class="p">):</span>
        <span class="n">pbuffer</span><span class="o">.</span><span class="n">WriteDword</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pbuffer</span><span class="o">.</span><span class="n">WriteDword</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nextptr</span><span class="p">)</span>

        <span class="c"># Conditions</span>
        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conditions</span><span class="p">:</span>
            <span class="n">cond</span><span class="o">.</span><span class="n">WritePayload</span><span class="p">(</span><span class="n">pbuffer</span><span class="p">)</span>

        <span class="n">pbuffer</span><span class="o">.</span><span class="n">WriteBytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="p">(</span><span class="mi">16</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_conditions</span><span class="p">))))</span>

        <span class="c"># Actions</span>
        <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="p">:</span>
            <span class="n">act</span><span class="o">.</span><span class="n">WritePayload</span><span class="p">(</span><span class="n">pbuffer</span><span class="p">)</span>

        <span class="n">pbuffer</span><span class="o">.</span><span class="n">WriteBytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="mi">32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">64</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="p">))))</span>

        <span class="c"># Preserved flag</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preserved</span><span class="p">:</span>
            <span class="n">pbuffer</span><span class="o">.</span><span class="n">WriteDword</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">pbuffer</span><span class="o">.</span><span class="n">WriteDword</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">pbuffer</span><span class="o">.</span><span class="n">WriteBytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\trigger\triggerscope.py : 30 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">EUDCreateBlock</span><span class="p">,</span> <span class="n">EUDGetLastBlockOfName</span><span class="p">,</span> <span class="n">EUDPopBlock</span>
<span class="kn">from</span> <span class="nn">..allocator</span> <span class="kn">import</span> <span class="n">Forward</span>


<span class="k">def</span> <span class="nf">PushTriggerScope</span><span class="p">():</span>
    <span class="n">EUDCreateBlock</span><span class="p">(</span><span class="s">&#39;triggerscope&#39;</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">&#39;nexttrigger_list&#39;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="bp">True</span>  <span class="c"># Allow `if PushTriggerScope()` syntax for indent</span>


<span class="k">def</span> <span class="nf">NextTrigger</span><span class="p">():</span>
    <span class="n">fw</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">()</span>
    <span class="n">nt_list</span> <span class="o">=</span> <span class="n">EUDGetLastBlockOfName</span><span class="p">(</span><span class="s">&#39;triggerscope&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;nexttrigger_list&#39;</span><span class="p">]</span>
    <span class="n">nt_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fw</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fw</span>


<span class="k">def</span> <span class="nf">_RegisterTrigger</span><span class="p">(</span><span class="n">trg</span><span class="p">):</span>
    <span class="n">nt_list</span> <span class="o">=</span> <span class="n">EUDGetLastBlockOfName</span><span class="p">(</span><span class="s">&#39;triggerscope&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;nexttrigger_list&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">fw</span> <span class="ow">in</span> <span class="n">nt_list</span><span class="p">:</span>
        <span class="n">fw</span> <span class="o">&lt;&lt;</span> <span class="n">trg</span>
    <span class="n">nt_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">PopTriggerScope</span><span class="p">():</span>
    <span class="n">nt_list</span> <span class="o">=</span> <span class="n">EUDPopBlock</span><span class="p">(</span><span class="s">&#39;triggerscope&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;nexttrigger_list&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">fw</span> <span class="ow">in</span> <span class="n">nt_list</span><span class="p">:</span>
        <span class="n">fw</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\trigger\__init__.py : 42 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.trigger</span> <span class="kn">import</span> <span class="n">Trigger</span>
<span class="kn">from</span> <span class="nn">.triggerscope</span> <span class="kn">import</span> <span class="n">PushTriggerScope</span><span class="p">,</span> <span class="n">PopTriggerScope</span><span class="p">,</span> <span class="n">NextTrigger</span>
<span class="kn">from</span> <span class="nn">.condition</span> <span class="kn">import</span> <span class="n">Condition</span>
<span class="kn">from</span> <span class="nn">.action</span> <span class="kn">import</span> <span class="n">Action</span>
<span class="kn">from</span> <span class="nn">.stockcond</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">NoCondition</span><span class="p">,</span> <span class="n">CountdownTimer</span><span class="p">,</span> <span class="n">Command</span><span class="p">,</span> <span class="n">Bring</span><span class="p">,</span> <span class="n">Accumulate</span><span class="p">,</span> <span class="n">Kills</span><span class="p">,</span>
    <span class="n">CommandMost</span><span class="p">,</span> <span class="n">CommandMostAt</span><span class="p">,</span> <span class="n">MostKills</span><span class="p">,</span> <span class="n">HighestScore</span><span class="p">,</span> <span class="n">MostResources</span><span class="p">,</span>
    <span class="n">Switch</span><span class="p">,</span> <span class="n">ElapsedTime</span><span class="p">,</span> <span class="n">Briefing</span><span class="p">,</span> <span class="n">Opponents</span><span class="p">,</span> <span class="n">Deaths</span><span class="p">,</span> <span class="n">CommandLeast</span><span class="p">,</span>
    <span class="n">CommandLeastAt</span><span class="p">,</span> <span class="n">LeastKills</span><span class="p">,</span> <span class="n">LowestScore</span><span class="p">,</span> <span class="n">LeastResources</span><span class="p">,</span> <span class="n">Score</span><span class="p">,</span>
    <span class="n">Always</span><span class="p">,</span> <span class="n">Never</span><span class="p">,</span> <span class="n">Memory</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.stockact</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">NoAction</span><span class="p">,</span> <span class="n">Victory</span><span class="p">,</span> <span class="n">Defeat</span><span class="p">,</span> <span class="n">PreserveTrigger</span><span class="p">,</span> <span class="n">Wait</span><span class="p">,</span> <span class="n">PauseGame</span><span class="p">,</span>
    <span class="n">UnpauseGame</span><span class="p">,</span> <span class="n">Transmission</span><span class="p">,</span> <span class="n">PlayWAV</span><span class="p">,</span> <span class="n">DisplayText</span><span class="p">,</span> <span class="n">CenterView</span><span class="p">,</span>
    <span class="n">CreateUnitWithProperties</span><span class="p">,</span> <span class="n">SetMissionObjectives</span><span class="p">,</span> <span class="n">SetSwitch</span><span class="p">,</span>
    <span class="n">SetCountdownTimer</span><span class="p">,</span> <span class="n">RunAIScript</span><span class="p">,</span> <span class="n">RunAIScriptAt</span><span class="p">,</span> <span class="n">LeaderBoardControl</span><span class="p">,</span>
    <span class="n">LeaderBoardControlAt</span><span class="p">,</span> <span class="n">LeaderBoardResources</span><span class="p">,</span> <span class="n">LeaderBoardKills</span><span class="p">,</span>
    <span class="n">LeaderBoardScore</span><span class="p">,</span> <span class="n">KillUnit</span><span class="p">,</span> <span class="n">KillUnitAt</span><span class="p">,</span> <span class="n">RemoveUnit</span><span class="p">,</span> <span class="n">RemoveUnitAt</span><span class="p">,</span>
    <span class="n">SetResources</span><span class="p">,</span> <span class="n">SetScore</span><span class="p">,</span> <span class="n">MinimapPing</span><span class="p">,</span> <span class="n">TalkingPortrait</span><span class="p">,</span> <span class="n">MuteUnitSpeech</span><span class="p">,</span>
    <span class="n">UnMuteUnitSpeech</span><span class="p">,</span> <span class="n">LeaderBoardComputerPlayers</span><span class="p">,</span> <span class="n">LeaderBoardGoalControl</span><span class="p">,</span>
    <span class="n">LeaderBoardGoalControlAt</span><span class="p">,</span> <span class="n">LeaderBoardGoalResources</span><span class="p">,</span>
    <span class="n">LeaderBoardGoalKills</span><span class="p">,</span> <span class="n">LeaderBoardGoalScore</span><span class="p">,</span> <span class="n">MoveLocation</span><span class="p">,</span> <span class="n">MoveUnit</span><span class="p">,</span>
    <span class="n">LeaderBoardGreed</span><span class="p">,</span> <span class="n">SetNextScenario</span><span class="p">,</span> <span class="n">SetDoodadState</span><span class="p">,</span> <span class="n">SetInvincibility</span><span class="p">,</span>
    <span class="n">CreateUnit</span><span class="p">,</span> <span class="n">SetDeaths</span><span class="p">,</span> <span class="n">Order</span><span class="p">,</span> <span class="n">Comment</span><span class="p">,</span> <span class="n">GiveUnits</span><span class="p">,</span> <span class="n">ModifyUnitHitPoints</span><span class="p">,</span>
    <span class="n">ModifyUnitEnergy</span><span class="p">,</span> <span class="n">ModifyUnitShields</span><span class="p">,</span> <span class="n">ModifyUnitResourceAmount</span><span class="p">,</span>
    <span class="n">ModifyUnitHangarCount</span><span class="p">,</span> <span class="n">PauseTimer</span><span class="p">,</span> <span class="n">UnpauseTimer</span><span class="p">,</span> <span class="n">Draw</span><span class="p">,</span>
    <span class="n">SetAllianceStatus</span><span class="p">,</span> <span class="n">SetMemory</span><span class="p">,</span> <span class="n">SetNextPtr</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.constenc</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">All</span><span class="p">,</span> <span class="n">Enemy</span><span class="p">,</span> <span class="n">Ally</span><span class="p">,</span> <span class="n">AlliedVictory</span><span class="p">,</span> <span class="n">AtLeast</span><span class="p">,</span> <span class="n">AtMost</span><span class="p">,</span> <span class="n">Exactly</span><span class="p">,</span> <span class="n">SetTo</span><span class="p">,</span> <span class="n">Add</span><span class="p">,</span>
    <span class="n">Subtract</span><span class="p">,</span> <span class="n">Move</span><span class="p">,</span> <span class="n">Patrol</span><span class="p">,</span> <span class="n">Attack</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span>
    <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">Player1</span><span class="p">,</span> <span class="n">Player2</span><span class="p">,</span> <span class="n">Player3</span><span class="p">,</span> <span class="n">Player4</span><span class="p">,</span> <span class="n">Player5</span><span class="p">,</span> <span class="n">Player6</span><span class="p">,</span>
    <span class="n">Player7</span><span class="p">,</span> <span class="n">Player8</span><span class="p">,</span> <span class="n">Player9</span><span class="p">,</span> <span class="n">Player10</span><span class="p">,</span> <span class="n">Player11</span><span class="p">,</span> <span class="n">Player12</span><span class="p">,</span>
    <span class="n">CurrentPlayer</span><span class="p">,</span> <span class="n">Foes</span><span class="p">,</span> <span class="n">Allies</span><span class="p">,</span> <span class="n">NeutralPlayers</span><span class="p">,</span> <span class="n">AllPlayers</span><span class="p">,</span> <span class="n">Force1</span><span class="p">,</span>
    <span class="n">Force2</span><span class="p">,</span> <span class="n">Force3</span><span class="p">,</span> <span class="n">Force4</span><span class="p">,</span> <span class="n">NonAlliedVictoryPlayers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Disable</span><span class="p">,</span>
    <span class="n">Toggle</span><span class="p">,</span> <span class="n">Ore</span><span class="p">,</span> <span class="n">Gas</span><span class="p">,</span> <span class="n">OreAndGas</span><span class="p">,</span> <span class="n">Total</span><span class="p">,</span> <span class="n">Units</span><span class="p">,</span> <span class="n">Buildings</span><span class="p">,</span>
    <span class="n">UnitsAndBuildings</span><span class="p">,</span> <span class="n">Kills</span><span class="p">,</span> <span class="n">Razings</span><span class="p">,</span> <span class="n">KillsAndRazings</span><span class="p">,</span> <span class="n">Custom</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span>
    <span class="n">Clear</span><span class="p">,</span> <span class="n">Random</span><span class="p">,</span> <span class="n">Cleared</span>
<span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\utils\binio.py : 33 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">b2i1</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">b2i2</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">|</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">b2i4</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">b</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">|</span>
        <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span>
        <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span>
        <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">i2b1</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">((</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,))</span>


<span class="k">def</span> <span class="nf">i2b2</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">((</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">i2b4</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">((</span>
        <span class="n">i</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
        <span class="p">(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
        <span class="p">(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
        <span class="p">(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
    <span class="p">))</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\utils\blockstru.py : 56 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">BlockStruManager</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_blockstru</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lastblockdict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blockstru</span>


<span class="n">_current_bsm</span> <span class="o">=</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">SetCurrentBlockStruManager</span><span class="p">(</span><span class="n">bsm</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">_current_bsm</span>
    <span class="n">old_bsm</span> <span class="o">=</span> <span class="n">_current_bsm</span>
    <span class="n">_current_bsm</span> <span class="o">=</span> <span class="n">bsm</span>
    <span class="k">return</span> <span class="n">old_bsm</span>


<span class="k">def</span> <span class="nf">EUDCreateBlock</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">userdata</span><span class="p">):</span>
    <span class="n">_blockstru</span> <span class="o">=</span> <span class="n">_current_bsm</span><span class="o">.</span><span class="n">_blockstru</span>
    <span class="n">_lastblockdict</span> <span class="o">=</span> <span class="n">_current_bsm</span><span class="o">.</span><span class="n">_lastblockdict</span>

    <span class="n">block</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">userdata</span><span class="p">)</span>
    <span class="n">_blockstru</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_lastblockdict</span><span class="p">:</span>
        <span class="n">_lastblockdict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_lastblockdict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EUDGetLastBlock</span><span class="p">():</span>
    <span class="n">_blockstru</span> <span class="o">=</span> <span class="n">_current_bsm</span><span class="o">.</span><span class="n">_blockstru</span>
    <span class="k">return</span> <span class="n">_blockstru</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">EUDGetLastBlockOfName</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">_lastblockdict</span> <span class="o">=</span> <span class="n">_current_bsm</span><span class="o">.</span><span class="n">_lastblockdict</span>

    <span class="k">return</span> <span class="n">_lastblockdict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">EUDPopBlock</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">_blockstru</span> <span class="o">=</span> <span class="n">_current_bsm</span><span class="o">.</span><span class="n">_blockstru</span>
    <span class="n">_lastblockdict</span> <span class="o">=</span> <span class="n">_current_bsm</span><span class="o">.</span><span class="n">_lastblockdict</span>

    <span class="n">lastblock</span> <span class="o">=</span> <span class="n">_blockstru</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">lastblock</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">,</span> <span class="s">&#39;Block starting/ending mismatch&#39;</span>
    <span class="n">_lastblockdict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">lastblock</span>


<span class="k">def</span> <span class="nf">EUDGetBlockList</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">_current_bsm</span><span class="o">.</span><span class="n">_blockstru</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\utils\ubconv.py : 17 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">locale</span>

<span class="n">g_encoding</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">getpreferredencoding</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">UbconvSetEncoding</span><span class="p">(</span><span class="n">encoding</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">g_encoding</span>
    <span class="n">g_encoding</span> <span class="o">=</span> <span class="n">encoding</span>


<span class="k">def</span> <span class="nf">u2b</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">g_encoding</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">b2u</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">g_encoding</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\utils\utils.py : 109 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">collections</span>


<span class="k">def</span> <span class="nf">FlattenList</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">bytes</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">l</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">FlattenList</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c"># l is not iterable</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">l</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">EPD</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mh">0x58A364</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>


<span class="c"># -------</span>

<span class="k">def</span> <span class="nf">List2Assignable</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">l</span>


<span class="k">def</span> <span class="nf">Assignable2List</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>


<span class="c"># -------</span>

<span class="c"># Original code from TrigEditPlus::ConvertString_SCMD2ToRaw</span>

<span class="k">def</span> <span class="nf">SCMD2Text</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\0</span><span class="s">&#39;</span>  <span class="c"># zero terminate</span>

    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">toxdigit</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">b</span><span class="s">&#39;0&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="s">&#39;9&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">48</span>
        <span class="k">elif</span> <span class="n">b</span><span class="s">&#39;a&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="s">&#39;z&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">97</span> <span class="o">+</span> <span class="mi">10</span>
        <span class="k">elif</span> <span class="n">b</span><span class="s">&#39;A&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="s">&#39;Z&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">65</span> <span class="o">+</span> <span class="mi">10</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&lt;&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;&lt;&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>

        <span class="k">elif</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&gt;&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;&gt;&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>

        <span class="k">elif</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;&lt;R&gt;&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\x12</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="k">elif</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;&lt;C&gt;&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;</span><span class="se">\x13</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;&lt;&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span>
            <span class="n">toxdigit</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;&gt;&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bytes</span><span class="p">((</span>
                <span class="n">toxdigit</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span>
            <span class="p">)))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;&lt;&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span>
            <span class="n">toxdigit</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span>
            <span class="n">toxdigit</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;&gt;&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bytes</span><span class="p">((</span>
                <span class="p">(</span><span class="n">toxdigit</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">toxdigit</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]),</span>
            <span class="p">)))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span>

        <span class="k">elif</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\r</span><span class="s">&#39;</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bytes</span><span class="p">((</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">],)))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\core\utils\__init__.py : 20 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.ubconv</span> <span class="kn">import</span> <span class="n">u2b</span><span class="p">,</span> <span class="n">b2u</span>
<span class="kn">from</span> <span class="nn">.binio</span> <span class="kn">import</span> <span class="n">b2i1</span><span class="p">,</span> <span class="n">b2i2</span><span class="p">,</span> <span class="n">b2i4</span><span class="p">,</span> <span class="n">i2b1</span><span class="p">,</span> <span class="n">i2b2</span><span class="p">,</span> <span class="n">i2b4</span>
<span class="kn">from</span> <span class="nn">.blockstru</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EUDCreateBlock</span><span class="p">,</span>
    <span class="n">EUDGetLastBlock</span><span class="p">,</span>
    <span class="n">EUDGetLastBlockOfName</span><span class="p">,</span>
    <span class="n">EUDPopBlock</span><span class="p">,</span>
    <span class="n">EUDGetBlockList</span><span class="p">,</span>

    <span class="n">SetCurrentBlockStruManager</span><span class="p">,</span>
    <span class="n">BlockStruManager</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EPD</span><span class="p">,</span>
    <span class="n">FlattenList</span><span class="p">,</span>
    <span class="n">List2Assignable</span><span class="p">,</span>
    <span class="n">Assignable2List</span><span class="p">,</span>
    <span class="n">SCMD2Text</span>
<span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\ctrlstru\basicstru.py : 42 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>


<span class="k">def</span> <span class="nf">DoActions</span><span class="p">(</span><span class="n">actions</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">FlattenList</span><span class="p">(</span><span class="n">actions</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">EUDJump</span><span class="p">(</span><span class="n">nextptr</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">nextptr</span><span class="o">=</span><span class="n">nextptr</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EUDBranch</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">ontrue</span><span class="p">,</span> <span class="n">onfalse</span><span class="p">):</span>
    <span class="n">brtrg</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="n">ontruetrg</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>

    <span class="n">brtrg</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
        <span class="n">nextptr</span><span class="o">=</span><span class="n">onfalse</span><span class="p">,</span>
        <span class="n">conditions</span><span class="o">=</span><span class="n">conditions</span><span class="p">,</span>
        <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
            <span class="n">c</span><span class="o">.</span><span class="n">SetNextPtr</span><span class="p">(</span><span class="n">brtrg</span><span class="p">,</span> <span class="n">ontruetrg</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">ontruetrg</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
        <span class="n">nextptr</span><span class="o">=</span><span class="n">ontrue</span><span class="p">,</span>
        <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
            <span class="n">c</span><span class="o">.</span><span class="n">SetNextPtr</span><span class="p">(</span><span class="n">brtrg</span><span class="p">,</span> <span class="n">onfalse</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">EUDJumpIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">ontrue</span><span class="p">):</span>
    <span class="n">onfalse</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="n">EUDBranch</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">ontrue</span><span class="p">,</span> <span class="n">onfalse</span><span class="p">)</span>
    <span class="n">onfalse</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">EUDJumpIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">onfalse</span><span class="p">):</span>
    <span class="n">ontrue</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="n">EUDBranch</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">ontrue</span><span class="p">,</span> <span class="n">onfalse</span><span class="p">)</span>
    <span class="n">ontrue</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\ctrlstru\breakcont.py : 62 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.import</span> <span class="p">(</span>
    <span class="n">loopblock</span> <span class="k">as</span> <span class="n">lb</span><span class="p">,</span>
    <span class="n">swblock</span> <span class="k">as</span> <span class="n">sb</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>


<span class="k">def</span> <span class="nf">EUDContinue</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">lb</span><span class="o">.</span><span class="n">EUDLoopContinue</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">EUDContinueIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">lb</span><span class="o">.</span><span class="n">EUDLoopContinueIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EUDContinueIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">lb</span><span class="o">.</span><span class="n">EUDLoopContinueIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EUDSetContinuePoint</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">lb</span><span class="o">.</span><span class="n">EUDLoopSetContinuePoint</span><span class="p">()</span>


<span class="c"># -------</span>


<span class="k">def</span> <span class="nf">EUDBreak</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EUDGetBlockList</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">lb</span><span class="o">.</span><span class="n">_IsLoopBlockId</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">lb</span><span class="o">.</span><span class="n">EUDLoopBreak</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">sb</span><span class="o">.</span><span class="n">_IsSwitchBlockId</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">sb</span><span class="o">.</span><span class="n">EUDSwitchBreak</span><span class="p">()</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s">&#39;No loop/switch block surrounding this code area&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EUDBreakIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EUDGetBlockList</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">lb</span><span class="o">.</span><span class="n">_IsLoopBlockId</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">lb</span><span class="o">.</span><span class="n">EUDLoopBreakIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">sb</span><span class="o">.</span><span class="n">_IsSwitchBlockId</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">sb</span><span class="o">.</span><span class="n">EUDSwitchBreakIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s">&#39;No loop/switch block surrounding this code area&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EUDBreakIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EUDGetBlockList</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">lb</span><span class="o">.</span><span class="n">_IsLoopBlockId</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">lb</span><span class="o">.</span><span class="n">EUDLoopBreakIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">sb</span><span class="o">.</span><span class="n">_IsSwitchBlockId</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">sb</span><span class="o">.</span><span class="n">EUDSwitchBreakIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s">&#39;No loop/switch block surrounding this code area&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\ctrlstru\loopblock.py : 116 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">.basicstru</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EUDJump</span><span class="p">,</span>
    <span class="n">EUDJumpIf</span><span class="p">,</span>
    <span class="n">EUDJumpIfNot</span>
<span class="p">)</span>

<span class="n">_loopb_idset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s">&#39;infloopblock&#39;</span><span class="p">,</span> <span class="s">&#39;whileblock&#39;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">_IsLoopBlockId</span><span class="p">(</span><span class="n">idf</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">idf</span> <span class="ow">in</span> <span class="n">_loopb_idset</span>


<span class="k">def</span> <span class="nf">EUDInfLoop</span><span class="p">():</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;loopstart&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">(),</span>
        <span class="s">&#39;loopend&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">(),</span>
        <span class="s">&#39;contpoint&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;contpoint&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;loopstart&#39;</span><span class="p">]</span>

    <span class="n">c</span><span class="o">.</span><span class="n">EUDCreateBlock</span><span class="p">(</span><span class="s">&#39;infloopblock&#39;</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">EUDEndInfLoop</span><span class="p">():</span>
    <span class="n">lb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDPopBlock</span><span class="p">(</span><span class="s">&#39;infloopblock&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">lb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;infloopblock&#39;</span><span class="p">,</span> <span class="s">&#39;Block start/end mismatch&#39;</span>
    <span class="n">EUDJump</span><span class="p">(</span><span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;loopstart&#39;</span><span class="p">])</span>
    <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;loopend&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>


<span class="c"># -------</span>

<span class="k">def</span> <span class="nf">EUDWhile</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;loopstart&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">(),</span>
        <span class="s">&#39;loopend&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">(),</span>
        <span class="s">&#39;contpoint&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;contpoint&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;loopstart&#39;</span><span class="p">]</span>

    <span class="n">c</span><span class="o">.</span><span class="n">EUDCreateBlock</span><span class="p">(</span><span class="s">&#39;whileblock&#39;</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>

    <span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;loopend&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">EUDWhileNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;loopstart&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">(),</span>
        <span class="s">&#39;loopend&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">(),</span>
        <span class="s">&#39;contpoint&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;contpoint&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;loopstart&#39;</span><span class="p">]</span>

    <span class="n">c</span><span class="o">.</span><span class="n">EUDCreateBlock</span><span class="p">(</span><span class="s">&#39;whileblock&#39;</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>

    <span class="n">EUDJumpIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;loopend&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">EUDEndWhile</span><span class="p">():</span>
    <span class="n">lb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDPopBlock</span><span class="p">(</span><span class="s">&#39;whileblock&#39;</span><span class="p">)</span>
    <span class="n">EUDJump</span><span class="p">(</span><span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;loopstart&#39;</span><span class="p">])</span>
    <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;loopend&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>


<span class="c"># -------</span>

<span class="k">def</span> <span class="nf">_GetLastLoopBlock</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EUDGetBlockList</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">_loopb_idset</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">block</span>

    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s">&#39;No loop block surrounding this code area&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EUDLoopContinue</span><span class="p">():</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">_GetLastLoopBlock</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">EUDJump</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s">&#39;contpoint&#39;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">EUDLoopContinueIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">_GetLastLoopBlock</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">EUDJumpIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;contpoint&#39;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">EUDLoopContinueIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">_GetLastLoopBlock</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;contpoint&#39;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">EUDLoopSetContinuePoint</span><span class="p">():</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">_GetLastLoopBlock</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;contpoint&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">EUDLoopBreak</span><span class="p">():</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">_GetLastLoopBlock</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">EUDJump</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s">&#39;loopend&#39;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">EUDLoopBreakIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">_GetLastLoopBlock</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">EUDJumpIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;loopend&#39;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">EUDLoopBreakIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">_GetLastLoopBlock</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;loopend&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\ctrlstru\simpleblock.py : 121 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">.basicstru</span> <span class="kn">import</span> <span class="n">EUDJump</span><span class="p">,</span> <span class="n">EUDJumpIf</span><span class="p">,</span> <span class="n">EUDJumpIfNot</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">There are code duplication between EUDIf - EUDIfNot, EUDElseIf - EUDElseIfNot.</span>
<span class="sd">TODO : Remove code duplication if possible.</span>
<span class="sd">&#39;&#39;&#39;</span>


<span class="k">def</span> <span class="nf">EUDIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;ifend&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">(),</span>
        <span class="s">&#39;next_elseif&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="n">c</span><span class="o">.</span><span class="n">EUDCreateBlock</span><span class="p">(</span><span class="s">&#39;ifblock&#39;</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>

    <span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">EUDIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;ifend&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">(),</span>
        <span class="s">&#39;next_elseif&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="n">c</span><span class="o">.</span><span class="n">EUDCreateBlock</span><span class="p">(</span><span class="s">&#39;ifblock&#39;</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>

    <span class="n">EUDJumpIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="bp">True</span>


<span class="c"># -------</span>

<span class="k">def</span> <span class="nf">EUDElseIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="n">lb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDGetLastBlock</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">lb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;ifblock&#39;</span><span class="p">,</span> <span class="s">&#39;Block start/end mismatch&#39;</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="p">(</span>
        <span class="s">&#39;Cannot have EUDElseIf after EUDElse&#39;</span><span class="p">)</span>

    <span class="c"># Finish previous if/elseif block</span>
    <span class="n">EUDJump</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s">&#39;ifend&#39;</span><span class="p">])</span>

    <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">EUDElseIfNot</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
    <span class="n">lb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDGetLastBlock</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">lb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;ifblock&#39;</span><span class="p">,</span> <span class="s">&#39;Block start/end mismatch&#39;</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="p">(</span>
        <span class="s">&#39;Cannot have EUDElseIfNot after EUDElse&#39;</span><span class="p">)</span>

    <span class="c"># Finish previous if/elseif block</span>
    <span class="n">EUDJump</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s">&#39;ifend&#39;</span><span class="p">])</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="n">EUDJumpIf</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="bp">True</span>


<span class="c"># -------</span>

<span class="k">def</span> <span class="nf">EUDElse</span><span class="p">():</span>
    <span class="n">lb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDGetLastBlock</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">lb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;ifblock&#39;</span><span class="p">,</span> <span class="s">&#39;Block start/end mismatch&#39;</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="p">(</span>
        <span class="s">&#39;Cannot have EUDElse after EUDElse&#39;</span><span class="p">)</span>

    <span class="c"># Finish previous if/elseif block</span>
    <span class="n">EUDJump</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s">&#39;ifend&#39;</span><span class="p">])</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">EUDEndIf</span><span class="p">():</span>
    <span class="n">lb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDPopBlock</span><span class="p">(</span><span class="s">&#39;ifblock&#39;</span><span class="p">)</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c"># Finalize</span>
    <span class="n">nei_fw</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;next_elseif&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">nei_fw</span><span class="p">:</span>
        <span class="n">nei_fw</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>

    <span class="n">block</span><span class="p">[</span><span class="s">&#39;ifend&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>


<span class="c"># -------</span>

<span class="k">def</span> <span class="nf">EUDExecuteOnce</span><span class="p">():</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;blockend&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="n">c</span><span class="o">.</span><span class="n">EUDCreateBlock</span><span class="p">(</span><span class="s">&#39;executeonceblock&#39;</span><span class="p">)</span>

    <span class="n">tv</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Db</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">EUDJumpIf</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span><span class="n">tv</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Exactly</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;blockend&#39;</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">tv</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">EUDEndExecuteOnce</span><span class="p">():</span>
    <span class="n">lb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDPopBlock</span><span class="p">(</span><span class="s">&#39;executeonceblock&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">lb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;executeonceblock&#39;</span><span class="p">,</span> <span class="s">&#39;Block start/end mismatch&#39;</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">block</span><span class="p">[</span><span class="s">&#39;blockend&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\ctrlstru\swblock.py : 90 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">.basicstru</span> <span class="kn">import</span> <span class="n">EUDJump</span><span class="p">,</span> <span class="n">EUDBranch</span>


<span class="k">def</span> <span class="nf">_IsSwitchBlockId</span><span class="p">(</span><span class="n">idf</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">idf</span> <span class="o">==</span> <span class="s">&#39;swblock&#39;</span>


<span class="k">def</span> <span class="nf">EUDSwitch</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;targetvar&#39;</span><span class="p">:</span> <span class="n">var</span><span class="p">,</span>
        <span class="s">&#39;casebrlist&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s">&#39;defaultbr&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">(),</span>
        <span class="s">&#39;swend&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="n">c</span><span class="o">.</span><span class="n">PushTriggerScope</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">EUDCreateBlock</span><span class="p">(</span><span class="s">&#39;swblock&#39;</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">EUDSwitchCase</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SCMemAddr</span><span class="p">),</span> <span class="p">(</span>
        <span class="s">&#39;Invalid selector for EUDSwitch&#39;</span><span class="p">)</span>

    <span class="n">lb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDGetLastBlock</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">lb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;swblock&#39;</span><span class="p">,</span> <span class="s">&#39;Block start/end mismatch&#39;</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">number</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;casebrlist&#39;</span><span class="p">],</span> <span class="s">&#39;Duplicate cases&#39;</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;casebrlist&#39;</span><span class="p">][</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">EUDSwitchDefault</span><span class="p">():</span>
    <span class="n">lb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDGetLastBlock</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">lb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;swblock&#39;</span><span class="p">,</span> <span class="s">&#39;Block start/end mismatch&#39;</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">assert</span> <span class="ow">not</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;defaultbr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">IsSet</span><span class="p">(),</span> <span class="s">&#39;Duplicate default&#39;</span>
    <span class="n">block</span><span class="p">[</span><span class="s">&#39;defaultbr&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">EUDSwitchBreak</span><span class="p">():</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDGetLastBlockOfName</span><span class="p">(</span><span class="s">&#39;swblock&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">EUDJump</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s">&#39;swend&#39;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">EUDEndSwitch</span><span class="p">():</span>
    <span class="n">lb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EUDPopBlock</span><span class="p">(</span><span class="s">&#39;swblock&#39;</span><span class="p">)</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">swend</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;swend&#39;</span><span class="p">]</span>
    <span class="n">EUDJump</span><span class="p">(</span><span class="n">swend</span><span class="p">)</span>  <span class="c"># Exit switch block</span>
    <span class="n">c</span><span class="o">.</span><span class="n">PopTriggerScope</span><span class="p">()</span>

    <span class="c"># If default block is not specified, skip it</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;defaultbr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">IsSet</span><span class="p">():</span>
        <span class="n">block</span><span class="p">[</span><span class="s">&#39;defaultbr&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">swend</span>

    <span class="c"># Create key selector</span>
    <span class="n">casebrlist</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;casebrlist&#39;</span><span class="p">]</span>
    <span class="n">defbranch</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;defaultbr&#39;</span><span class="p">]</span>
    <span class="n">casekeylist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s">&#39;casebrlist&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s">&#39;targetvar&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">KeySelector</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
        <span class="c"># Uses simple binary search</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c"># Only one keys on the list</span>
            <span class="n">EUDBranch</span><span class="p">(</span><span class="n">var</span> <span class="o">==</span> <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">casebrlist</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">defbranch</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">br1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
            <span class="n">br2</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
            <span class="n">midpos</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">midval</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">midpos</span><span class="p">]</span>

            <span class="n">EUDBranch</span><span class="p">(</span><span class="n">var</span> <span class="o">&lt;=</span> <span class="n">midval</span><span class="p">,</span> <span class="n">br1</span><span class="p">,</span> <span class="n">br2</span><span class="p">)</span>
            <span class="n">br1</span> <span class="o">=</span> <span class="n">KeySelector</span><span class="p">(</span><span class="n">keys</span><span class="p">[:</span><span class="n">midpos</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">br2</span> <span class="o">=</span> <span class="n">KeySelector</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="n">midpos</span><span class="o">+</span><span class="mi">1</span><span class="p">:])</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c"># len(keys) == 0</span>
            <span class="n">EUDJump</span><span class="p">(</span><span class="n">defbranch</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="n">KeySelector</span><span class="p">(</span><span class="n">casekeylist</span><span class="p">)</span>

    <span class="n">swend</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\ctrlstru\__init__.py : 56 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.basicstru</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DoActions</span><span class="p">,</span>
    <span class="n">EUDJump</span><span class="p">,</span>
    <span class="n">EUDBranch</span><span class="p">,</span>
    <span class="n">EUDJumpIf</span><span class="p">,</span>
    <span class="n">EUDJumpIfNot</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.simpleblock</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EUDIf</span><span class="p">,</span>
    <span class="n">EUDIfNot</span><span class="p">,</span>
    <span class="n">EUDElseIf</span><span class="p">,</span>
    <span class="n">EUDElseIfNot</span><span class="p">,</span>
    <span class="n">EUDElse</span><span class="p">,</span>
    <span class="n">EUDEndIf</span><span class="p">,</span>

    <span class="n">EUDExecuteOnce</span><span class="p">,</span>
    <span class="n">EUDEndExecuteOnce</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.loopblock</span> <span class="kn">import</span><span class="p">(</span>
    <span class="n">EUDInfLoop</span><span class="p">,</span>
    <span class="n">EUDEndInfLoop</span><span class="p">,</span>

    <span class="n">EUDWhile</span><span class="p">,</span>
    <span class="n">EUDWhileNot</span><span class="p">,</span>
    <span class="n">EUDEndWhile</span><span class="p">,</span>

    <span class="n">EUDLoopContinue</span><span class="p">,</span>
    <span class="n">EUDLoopContinueIf</span><span class="p">,</span>
    <span class="n">EUDLoopContinueIfNot</span><span class="p">,</span>
    <span class="n">EUDLoopSetContinuePoint</span><span class="p">,</span>
    <span class="n">EUDLoopBreak</span><span class="p">,</span>
    <span class="n">EUDLoopBreakIf</span><span class="p">,</span>
    <span class="n">EUDLoopBreakIfNot</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.swblock</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EUDSwitch</span><span class="p">,</span>
    <span class="n">EUDSwitchCase</span><span class="p">,</span>
    <span class="n">EUDSwitchDefault</span><span class="p">,</span>
    <span class="n">EUDSwitchBreak</span><span class="p">,</span>
    <span class="n">EUDEndSwitch</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.breakcont</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EUDContinue</span><span class="p">,</span>
    <span class="n">EUDContinueIf</span><span class="p">,</span>
    <span class="n">EUDContinueIfNot</span><span class="p">,</span>
    <span class="n">EUDSetContinuePoint</span><span class="p">,</span>

    <span class="n">EUDBreak</span><span class="p">,</span>
    <span class="n">EUDBreakIf</span><span class="p">,</span>
    <span class="n">EUDBreakIfNot</span>
<span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\maprw\loadmap.py : 12 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..core.mapdata</span> <span class="kn">import</span> <span class="n">chktok</span><span class="p">,</span> <span class="n">mpqapi</span><span class="p">,</span> <span class="n">mapdata</span>


<span class="k">def</span> <span class="nf">LoadMap</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Loading map </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>
    <span class="n">rawfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">mpqr</span> <span class="o">=</span> <span class="n">mpqapi</span><span class="o">.</span><span class="n">MpqRead</span><span class="p">()</span>
    <span class="n">mpqr</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">chkt</span> <span class="o">=</span> <span class="n">chktok</span><span class="o">.</span><span class="n">CHK</span><span class="p">()</span>
    <span class="n">chkt</span><span class="o">.</span><span class="n">loadchk</span><span class="p">(</span><span class="n">mpqr</span><span class="o">.</span><span class="n">Extract</span><span class="p">(</span><span class="s">&#39;staredit</span><span class="se">\\</span><span class="s">scenario.chk&#39;</span><span class="p">))</span>
    <span class="n">mapdata</span><span class="o">.</span><span class="n">InitMapData</span><span class="p">(</span><span class="n">chkt</span><span class="p">,</span> <span class="n">rawfile</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\maprw\savemap.py : 48 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">varfunc</span> <span class="k">as</span> <span class="n">vf</span>
<span class="kn">from</span> <span class="nn">..core.mapdata</span> <span class="kn">import</span> <span class="n">mapdata</span><span class="p">,</span> <span class="n">mpqapi</span>
<span class="kn">from</span> <span class="nn">.injector</span> <span class="kn">import</span> <span class="n">stage1</span><span class="p">,</span> <span class="n">stage2</span><span class="p">,</span> <span class="n">stage3</span><span class="p">,</span> <span class="n">doevents</span>


<span class="k">def</span> <span class="nf">SaveMap</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">rootf</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Saving to </span><span class="si">%s</span><span class="s">...&#39;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>
    <span class="n">mapdata</span><span class="o">.</span><span class="n">UpdateMapData</span><span class="p">()</span>
    <span class="n">chkt</span> <span class="o">=</span> <span class="n">mapdata</span><span class="o">.</span><span class="n">GetChkTokenized</span><span class="p">()</span>

    <span class="c"># Create injector triggers</span>
    <span class="n">bsm</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">BlockStruManager</span><span class="p">()</span>
    <span class="n">prev_bsm</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">SetCurrentBlockStruManager</span><span class="p">(</span><span class="n">bsm</span><span class="p">)</span>
    <span class="n">old_evb</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">SetCurrentVariableBuffer</span><span class="p">(</span><span class="n">vf</span><span class="o">.</span><span class="n">EUDVarBuffer</span><span class="p">())</span>

    <span class="n">c</span><span class="o">.</span><span class="n">PushTriggerScope</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39; = = = = = = calling _mainstarter&#39;</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">doevents</span><span class="o">.</span><span class="n">_MainStarter</span><span class="p">(</span><span class="n">rootf</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39; = = = = = = calling createstage3&#39;</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">stage3</span><span class="o">.</span><span class="n">CreateStage3</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">PopTriggerScope</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39; = = = = = = calling createpayload[1]&#39;</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">CreatePayload</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

    <span class="n">vf</span><span class="o">.</span><span class="n">SetCurrentVariableBuffer</span><span class="p">(</span><span class="n">vf</span><span class="o">.</span><span class="n">EUDVarBuffer</span><span class="p">())</span>

    <span class="n">c</span><span class="o">.</span><span class="n">PushTriggerScope</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39; = = = = = = calling createstage2&#39;</span><span class="p">)</span>
    <span class="n">final_payload</span> <span class="o">=</span> <span class="n">stage2</span><span class="o">.</span><span class="n">CreateStage2</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">PopTriggerScope</span><span class="p">()</span>
    <span class="n">vf</span><span class="o">.</span><span class="n">SetCurrentVariableBuffer</span><span class="p">(</span><span class="n">old_evb</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">SetCurrentBlockStruManager</span><span class="p">(</span><span class="n">prev_bsm</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">&#39; = = = = = = calling createandapplystage1&#39;</span><span class="p">)</span>
    <span class="n">stage1</span><span class="o">.</span><span class="n">CreateAndApplyStage1</span><span class="p">(</span><span class="n">chkt</span><span class="p">,</span> <span class="n">final_payload</span><span class="p">)</span>

    <span class="n">rawchk</span> <span class="o">=</span> <span class="n">chkt</span><span class="o">.</span><span class="n">savechk</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Output scenario.chk : </span><span class="si">%.3f</span><span class="s">MB&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rawchk</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000000</span><span class="p">))</span>

    <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mapdata</span><span class="o">.</span><span class="n">GetRawFile</span><span class="p">())</span>

    <span class="n">mw</span> <span class="o">=</span> <span class="n">mpqapi</span><span class="o">.</span><span class="n">MpqWrite</span><span class="p">()</span>
    <span class="n">mw</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">mw</span><span class="o">.</span><span class="n">PutFile</span><span class="p">(</span><span class="s">&#39;staredit</span><span class="se">\\</span><span class="s">scenario.chk&#39;</span><span class="p">,</span> <span class="n">rawchk</span><span class="p">)</span>
    <span class="n">mw</span><span class="o">.</span><span class="n">Compact</span><span class="p">()</span>
    <span class="n">mw</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\maprw\__init__.py : 3 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.loadmap</span> <span class="kn">import</span> <span class="n">LoadMap</span>
<span class="kn">from</span> <span class="nn">.savemap</span> <span class="kn">import</span> <span class="n">SaveMap</span>
<span class="kn">from</span> <span class="nn">.injector.doevents</span> <span class="kn">import</span> <span class="n">DoEvents</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\maprw\injector\doevents.py : 33 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">ctrlstru</span> <span class="k">as</span> <span class="n">cs</span>

<span class="n">jumper</span> <span class="o">=</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">_MainStarter</span><span class="p">(</span><span class="n">mf</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">jumper</span>

    <span class="n">c</span><span class="o">.</span><span class="n">PushTriggerScope</span><span class="p">()</span>

    <span class="n">jumper</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="n">rootstarter</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
    <span class="n">mf</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
        <span class="n">nextptr</span><span class="o">=</span><span class="mh">0x80000000</span><span class="p">,</span>
        <span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetNextPtr</span><span class="p">(</span><span class="n">jumper</span><span class="p">,</span> <span class="mh">0x80000000</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c"># Jumper</span>
    <span class="n">jumper</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">nextptr</span><span class="o">=</span><span class="n">rootstarter</span><span class="p">)</span>

    <span class="n">c</span><span class="o">.</span><span class="n">PopTriggerScope</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">rootstarter</span>


<span class="k">def</span> <span class="nf">DoEvents</span><span class="p">():</span>
    <span class="n">_t</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">SetNextPtr</span><span class="p">(</span><span class="n">jumper</span><span class="p">,</span> <span class="n">_t</span><span class="p">))</span>
    <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="mh">0x80000000</span><span class="p">)</span>
    <span class="n">_t</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\maprw\injector\stage1.py : 279 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278</pre></div></td><td class="code"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39; Stage 1 : works in TRIG section.</span>
<span class="sd">- Check if EUD is available. If not, defeat</span>
<span class="sd">- Initialize stage 2 &amp; execute it</span>
<span class="sd">- Modifies TRIG trigger&#39;s nextptr. Modification is fixed in stage 3.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">trigtrg</span> <span class="k">as</span> <span class="n">tt</span>


<span class="n">trglist</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">def</span> <span class="nf">Trigger</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">trglist</span>
    <span class="n">trglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">CopyDeaths</span><span class="p">(</span><span class="n">iplayer</span><span class="p">,</span> <span class="n">oplayer</span><span class="p">,</span> <span class="n">copyepd</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">initvalue</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">tmpplayer</span> <span class="o">=</span> <span class="mi">11</span>

    <span class="k">if</span> <span class="n">initvalue</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">copyepd</span><span class="p">:</span>
            <span class="n">initvalue</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initvalue</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">Trigger</span><span class="p">(</span>
        <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
            <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">oplayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">initvalue</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">tmpplayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">copyepd</span><span class="p">:</span>
            <span class="n">subval</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">subval</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">i</span>

        <span class="n">Trigger</span><span class="p">(</span>
            <span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="n">tt</span><span class="o">.</span><span class="n">Deaths</span><span class="p">(</span><span class="n">iplayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">iplayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">tmpplayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">oplayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">subval</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">Trigger</span><span class="p">(</span>
            <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">tt</span><span class="o">.</span><span class="n">AllPlayers</span><span class="p">],</span>
            <span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="n">tt</span><span class="o">.</span><span class="n">Deaths</span><span class="p">(</span><span class="n">tmpplayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">iplayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">tmpplayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>


<span class="k">def</span> <span class="nf">CreateAndApplyStage1</span><span class="p">(</span><span class="n">chkt</span><span class="p">,</span> <span class="n">payload_stage2</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">trglist</span>

    <span class="c"># Append &#39;Require EUD enabler&#39; string.</span>
    <span class="n">str_section</span> <span class="o">=</span> <span class="n">chkt</span><span class="o">.</span><span class="n">getsection</span><span class="p">(</span><span class="s">&#39;STR&#39;</span><span class="p">)</span>
    <span class="n">strtb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">TBL</span><span class="p">(</span><span class="n">str_section</span><span class="p">)</span>
    <span class="n">eude_needed</span> <span class="o">=</span> <span class="n">strtb</span><span class="o">.</span><span class="n">GetStringIndex</span><span class="p">(</span><span class="s">&#39;This map requires EUD Enabler to run&#39;</span><span class="p">)</span>
    <span class="n">str_section</span> <span class="o">=</span> <span class="n">strtb</span><span class="o">.</span><span class="n">SaveTBL</span><span class="p">()</span>

    <span class="n">payload_offset</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str_section</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">3</span>
    <span class="n">padding_length</span> <span class="o">=</span> <span class="n">payload_offset</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_section</span><span class="p">)</span>
    <span class="n">str_section</span> <span class="o">=</span> <span class="n">str_section</span> <span class="o">+</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">padding_length</span><span class="p">)</span> <span class="o">+</span> <span class="n">payload_stage2</span><span class="o">.</span><span class="n">data</span>
    <span class="n">chkt</span><span class="o">.</span><span class="n">setsection</span><span class="p">(</span><span class="s">&#39;STR&#39;</span><span class="p">,</span> <span class="n">str_section</span><span class="p">)</span>

    <span class="c"># MAIN STAGE</span>
    <span class="n">trglist</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="c"># Check if epd is supported</span>

    <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="p">[</span>
        <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="n">Trigger</span><span class="p">(</span>
        <span class="n">conditions</span><span class="o">=</span><span class="p">[</span>
            <span class="n">tt</span><span class="o">.</span><span class="n">Deaths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Exactly</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
            <span class="n">tt</span><span class="o">.</span><span class="n">DisplayTextMessage</span><span class="p">(</span><span class="n">eude_needed</span><span class="p">),</span>
            <span class="n">tt</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="p">[</span>
        <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="c"># -------</span>

    <span class="c"># Payload update</span>
    <span class="n">curpl</span> <span class="o">=</span> <span class="mh">0x6509B0</span>
    <span class="n">strs</span> <span class="o">=</span> <span class="mh">0x5993D4</span>
    <span class="n">pts</span> <span class="o">=</span> <span class="mh">0x51A280</span>

    <span class="n">CopyDeaths</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">strs</span><span class="p">),</span> <span class="n">tt</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">curpl</span><span class="p">),</span> <span class="bp">True</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">payload_offset</span><span class="p">))</span>

    <span class="c"># DEBUG</span>
    <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x1001</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="c"># DEBUG</span>

    <span class="c"># Init prt</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload_stage2</span><span class="o">.</span><span class="n">prttable</span><span class="p">),</span> <span class="mi">31</span><span class="p">):</span>
        <span class="n">prttb</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">//</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">payload_stage2</span><span class="o">.</span><span class="n">prttable</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">31</span><span class="p">]]</span>
        <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">curpl</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">prttb</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="c"># Add by payload_offset // 4</span>
        <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="p">[</span>
            <span class="p">(</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">CurrentPlayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">payload_offset</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">curpl</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span>
                             <span class="n">prttb</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">prttb</span><span class="p">)]</span> <span class="o">-</span> <span class="n">prttb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prttb</span><span class="p">))</span>
        <span class="p">])</span>

        <span class="c"># Add by value(strs) // 4</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">Trigger</span><span class="p">(</span>
                <span class="n">conditions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span><span class="n">strs</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">),</span>
                <span class="n">actions</span><span class="o">=</span><span class="p">[(</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">CurrentPlayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">curpl</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span>
                                 <span class="n">prttb</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">prttb</span><span class="p">)]</span> <span class="o">-</span> <span class="n">prttb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prttb</span><span class="p">))]</span> <span class="o">+</span>
                <span class="p">[</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">strs</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="c"># Revert value(strs)</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">Trigger</span><span class="p">(</span>
                <span class="n">conditions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Deaths</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">strs</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">curpl</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="o">-</span><span class="n">prttb</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c"># -------</span>

    <span class="c"># Init orttable</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload_stage2</span><span class="o">.</span><span class="n">orttable</span><span class="p">),</span> <span class="mi">31</span><span class="p">):</span>
        <span class="n">orttb</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">//</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">payload_stage2</span><span class="o">.</span><span class="n">orttable</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">31</span><span class="p">]]</span>
        <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">curpl</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">orttb</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="c"># Add by payload_offset // 4</span>
        <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="p">[</span>
            <span class="p">(</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">CurrentPlayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">payload_offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">curpl</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span>
                             <span class="n">orttb</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">orttb</span><span class="p">)]</span> <span class="o">-</span> <span class="n">orttb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orttb</span><span class="p">))</span>
        <span class="p">])</span>

        <span class="c"># Add by value(strs) // 4</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">Trigger</span><span class="p">(</span>
                <span class="n">conditions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span><span class="n">strs</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">),</span>
                <span class="n">actions</span><span class="o">=</span><span class="p">[(</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">CurrentPlayer</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">curpl</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span>
                                 <span class="n">orttb</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">orttb</span><span class="p">)]</span> <span class="o">-</span> <span class="n">orttb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orttb</span><span class="p">))]</span> <span class="o">+</span>
                <span class="p">[</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">strs</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="c"># Revert value(strs)</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">Trigger</span><span class="p">(</span>
                <span class="n">conditions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Deaths</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">strs</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">curpl</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="o">-</span><span class="n">orttb</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c"># -------</span>

    <span class="c"># Jump to payload</span>

    <span class="c"># DEBUG</span>
    <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x1002</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="c"># DEBUG</span>

    <span class="c"># Reset curpl</span>
    <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="p">[</span>
        <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">curpl</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span>
    <span class="p">])</span>

    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">ptsprev</span> <span class="o">=</span> <span class="n">pts</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">player</span> <span class="o">+</span> <span class="mi">4</span>
        <span class="n">triggerend</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="mh">0x51A284</span> <span class="o">+</span> <span class="n">player</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>

        <span class="n">Trigger</span><span class="p">(</span>
            <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">player</span><span class="p">],</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">triggerend</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c"># Used in stage 2</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="c"># curpl += value(ptsprev) // 4</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">Trigger</span><span class="p">(</span>
                <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">player</span><span class="p">],</span>
                <span class="n">conditions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span><span class="n">ptsprev</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">),</span>
                <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">ptsprev</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">),</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>  <span class="c"># Used for nextptr</span>
                    <span class="c"># recovery in stage 2</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>  <span class="c"># Temporary</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">curpl</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">Trigger</span><span class="p">(</span>
                <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">player</span><span class="p">],</span>
                <span class="n">conditions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Deaths</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">ptsprev</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">e</span><span class="p">),</span>
                <span class="p">]</span>
            <span class="p">)</span>

    <span class="c"># now curpl = EPD(value(ptsprev) + 4)</span>
    <span class="c"># value(EPD(value(ptsprev) + 4)) = strs + payload_offset</span>
    <span class="n">CopyDeaths</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">strs</span><span class="p">),</span> <span class="n">tt</span><span class="o">.</span><span class="n">CurrentPlayer</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="n">payload_offset</span><span class="p">)</span>

    <span class="c"># DEBUG</span>
    <span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x1003</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="c"># DEBUG</span>

    <span class="n">trigdata</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">trglist</span><span class="p">)</span>

    <span class="c"># Stage 1 created</span>

    <span class="c"># -------</span>

    <span class="c"># Previous trigger datas</span>

    <span class="n">oldtrigraw</span> <span class="o">=</span> <span class="n">chkt</span><span class="o">.</span><span class="n">getsection</span><span class="p">(</span><span class="s">&#39;TRIG&#39;</span><span class="p">)</span>
    <span class="n">oldtrigs</span> <span class="o">=</span> \
        <span class="p">[</span><span class="n">oldtrigraw</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2400</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">oldtrigraw</span><span class="p">),</span> <span class="mi">2400</span><span class="p">)]</span>
    <span class="n">proc_trigs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c"># Collect only enabled triggers</span>
    <span class="k">for</span> <span class="n">trig</span> <span class="ow">in</span> <span class="n">oldtrigs</span><span class="p">:</span>
        <span class="n">trig</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">trig</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">b2i4</span><span class="p">(</span><span class="n">trig</span><span class="p">,</span> <span class="mi">320</span> <span class="o">+</span> <span class="mi">2048</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">flag</span> <span class="o">&amp;</span> <span class="mi">8</span><span class="p">:</span>  <span class="c"># Trigger already disabled</span>
            <span class="k">pass</span>

        <span class="n">flag</span> <span class="o">^=</span> <span class="mi">8</span>
        <span class="n">trig</span><span class="p">[</span><span class="mi">320</span> <span class="o">+</span> <span class="mi">2048</span><span class="p">:</span> <span class="mi">320</span> <span class="o">+</span> <span class="mi">2048</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">i2b4</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="n">proc_trigs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">trig</span><span class="p">))</span>

    <span class="n">oldtrigraw_processed</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">proc_trigs</span><span class="p">)</span>
    <span class="n">chkt</span><span class="o">.</span><span class="n">setsection</span><span class="p">(</span><span class="s">&#39;TRIG&#39;</span><span class="p">,</span> <span class="n">trigdata</span> <span class="o">+</span> <span class="n">oldtrigraw_processed</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\maprw\injector\stage2.py : 94 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre></div></td><td class="code"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39; Stage 2 :</span>
<span class="sd">- Initialize payload (stage3+ + user code) &amp; execute it</span>
<span class="sd">&#39;&#39;&#39;</span>


<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">stdfunc</span> <span class="k">as</span> <span class="n">sf</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">ctrlstru</span> <span class="k">as</span> <span class="n">cs</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">varfunc</span> <span class="k">as</span> <span class="n">vf</span>


<span class="k">def</span> <span class="nf">CreateStage2</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
    <span class="c"># We first build code injector.</span>
    <span class="n">prtdb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Db</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">i2b4</span><span class="p">(</span><span class="n">x</span> <span class="o">//</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">payload</span><span class="o">.</span><span class="n">prttable</span><span class="p">]))</span>
    <span class="n">prtn</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>

    <span class="n">ortdb</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Db</span><span class="p">(</span><span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">i2b4</span><span class="p">(</span><span class="n">x</span> <span class="o">//</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">payload</span><span class="o">.</span><span class="n">orttable</span><span class="p">]))</span>
    <span class="n">ortn</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>

    <span class="n">orig_payload</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Db</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="n">c</span><span class="o">.</span><span class="n">PushTriggerScope</span><span class="p">()</span>

    <span class="n">root</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>

    <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x2000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x3000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="n">prtn</span> <span class="o">&lt;&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">prttable</span><span class="p">)</span>
    <span class="n">ortn</span> <span class="o">&lt;&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">orttable</span><span class="p">)</span>

    <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x4000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c"># prtn &lt;&lt; len(payload.prttable)</span>
    <span class="c"># ortn &lt;&lt; len(payload.orttable)</span>

    <span class="c"># init prt</span>
    <span class="k">if</span> <span class="n">cs</span><span class="o">.</span><span class="n">EUDInfLoop</span><span class="p">():</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">prtn</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;aaaaa&#39;</span><span class="p">)</span>
        <span class="n">iaddr</span> <span class="o">=</span> <span class="n">prtn</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">prtdb</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;aaaaa&#39;</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">tp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">orig_payload</span><span class="p">)</span> <span class="o">+</span> <span class="n">sf</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="n">iaddr</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">orig_payload</span> <span class="o">//</span> <span class="mi">4</span>

        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="n">act</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">act</span> <span class="o">+</span> <span class="mi">16</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">tp</span><span class="p">)])</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mh">0x400</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">act</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        sf.f_dwadd_epd(</span>
<span class="sd">            c.EPD(orig_payload) + sf.f_dwread_epd(prtn + c.EPD(prtdb)),</span>
<span class="sd">            (orig_payload // 4)</span>
<span class="sd">        )</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mh">0x500</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDLoopBreakIf</span><span class="p">(</span><span class="n">prtn</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">cs</span><span class="o">.</span><span class="n">EUDEndInfLoop</span><span class="p">()</span>

    <span class="c"># init ort</span>
    <span class="k">if</span> <span class="n">cs</span><span class="o">.</span><span class="n">EUDInfLoop</span><span class="p">():</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">ortn</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">sf</span><span class="o">.</span><span class="n">f_dwadd_epd</span><span class="p">(</span>
            <span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">orig_payload</span><span class="p">)</span> <span class="o">+</span> <span class="n">sf</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="n">ortn</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">ortdb</span><span class="p">)),</span>
            <span class="n">orig_payload</span>
        <span class="p">)</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDLoopBreakIf</span><span class="p">(</span><span class="n">ortn</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">cs</span><span class="o">.</span><span class="n">EUDEndInfLoop</span><span class="p">()</span>

    <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x1001</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c"># Jump</span>
    <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">orig_payload</span><span class="p">)</span>

    <span class="n">c</span><span class="o">.</span><span class="n">PopTriggerScope</span><span class="p">()</span>

    <span class="c">####</span>
    <span class="c"># return c.CreatePayload(root)</span>
    <span class="c">####</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">CreatePayload</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="nb">open</span><span class="p">(</span><span class="s">&#39;out.bin&#39;</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">prttable</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">orttable</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">payload</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\maprw\injector\stage3.py : 95 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94</pre></div></td><td class="code"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39; Stage 3:</span>
<span class="sd">- Fixes nextptr modification to TRIG triggers by stage 1</span>
<span class="sd">- Flip property value by trig section</span>
<span class="sd">- Create infinite executer for root</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">ctrlstru</span> <span class="k">as</span> <span class="n">cs</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">varfunc</span> <span class="k">as</span> <span class="n">vf</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">stdfunc</span> <span class="k">as</span> <span class="n">sf</span>


<span class="nd">@vf.EUDFunc</span>
<span class="k">def</span> <span class="nf">FlipProp</span><span class="p">(</span><span class="n">initptr</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Iterate through triggers and flip &#39;Trigger disabled&#39; flag&#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">cs</span><span class="o">.</span><span class="n">EUDWhileNot</span><span class="p">(</span><span class="n">initptr</span> <span class="o">&lt;=</span> <span class="mh">0x7FFFFFFF</span><span class="p">):</span>
        <span class="n">initepd</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">f_epd</span><span class="p">(</span><span class="n">initptr</span><span class="p">)</span>

        <span class="n">prop_epd</span> <span class="o">=</span> <span class="n">initepd</span> <span class="o">+</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">320</span> <span class="o">+</span> <span class="mi">2048</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
        <span class="n">propv</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="n">prop_epd</span><span class="p">)</span>
        <span class="n">sf</span><span class="o">.</span><span class="n">f_dwwrite_epd</span><span class="p">(</span><span class="n">prop_epd</span><span class="p">,</span> <span class="n">sf</span><span class="o">.</span><span class="n">f_bitxor</span><span class="p">(</span><span class="n">propv</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>  <span class="c"># Flip bit 3</span>

        <span class="n">initptr</span> <span class="o">&lt;&lt;</span> <span class="n">sf</span><span class="o">.</span><span class="n">f_epd</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="n">initepd</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span> <span class="o">//</span> <span class="mi">4</span><span class="p">)))</span>

    <span class="n">cs</span><span class="o">.</span><span class="n">EUDEndWhile</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">CreateStage3</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
    <span class="n">c</span><span class="o">.</span><span class="n">PushTriggerScope</span><span class="p">()</span>

    <span class="n">ret</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>

    <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">1234</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c"># Revert nextptr</span>
    <span class="n">triggerend</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">ptsprev_epd</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">sf</span><span class="o">.</span><span class="n">f_dwwrite_epd</span><span class="p">(</span><span class="n">ptsprev_epd</span><span class="p">,</span> <span class="n">triggerend</span><span class="p">)</span>

    <span class="c"># Flip TRIG properties</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cs</span><span class="o">.</span><span class="n">EUDWhile</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">):</span>
        <span class="n">FlipProp</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="mh">0x51A288</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">cs</span><span class="o">.</span><span class="n">EUDEndWhile</span><span class="p">()</span>

    <span class="c"># Create payload for each players &amp; Link them with pts</span>
    <span class="n">lasttime</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>
    <span class="n">curtime</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>
    <span class="n">prevtstart</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>
    <span class="n">pts</span> <span class="o">=</span> <span class="mh">0x0051A280</span>

    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">c</span><span class="o">.</span><span class="n">PushTriggerScope</span><span class="p">()</span>

        <span class="c"># Crash preventer</span>
        <span class="n">tstart</span><span class="p">,</span> <span class="n">_t0</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
        <span class="n">tstart</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
            <span class="n">nextptr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">SetNextPtr</span><span class="p">(</span><span class="n">tstart</span><span class="p">,</span> <span class="n">_t0</span><span class="p">)]</span>
        <span class="p">)</span>

        <span class="n">_t0</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">c</span><span class="o">.</span><span class="n">SetNextPtr</span><span class="p">(</span><span class="n">tstart</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="c"># Time checker -&gt; ensure that STR trigger is executed only once.</span>
        <span class="n">curtime</span> <span class="o">&lt;&lt;</span> <span class="n">sf</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="mh">0x57F23C</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">cs</span><span class="o">.</span><span class="n">EUDIf</span><span class="p">(</span><span class="n">lasttime</span> <span class="o">&lt;</span> <span class="n">curtime</span><span class="p">):</span>
            <span class="n">lasttime</span> <span class="o">&lt;&lt;</span> <span class="n">curtime</span>
            <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDEndIf</span><span class="p">()</span>

        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="mh">0x80000000</span><span class="p">)</span>

        <span class="n">c</span><span class="o">.</span><span class="n">PopTriggerScope</span><span class="p">()</span>

        <span class="n">prevtstart</span> <span class="o">&lt;&lt;</span> <span class="n">sf</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">player</span> <span class="o">+</span> <span class="n">pts</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">8</span><span class="p">))</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">player</span> <span class="o">+</span> <span class="n">pts</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">8</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">tstart</span><span class="p">),</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">tstart</span> <span class="o">+</span> <span class="mi">4</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">prevtstart</span><span class="p">),</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">_t0</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">320</span> <span class="o">+</span> <span class="mi">20</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">prevtstart</span><span class="p">)</span>
        <span class="p">])</span>

    <span class="c"># pts initialized. now jump to root</span>
    <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

    <span class="n">c</span><span class="o">.</span><span class="n">PopTriggerScope</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">ret</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\maprw\injector\trigtrg.py : 170 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169</pre></div></td><td class="code"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">WARNING! This code is speciallized for use on eudtrg</span>
<span class="sd">- Default player of trigger is &#39;All Player&#39;.</span>
<span class="sd">- Only conditions/actions used in eudtrg are declared</span>
<span class="sd">- Condition/Action input filtering (&amp; 0xFFFFFFFF thing) are only applied to</span>
<span class="sd">  player &amp; number section of Deaths/SetDeaths</span>
<span class="sd">Note this when using this code outside of eudtrg.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">struct</span> <span class="kn">import</span> <span class="n">pack</span>


<span class="k">def</span> <span class="nf">i2b1</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">((</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,))</span>


<span class="k">def</span> <span class="nf">i2b2</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">((</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">i2b4</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">((</span>
        <span class="n">i</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
        <span class="p">(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
        <span class="p">(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
        <span class="p">(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
    <span class="p">))</span>


<span class="c"># for Deaths</span>
<span class="n">AtLeast</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">AtMost</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Exactly</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c"># for Set Death</span>
<span class="n">SetTo</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">Add</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">Subtract</span> <span class="o">=</span> <span class="mi">9</span>

<span class="c"># player enum</span>
<span class="n">CurrentPlayer</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">AllPlayers</span> <span class="o">=</span> <span class="mi">17</span>

<span class="c"># constructor</span>
<span class="n">_bc_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="n">i2b1</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="n">i2b2</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="n">i2b4</span><span class="p">,</span>
    <span class="bp">None</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">FlattenList</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">bytes</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">l</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">FlattenList</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c"># l is not iterable</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">l</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">Condition</span><span class="p">(</span><span class="n">locid</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">unitid</span><span class="p">,</span>
              <span class="n">comparison</span><span class="p">,</span> <span class="n">condtype</span><span class="p">,</span> <span class="n">restype</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">player</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">player</span> <span class="o">+=</span> <span class="mh">0x100000000</span>  <span class="c"># EPD</span>

    <span class="n">player</span> <span class="o">&amp;=</span> <span class="mh">0xFFFFFFFF</span>
    <span class="n">amount</span> <span class="o">&amp;=</span> <span class="mh">0xFFFFFFFF</span>

    <span class="k">return</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;IIIHBBBBBB&#39;</span><span class="p">,</span> <span class="n">locid</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">unitid</span><span class="p">,</span>
                <span class="n">comparison</span><span class="p">,</span> <span class="n">condtype</span><span class="p">,</span> <span class="n">restype</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Action</span><span class="p">(</span><span class="n">locid1</span><span class="p">,</span> <span class="n">strid</span><span class="p">,</span> <span class="n">wavid</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">player1</span><span class="p">,</span>
           <span class="n">player2</span><span class="p">,</span> <span class="n">unitid</span><span class="p">,</span> <span class="n">acttype</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">flags</span><span class="p">):</span>

    <span class="n">player1</span> <span class="o">&amp;=</span> <span class="mh">0xFFFFFFFF</span>
    <span class="n">player2</span> <span class="o">&amp;=</span> <span class="mh">0xFFFFFFFF</span>

    <span class="k">if</span> <span class="n">player1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">player1</span> <span class="o">+=</span> <span class="mh">0x100000000</span>  <span class="c"># EPD</span>
    <span class="k">if</span> <span class="n">player2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">player2</span> <span class="o">+=</span> <span class="mh">0x100000000</span>  <span class="c"># EPD</span>
    <span class="k">return</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;IIIIIIHBBBBBB&#39;</span><span class="p">,</span> <span class="n">locid1</span><span class="p">,</span> <span class="n">strid</span><span class="p">,</span> <span class="n">wavid</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">player1</span><span class="p">,</span> <span class="n">player2</span><span class="p">,</span>
                <span class="n">unitid</span><span class="p">,</span> <span class="n">acttype</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Trigger</span><span class="p">(</span><span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">AllPlayers</span><span class="p">],</span> <span class="n">conditions</span><span class="o">=</span><span class="p">[],</span> <span class="n">actions</span><span class="o">=</span><span class="p">[],</span> <span class="n">prtrig</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">conditions</span> <span class="o">=</span> <span class="n">FlattenList</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="n">FlattenList</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">players</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">16</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">64</span>

    <span class="n">peff</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">players</span><span class="p">:</span>
        <span class="n">peff</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">conditions</span> <span class="o">+</span>
        <span class="p">[</span><span class="nb">bytes</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="p">(</span><span class="mi">16</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">conditions</span><span class="p">)))]</span> <span class="o">+</span>
        <span class="n">actions</span> <span class="o">+</span>
        <span class="p">[</span><span class="nb">bytes</span><span class="p">(</span><span class="mi">32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">64</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)))]</span> <span class="o">+</span>
        <span class="p">[</span><span class="n">prtrig</span> <span class="ow">and</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\x04\0\0\0</span><span class="s">&#39;</span> <span class="ow">or</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\0\0\0\0</span><span class="s">&#39;</span><span class="p">]</span> <span class="o">+</span>
        <span class="p">[</span><span class="nb">bytes</span><span class="p">(</span><span class="n">peff</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2400</span>
    <span class="k">return</span> <span class="n">b</span>


<span class="c"># conditions</span>
<span class="k">def</span> <span class="nf">Deaths</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">comparison</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Condition</span><span class="p">(</span>
        <span class="mh">0x00000000</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span>
        <span class="n">comparison</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Memory</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">comparison</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">offset</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span>  <span class="c"># only this kind of comparison is possible</span>
    <span class="n">player</span> <span class="o">=</span> <span class="n">EPD</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>

    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">player</span> <span class="o">&lt;</span> <span class="mi">12</span> <span class="o">*</span> <span class="mi">228</span><span class="p">:</span>  <span class="c"># eud possible</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">player</span> <span class="o">//</span> <span class="mi">12</span>
        <span class="n">player</span> <span class="o">=</span> <span class="n">player</span> <span class="o">%</span> <span class="mi">12</span>
        <span class="k">return</span> <span class="n">Deaths</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">comparison</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c"># use epd</span>
        <span class="k">return</span> <span class="n">Deaths</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">comparison</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="c"># actions</span>
<span class="k">def</span> <span class="nf">SetDeaths</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">settype</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span>
        <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span>
        <span class="n">player</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="n">settype</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetMemory</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">settype</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">offset</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">player</span> <span class="o">=</span> <span class="n">EPD</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>

    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">player</span> <span class="o">&lt;</span> <span class="mi">12</span> <span class="o">*</span> <span class="mi">228</span><span class="p">:</span>  <span class="c"># eud possible</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">player</span> <span class="o">//</span> <span class="mi">12</span>
        <span class="n">player</span> <span class="o">=</span> <span class="n">player</span> <span class="o">%</span> <span class="mi">12</span>
        <span class="k">return</span> <span class="n">SetDeaths</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">settype</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c"># use epd</span>
        <span class="k">return</span> <span class="n">SetDeaths</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">settype</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">DisplayTextMessage</span><span class="p">(</span><span class="n">Text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Draw</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">EPD</span><span class="p">(</span><span class="n">offset</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">offset</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">offset</span> <span class="o">-</span> <span class="mh">0x0058A364</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\maprw\injector\__init__.py : 1 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\stdfunc\__init__.py : 3 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.memio</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\stdfunc\math\bitwise.py : 61 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">ctrlstru</span> <span class="k">as</span> <span class="n">cs</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">varfunc</span> <span class="k">as</span> <span class="n">vf</span>


<span class="k">def</span> <span class="nf">bw_gen</span><span class="p">(</span><span class="n">cond</span><span class="p">):</span>
    <span class="nd">@vf.EUDFunc</span>
    <span class="k">def</span> <span class="nf">f_bitsize_template</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDLightVariable</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>

        <span class="n">ret</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
                <span class="n">conditions</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">tmp</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
                <span class="n">conditions</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">tmp</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
                <span class="n">conditions</span><span class="o">=</span><span class="n">cond</span><span class="p">(</span><span class="n">tmp</span><span class="p">),</span>
                <span class="n">actions</span><span class="o">=</span><span class="n">ret</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">SetNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">return</span> <span class="n">f_bitsize_template</span>

<span class="n">f_bitand</span> <span class="o">=</span> <span class="n">bw_gen</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">f_bitor</span> <span class="o">=</span> <span class="n">bw_gen</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">f_bitxor</span> <span class="o">=</span> <span class="n">bw_gen</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<span class="n">f_bitnand</span> <span class="o">=</span> <span class="n">bw_gen</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">f_bitnor</span> <span class="o">=</span> <span class="n">bw_gen</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">AtMost</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>


<span class="nd">@vf.EUDFunc</span>
<span class="k">def</span> <span class="nf">f_bitnxor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f_bitnot</span><span class="p">(</span><span class="n">f_bitxor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">f_bitnot</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="mh">0xFFFFFFFF</span> <span class="o">-</span> <span class="n">a</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\stdfunc\math\muldiv.py : 181 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">ctrlstru</span> <span class="k">as</span> <span class="n">cs</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">varfunc</span> <span class="k">as</span> <span class="n">vf</span>


<span class="k">def</span> <span class="nf">f_mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_f_mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f_constmul</span><span class="p">(</span><span class="n">b</span><span class="p">)(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f_constmul</span><span class="p">(</span><span class="n">a</span><span class="p">)(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>


<span class="k">def</span> <span class="nf">f_div</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; returns (a//b, a%b) &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_f_mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f_constdiv</span><span class="p">(</span><span class="n">b</span><span class="p">)(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">//</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span>


<span class="c"># -------</span>


<span class="k">def</span> <span class="nf">f_constmul</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f_constmul</span><span class="p">,</span> <span class="s">&#39;mulfdict&#39;</span><span class="p">):</span>
        <span class="n">f_constmul</span><span class="o">.</span><span class="n">mulfdict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">mulfdict</span> <span class="o">=</span> <span class="n">f_constmul</span><span class="o">.</span><span class="n">mulfdict</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mulfdict</span><span class="p">[</span><span class="n">number</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="nd">@vf.EUDFunc</span>
        <span class="k">def</span> <span class="nf">mulf</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>
            <span class="n">ret</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
                    <span class="n">conditions</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">),</span>
                    <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                        <span class="n">a</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">),</span>
                        <span class="n">ret</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span> <span class="o">*</span> <span class="n">number</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>

        <span class="n">mulfdict</span><span class="p">[</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="n">mulf</span>
        <span class="k">return</span> <span class="n">mulf</span>


<span class="k">def</span> <span class="nf">f_constdiv</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f_constdiv</span><span class="p">,</span> <span class="s">&#39;divfdict&#39;</span><span class="p">):</span>
        <span class="n">f_constdiv</span><span class="o">.</span><span class="n">divfdict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">divfdict</span> <span class="o">=</span> <span class="n">f_constdiv</span><span class="o">.</span><span class="n">divfdict</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">divfdict</span><span class="p">[</span><span class="n">number</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="nd">@vf.EUDFunc</span>
        <span class="k">def</span> <span class="nf">divf</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>
            <span class="n">ret</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="c"># number too big</span>
                <span class="k">if</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">i</span> <span class="o">*</span> <span class="n">number</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
                    <span class="n">conditions</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span> <span class="o">*</span> <span class="n">number</span><span class="p">),</span>
                    <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                        <span class="n">a</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span> <span class="o">*</span> <span class="n">number</span><span class="p">),</span>
                        <span class="n">ret</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span><span class="p">,</span> <span class="n">a</span>

        <span class="n">divfdict</span><span class="p">[</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="n">divf</span>
        <span class="k">return</span> <span class="n">divf</span>

<span class="c"># -------</span>


<span class="nd">@vf.EUDFunc</span>
<span class="k">def</span> <span class="nf">_f_mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">ret</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDCreateVariables</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c"># Init</span>
    <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
        <span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="n">chain</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>
    <span class="n">chain_y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>

    <span class="c"># Calculate chain_y0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">((</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">chain_y0</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
            <span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
        <span class="p">))</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIf</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">AtMost</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">chain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="c"># Run multiplication chain</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">cy0</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>

        <span class="n">chain</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
            <span class="n">conditions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">a</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">a</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">),</span>
                <span class="n">cy0</span> <span class="o">&lt;&lt;</span> <span class="n">ret</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">chain_y0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">cy0</span> <span class="o">+</span> <span class="mi">20</span>

    <span class="k">return</span> <span class="n">ret</span>


<span class="nd">@vf.EUDFunc</span>
<span class="k">def</span> <span class="nf">_f_div</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">ret</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDCreateVariables</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c"># Init</span>
    <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
        <span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
    <span class="p">])</span>

    <span class="c"># Chain c.forward decl</span>
    <span class="n">chain_x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>
    <span class="n">chain_x1</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>

    <span class="c"># Fill in chain</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">chain_x0</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">chain_x1</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
        <span class="p">])</span>

        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIf</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mh">0x8000000</span><span class="p">),</span> <span class="n">chain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
        <span class="p">])</span>

    <span class="c"># Run division chain</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">cx0</span><span class="p">,</span> <span class="n">cx1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
        <span class="n">chain</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
            <span class="n">conditions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">cx0</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">cx1</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">chain_x0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">cx0</span> <span class="o">+</span> <span class="mi">8</span>
        <span class="n">chain_x1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">cx1</span> <span class="o">+</span> <span class="mi">20</span>

    <span class="k">return</span> <span class="n">ret</span><span class="p">,</span> <span class="n">a</span>  <span class="c"># a : remainder</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\stdfunc\math\__init__.py : 13 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.muldiv</span> <span class="kn">import</span> <span class="n">f_mul</span><span class="p">,</span> <span class="n">f_div</span>
<span class="kn">from</span> <span class="nn">.bitwise</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">f_bitand</span><span class="p">,</span>
    <span class="n">f_bitor</span><span class="p">,</span>
    <span class="n">f_bitxor</span><span class="p">,</span>

    <span class="n">f_bitnand</span><span class="p">,</span>
    <span class="n">f_bitnor</span><span class="p">,</span>
    <span class="n">f_bitnxor</span><span class="p">,</span>

    <span class="n">f_bitnot</span>
<span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\stdfunc\memio\byterw.py : 214 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">ctrlstru</span> <span class="k">as</span> <span class="n">cs</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">varfunc</span> <span class="k">as</span> <span class="n">vf</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">dwmemio</span> <span class="k">as</span> <span class="n">dwm</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">math</span>


<span class="n">_epd</span><span class="p">,</span> <span class="n">_suboffset</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDCreateVariables</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">EUDByteReader</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dw</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_b</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDCreateVariables</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ret</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Seek to epd address</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">seekepd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epdoffset</span><span class="p">):</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">epdoffset</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">])</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="p">,</span> <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="n">epdoffset</span><span class="p">))</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">],</span> <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwbreak</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Seek to real address</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">seekoffset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">_epd</span><span class="p">,</span> <span class="n">_suboffset</span>

        <span class="c"># convert offset to epd offset &amp; suboffset</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">([</span><span class="n">_epd</span><span class="p">,</span> <span class="n">_suboffset</span><span class="p">],</span> <span class="n">math</span><span class="o">.</span><span class="n">f_div</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([(</span><span class="n">_epd</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="o">-</span><span class="mh">0x58A364</span> <span class="o">//</span> <span class="mi">4</span><span class="p">)])</span>

        <span class="c"># seek to epd &amp; set suboffset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seekepd</span><span class="p">(</span><span class="n">_epd</span><span class="p">)</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">_suboffset</span><span class="p">)</span>
        <span class="p">])</span>

    <span class="k">def</span> <span class="nf">readbyte</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">case0</span><span class="p">,</span> <span class="n">case1</span><span class="p">,</span> <span class="n">case2</span><span class="p">,</span> <span class="n">case3</span><span class="p">,</span> <span class="n">swend</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

        <span class="c"># suboffset == 0</span>
        <span class="n">case0</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">case1</span><span class="p">)</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ret</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">swend</span><span class="p">)</span>

        <span class="c"># suboffset == 1</span>
        <span class="n">case1</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">case2</span><span class="p">)</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ret</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">swend</span><span class="p">)</span>

        <span class="c"># suboffset == 2</span>
        <span class="n">case2</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">case3</span><span class="p">)</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ret</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">swend</span><span class="p">)</span>

        <span class="c"># suboffset == 3</span>
        <span class="c"># read more dword</span>
        <span class="n">case3</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ret</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">])</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="p">,</span> <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">))</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">],</span> <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwbreak</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>

        <span class="n">swend</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ret</span>


<span class="k">class</span> <span class="nc">EUDByteWriter</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dw</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDCreateVariables</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">vf</span><span class="o">.</span><span class="n">EUDLightVariable</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">seekepd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epdoffset</span><span class="p">):</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">epdoffset</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">])</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="p">,</span> <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="n">epdoffset</span><span class="p">))</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">],</span> <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwbreak</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">seekoffset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">_epd</span><span class="p">,</span> <span class="n">_suboffset</span>

        <span class="c"># convert offset to epd offset &amp; suboffset</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">([</span><span class="n">_epd</span><span class="p">,</span> <span class="n">_suboffset</span><span class="p">],</span> <span class="n">math</span><span class="o">.</span><span class="n">f_div</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([(</span><span class="n">_epd</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="p">(</span><span class="mh">0x100000000</span> <span class="o">-</span> <span class="mh">0x58A364</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span><span class="p">)])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seekepd</span><span class="p">(</span><span class="n">_epd</span><span class="p">)</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">_suboffset</span><span class="p">)</span>
        <span class="p">])</span>

    <span class="k">def</span> <span class="nf">writebyte</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">byte</span><span class="p">):</span>
        <span class="n">case0</span><span class="p">,</span> <span class="n">case1</span><span class="p">,</span> <span class="n">case2</span><span class="p">,</span> <span class="n">case3</span><span class="p">,</span> <span class="n">swend</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

        <span class="n">case0</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">case1</span><span class="p">)</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">byte</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">swend</span><span class="p">)</span>

        <span class="n">case1</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">case2</span><span class="p">)</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">byte</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">swend</span><span class="p">)</span>

        <span class="n">case2</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">case3</span><span class="p">)</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">byte</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">swend</span><span class="p">)</span>

        <span class="n">case3</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">byte</span><span class="p">)</span>
        <span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">flushdword</span><span class="p">()</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_suboffset</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">])</span>

        <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="p">,</span> <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">))</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">],</span> <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwbreak</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>

        <span class="n">swend</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">flushdword</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># mux bytes</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="o">.</span><span class="n">SetNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
                    <span class="n">conditions</span><span class="o">=</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
                    <span class="p">],</span>
                    <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="mi">8</span><span class="p">))</span>
                    <span class="p">]</span>
                <span class="p">)</span>

        <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwwrite_epd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dw</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\stdfunc\memio\dwmemio.py : 148 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">ctrlstru</span> <span class="k">as</span> <span class="n">cs</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">varfunc</span> <span class="k">as</span> <span class="n">vf</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">math</span>


<span class="k">def</span> <span class="nf">f_epd</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">f_div</span><span class="p">(</span><span class="n">addr</span> <span class="o">+</span> <span class="p">(</span><span class="mh">0x100000000</span> <span class="o">-</span> <span class="mh">0x58A364</span><span class="p">),</span> <span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>


<span class="nd">@vf.EUDFunc</span>
<span class="k">def</span> <span class="nf">f_dwread_epd</span><span class="p">(</span><span class="n">targetplayer</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>

    <span class="c"># Common comparison trigger</span>
    <span class="n">c</span><span class="o">.</span><span class="n">PushTriggerScope</span><span class="p">()</span>
    <span class="nb">cmp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="n">cmp_player</span> <span class="o">=</span> <span class="nb">cmp</span> <span class="o">+</span> <span class="mi">4</span>
    <span class="n">cmp_number</span> <span class="o">=</span> <span class="nb">cmp</span> <span class="o">+</span> <span class="mi">8</span>
    <span class="n">cmpact</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>

    <span class="n">cmptrigger</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
    <span class="n">cmptrigger</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
        <span class="n">conditions</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">cmp</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">AtMost</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
            <span class="n">cmpact</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">cmptrigger</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">cmpact_ontrueaddr</span> <span class="o">=</span> <span class="n">cmpact</span> <span class="o">+</span> <span class="mi">20</span>
    <span class="n">c</span><span class="o">.</span><span class="n">PopTriggerScope</span><span class="p">()</span>

    <span class="c"># static_for</span>
    <span class="n">chain1</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>
    <span class="n">chain2</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>

    <span class="c"># Main logic start</span>
    <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
        <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">cmp_player</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">targetplayer</span><span class="p">),</span>
        <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">cmp_number</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0xFFFFFFFF</span><span class="p">),</span>
        <span class="p">(</span><span class="n">ret</span><span class="p">,</span>               <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0xFFFFFFFF</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="n">readend</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">nextchain</span> <span class="o">=</span> <span class="n">chain1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">readend</span>

        <span class="n">chain1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
            <span class="n">nextptr</span><span class="o">=</span><span class="n">cmptrigger</span><span class="p">,</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">cmp_number</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">),</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">),</span>
                <span class="n">c</span><span class="o">.</span><span class="n">SetNextPtr</span><span class="p">(</span><span class="n">cmptrigger</span><span class="p">,</span> <span class="n">chain2</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">cmpact_ontrueaddr</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">nextchain</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">chain2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="n">cmp_number</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">),</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="n">readend</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">ret</span>


<span class="k">def</span> <span class="nf">f_dwwrite_epd</span><span class="p">(</span><span class="n">targetplayer</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">):</span>
        <span class="n">act</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">act</span> <span class="o">+</span> <span class="mi">16</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">targetplayer</span><span class="p">),</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">act</span> <span class="o">+</span> <span class="mi">20</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">act</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">act</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">act</span> <span class="o">+</span> <span class="mi">16</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">targetplayer</span><span class="p">)])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">act</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">f_dwadd_epd</span><span class="p">(</span><span class="n">targetplayer</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">):</span>
        <span class="n">act</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">act</span> <span class="o">+</span> <span class="mi">16</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">targetplayer</span><span class="p">),</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">act</span> <span class="o">+</span> <span class="mi">20</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">act</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">act</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">act</span> <span class="o">+</span> <span class="mi">16</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">targetplayer</span><span class="p">)])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">act</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">f_dwsubtract_epd</span><span class="p">(</span><span class="n">targetplayer</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">):</span>
        <span class="n">act</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">act</span> <span class="o">+</span> <span class="mi">16</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">targetplayer</span><span class="p">),</span>
            <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">act</span> <span class="o">+</span> <span class="mi">20</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">act</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">act</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>
        <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">act</span> <span class="o">+</span> <span class="mi">16</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">targetplayer</span><span class="p">)])</span>
        <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">act</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>


<span class="nd">@vf.EUDFunc</span>
<span class="k">def</span> <span class="nf">f_dwbreak</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDCreateVariables</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">byte</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDCreateVariables</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="c"># Clear byte[], word[]</span>
    <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">([</span>
        <span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SetNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">word</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">SetNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">byte</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SetNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">byte</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">SetNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">byte</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">SetNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">byte</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">SetNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">byteidx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">8</span>
        <span class="n">wordidx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">16</span>
        <span class="n">byteexp</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">8</span>
        <span class="n">wordexp</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">16</span>

        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
            <span class="n">conditions</span><span class="o">=</span><span class="n">number</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">),</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">byte</span><span class="p">[</span><span class="n">byteidx</span><span class="p">]</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">byteexp</span><span class="p">),</span>
                <span class="n">word</span><span class="p">[</span><span class="n">wordidx</span><span class="p">]</span><span class="o">.</span><span class="n">AddNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">wordexp</span><span class="p">),</span>
                <span class="n">number</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">word</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">byte</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">byte</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">byte</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">byte</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\stdfunc\memio\mblockio.py : 55 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">ctrlstru</span> <span class="k">as</span> <span class="n">cs</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">varfunc</span> <span class="k">as</span> <span class="n">vf</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">dwmemio</span> <span class="k">as</span> <span class="n">dwm</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">byterw</span> <span class="k">as</span> <span class="n">bm</span>


<span class="nd">@vf.EUDFunc</span>
<span class="k">def</span> <span class="nf">f_repmovsd_epd</span><span class="p">(</span><span class="n">dstepdp</span><span class="p">,</span> <span class="n">srcepdp</span><span class="p">,</span> <span class="n">copydwn</span><span class="p">):</span>
    <span class="n">repmovsd_end</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>

    <span class="n">loopstart</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
    <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIf</span><span class="p">(</span><span class="n">copydwn</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">repmovsd_end</span><span class="p">)</span>

    <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwwrite_epd</span><span class="p">(</span><span class="n">dstepdp</span><span class="p">,</span> <span class="n">dwm</span><span class="o">.</span><span class="n">f_dwread_epd</span><span class="p">(</span><span class="n">srcepdp</span><span class="p">))</span>
    <span class="n">vf</span><span class="o">.</span><span class="n">SeqCompute</span><span class="p">([</span>
        <span class="p">(</span><span class="n">srcepdp</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">dstepdp</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">copydwn</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">loopstart</span><span class="p">)</span>

    <span class="n">repmovsd_end</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>


<span class="c"># -------</span>


<span class="n">_br</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">EUDByteReader</span><span class="p">()</span>
<span class="n">_bw</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">EUDByteWriter</span><span class="p">()</span>


<span class="nd">@vf.EUDFunc</span>
<span class="k">def</span> <span class="nf">f_memcpy</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">copylen</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>

    <span class="n">_br</span><span class="o">.</span><span class="n">seekoffset</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
    <span class="n">_bw</span><span class="o">.</span><span class="n">seekoffset</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>

    <span class="n">loopstart</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
    <span class="n">loopend</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>

    <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIf</span><span class="p">(</span><span class="n">copylen</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">loopend</span><span class="p">)</span>

    <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">_br</span><span class="o">.</span><span class="n">readbyte</span><span class="p">())</span>
    <span class="n">_bw</span><span class="o">.</span><span class="n">writebyte</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="n">cs</span><span class="o">.</span><span class="n">DoActions</span><span class="p">(</span><span class="n">copylen</span><span class="o">.</span><span class="n">SubtractNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">cs</span><span class="o">.</span><span class="n">EUDJump</span><span class="p">(</span><span class="n">loopstart</span><span class="p">)</span>

    <span class="n">loopend</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
    <span class="n">_bw</span><span class="o">.</span><span class="n">flushdword</span><span class="p">()</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\stdfunc\memio\smemio.py : 33 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">ctrlstru</span> <span class="k">as</span> <span class="n">cs</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">varfunc</span> <span class="k">as</span> <span class="n">vf</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">byterw</span> <span class="k">as</span> <span class="n">bm</span>


<span class="n">_br</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">EUDByteReader</span><span class="p">()</span>
<span class="n">_bw</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">EUDByteWriter</span><span class="p">()</span>


<span class="nd">@vf.EUDFunc</span>
<span class="k">def</span> <span class="nf">f_strcpy</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    strcpy equivilant in eudtrg. Copy C-style string.</span>

<span class="sd">    :param dst: Destination address. (Not EPD Player)</span>
<span class="sd">    :param src: Source address. (Not EPD Player)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">EUDVariable</span><span class="p">()</span>

    <span class="n">_br</span><span class="o">.</span><span class="n">seekoffset</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
    <span class="n">_bw</span><span class="o">.</span><span class="n">seekoffset</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>

    <span class="n">loopstart</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>

    <span class="n">vf</span><span class="o">.</span><span class="n">SetVariables</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">_br</span><span class="o">.</span><span class="n">readbyte</span><span class="p">())</span>
    <span class="n">_bw</span><span class="o">.</span><span class="n">writebyte</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="n">cs</span><span class="o">.</span><span class="n">EUDJumpIfNot</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">loopstart</span><span class="p">)</span>

    <span class="n">_bw</span><span class="o">.</span><span class="n">flushdword</span><span class="p">()</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\stdfunc\memio\__init__.py : 23 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.dwmemio</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">f_epd</span><span class="p">,</span>
    <span class="n">f_dwread_epd</span><span class="p">,</span>
    <span class="n">f_dwwrite_epd</span><span class="p">,</span>
    <span class="n">f_dwadd_epd</span><span class="p">,</span>
    <span class="n">f_dwsubtract_epd</span><span class="p">,</span>
    <span class="n">f_dwbreak</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.byterw</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EUDByteReader</span><span class="p">,</span>
    <span class="n">EUDByteWriter</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.mblockio</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">f_repmovsd_epd</span><span class="p">,</span>
    <span class="n">f_memcpy</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.smemio</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">f_strcpy</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\stdfunc\utils\__init__.py : 1 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\varfunc\eudf.py : 108 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">..core.utils.blockstru</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BlockStruManager</span><span class="p">,</span>
    <span class="n">SetCurrentBlockStruManager</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.eudv</span> <span class="kn">import</span> <span class="n">EUDVariable</span>
<span class="kn">from</span> <span class="nn">.eudsqc</span> <span class="kn">import</span> <span class="n">SeqCompute</span>

<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">inspect</span>


<span class="k">class</span> <span class="nc">EUDFunc</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fdecl_func</span><span class="p">):</span>
        <span class="c"># Get argument number of fdecl_func</span>
        <span class="n">argspec</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getargspec</span><span class="p">(</span><span class="n">fdecl_func</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">argspec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;No variadic arguments (*args) allowed for EUDFunc.&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">argspec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;No variadic keyword arguments (*kwargs) allowed for EUDFunc.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_argn</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">argspec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fdecl_func</span> <span class="o">=</span> <span class="n">fdecl_func</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">update_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fdecl_func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fstart</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">CreateFuncBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fstart</span> <span class="ow">is</span> <span class="bp">None</span>

        <span class="n">f_bsm</span> <span class="o">=</span> <span class="n">BlockStruManager</span><span class="p">()</span>
        <span class="n">prev_bsm</span> <span class="o">=</span> <span class="n">SetCurrentBlockStruManager</span><span class="p">(</span><span class="n">f_bsm</span><span class="p">)</span>

        <span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">PushTriggerScope</span><span class="p">()</span>

            <span class="n">f_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">EUDVariable</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_argn</span><span class="p">)]</span>
            <span class="n">fstart</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>
            <span class="n">f_rets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fdecl_func</span><span class="p">(</span><span class="o">*</span><span class="n">f_args</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">f_rets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">f_rets</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Assignable2List</span><span class="p">(</span><span class="n">f_rets</span><span class="p">)</span>
            <span class="n">fend</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">()</span>

            <span class="n">c</span><span class="o">.</span><span class="n">PopTriggerScope</span><span class="p">()</span>

        <span class="n">SetCurrentBlockStruManager</span><span class="p">(</span><span class="n">prev_bsm</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">f_bsm</span><span class="o">.</span><span class="n">empty</span><span class="p">(),</span> <span class="s">&#39;Block start/end mismatch inside function&#39;</span>

        <span class="c"># Assert that all return values are EUDVariable.</span>
        <span class="k">if</span> <span class="n">f_rets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># Not void function</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ret</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f_rets</span><span class="p">):</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">EUDVariable</span><span class="p">),</span> <span class="p">(</span>
                    <span class="s">&#39;#</span><span class="si">%d</span><span class="s"> of returned value is not instance of EUDVariable&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fstart</span> <span class="o">=</span> <span class="n">fstart</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fend</span> <span class="o">=</span> <span class="n">fend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fargs</span> <span class="o">=</span> <span class="n">f_args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frets</span> <span class="o">=</span> <span class="n">f_rets</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fstart</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CreateFuncBody</span><span class="p">()</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_argn</span><span class="p">,</span> <span class="s">&#39;Argument number mismatch&#39;</span>

        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="c"># Assign arguments into argument space</span>
        <span class="n">SeqCompute</span><span class="p">(</span>
            <span class="p">[(</span><span class="n">farg</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">farg</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fargs</span><span class="p">,</span> <span class="n">args</span><span class="p">)]</span>
        <span class="p">)</span>

        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="c"># Call body</span>
        <span class="n">fcallend</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>

        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
            <span class="n">nextptr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fstart</span><span class="p">,</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">SetNextPtr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fend</span><span class="p">,</span> <span class="n">fcallend</span><span class="p">)]</span>
        <span class="p">)</span>

        <span class="n">fcallend</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>

        <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">retn</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_frets</span><span class="p">)</span>
            <span class="n">tmp_rets</span> <span class="o">=</span> <span class="p">[</span><span class="n">EUDVariable</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">retn</span><span class="p">)]</span>
            <span class="n">SeqCompute</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">tr</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">tr</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tmp_rets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frets</span><span class="p">)]</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">List2Assignable</span><span class="p">(</span><span class="n">tmp_rets</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">SetVariables</span><span class="p">(</span><span class="n">srclist</span><span class="p">,</span> <span class="n">dstlist</span><span class="p">,</span> <span class="n">mdtlist</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">srclist</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">FlattenList</span><span class="p">(</span><span class="n">srclist</span><span class="p">)</span>
    <span class="n">dstlist</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">FlattenList</span><span class="p">(</span><span class="n">dstlist</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">srclist</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">dstlist</span><span class="p">),</span> <span class="s">&#39;Input/output size mismatch&#39;</span>

    <span class="k">if</span> <span class="n">mdtlist</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">mdtlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">srclist</span><span class="p">)</span>

    <span class="n">sqa</span> <span class="o">=</span> <span class="p">[(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">mdt</span><span class="p">)</span> <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">mdt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">srclist</span><span class="p">,</span> <span class="n">dstlist</span><span class="p">,</span> <span class="n">mdtlist</span><span class="p">)]</span>
    <span class="n">SeqCompute</span><span class="p">(</span><span class="n">sqa</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\varfunc\eudlv.py : 12 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">.vbase</span> <span class="kn">import</span> <span class="n">VariableBase</span>


<span class="k">class</span> <span class="nc">EUDLightVariable</span><span class="p">(</span><span class="n">VariableBase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initvalue</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_memaddr</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Db</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">i2b4</span><span class="p">(</span><span class="n">initvalue</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">GetVariableMemoryAddr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memaddr</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\varfunc\eudsqc.py : 45 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">.eudv</span> <span class="kn">import</span> <span class="n">EUDVariable</span>


<span class="k">def</span> <span class="nf">_VProc</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
    <span class="n">nexttrg</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>

    <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
        <span class="n">nextptr</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">GetVTable</span><span class="p">(),</span>
        <span class="n">actions</span><span class="o">=</span><span class="p">[</span><span class="n">actions</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">SetNextPtr</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">GetVTable</span><span class="p">(),</span> <span class="n">nexttrg</span><span class="p">)]</span>
    <span class="p">)</span>

    <span class="n">nexttrg</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>


<span class="c">#######################################</span>
<span class="c"># TODO : Optimize this function</span>
<span class="c">#######################################</span>

<span class="k">def</span> <span class="nf">SeqCompute</span><span class="p">(</span><span class="n">assignpairs</span><span class="p">):</span>  <span class="c"># Same as _Basic_SeqCompute now.</span>
    <span class="k">for</span> <span class="n">dst</span><span class="p">,</span> <span class="n">mdt</span><span class="p">,</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">assignpairs</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dstepd</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">dstepd</span> <span class="o">=</span> <span class="n">dst</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">EUDVariable</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mdt</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">:</span>
                <span class="n">_VProc</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="p">[</span>
                    <span class="n">src</span><span class="o">.</span><span class="n">QueueAssignTo</span><span class="p">(</span><span class="n">dstepd</span><span class="p">)</span>
                <span class="p">])</span>

            <span class="k">elif</span> <span class="n">mdt</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">:</span>
                <span class="n">_VProc</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="p">[</span>
                    <span class="n">src</span><span class="o">.</span><span class="n">QueueAddTo</span><span class="p">(</span><span class="n">dstepd</span><span class="p">)</span>
                <span class="p">])</span>

            <span class="k">elif</span> <span class="n">mdt</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">:</span>
                <span class="n">_VProc</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="p">[</span>
                    <span class="n">src</span><span class="o">.</span><span class="n">QueueSubtractTo</span><span class="p">(</span><span class="n">dstepd</span><span class="p">)</span>
                <span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">dstepd</span><span class="p">,</span> <span class="n">mdt</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\varfunc\eudv.py : 260 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>
<span class="kn">from</span> <span class="nn">.vbase</span> <span class="kn">import</span> <span class="n">VariableBase</span>
<span class="kn">import</span> <span class="nn">weakref</span>
<span class="kn">import</span> <span class="nn">traceback</span>


<span class="k">class</span> <span class="nc">EUDVarBuffer</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EUDObject</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Variable buffer</span>

<span class="sd">    40 bytes per variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_varn</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">CreateVarTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">+</span> <span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_varn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_varn</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">GetDataSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2408</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_varn</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">WritePayload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emitbuffer</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">2408</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_varn</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_varn</span><span class="p">):</span>
            <span class="c"># &#39;preserve trigger&#39;</span>
            <span class="n">output</span><span class="p">[</span><span class="mi">60</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2376</span><span class="p">:</span><span class="mi">60</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2380</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;</span><span class="se">\x04\0\0\0</span><span class="s">&#39;</span>

        <span class="n">emitbuffer</span><span class="o">.</span><span class="n">WriteBytes</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>


<span class="n">_evb</span> <span class="o">=</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">SetCurrentVariableBuffer</span><span class="p">(</span><span class="n">evb</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;SetCurrentVariableBuffer[</span><span class="si">%s</span><span class="s">]&#39;</span> <span class="o">%</span> <span class="n">evb</span><span class="p">)</span>
    <span class="k">global</span> <span class="n">_evb</span>

    <span class="n">oldevb</span> <span class="o">=</span> <span class="n">_evb</span>
    <span class="n">_evb</span> <span class="o">=</span> <span class="n">evb</span>
    <span class="k">return</span> <span class="n">oldevb</span>


<span class="k">class</span> <span class="nc">VariableTriggerForward</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">SCMemAddr</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakKeyDictionary</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">_evb</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="p">[</span><span class="n">_evb</span><span class="p">]</span> <span class="o">=</span> <span class="n">_evb</span><span class="o">.</span><span class="n">CreateVarTrigger</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">Evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="p">[</span><span class="n">_evb</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">EUDVariable</span><span class="p">(</span><span class="n">VariableBase</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Full variable.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vartrigger</span> <span class="o">=</span> <span class="n">VariableTriggerForward</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_varact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vartrigger</span> <span class="o">+</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">320</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">GetVTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vartrigger</span>

    <span class="k">def</span> <span class="nf">GetVariableMemoryAddr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_varact</span> <span class="o">+</span> <span class="mi">20</span>

    <span class="c"># -------</span>

    <span class="k">def</span> <span class="nf">QueueAssignTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">dest</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_varact</span> <span class="o">+</span> <span class="mi">16</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_varact</span> <span class="o">+</span> <span class="mi">24</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x072D0000</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">QueueAddTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">dest</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_varact</span> <span class="o">+</span> <span class="mi">16</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_varact</span> <span class="o">+</span> <span class="mi">24</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x082D0000</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">QueueSubtractTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">dest</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_varact</span> <span class="o">+</span> <span class="mi">16</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_varact</span> <span class="o">+</span> <span class="mi">24</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="mh">0x092D0000</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">]</span>

    <span class="c"># -------</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;ccccc&#39;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">EUDVariable</span><span class="p">()</span>
        <span class="n">_Basic_SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
            <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">other</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">EUDVariable</span><span class="p">()</span>
        <span class="n">_Basic_SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
            <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">EUDVariable</span><span class="p">()</span>
        <span class="n">_Basic_SeqCompute</span><span class="p">([</span>
            <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span>
            <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">__lshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">_Basic_SeqCompute</span><span class="p">((</span>
            <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span>
        <span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c"># -------</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AtMost</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">EUDVariable</span><span class="p">()</span>
            <span class="n">_Basic_SeqCompute</span><span class="p">((</span>
                <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">EUDVariable</span><span class="p">()</span>
            <span class="n">_Basic_SeqCompute</span><span class="p">((</span>
                <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span>
                <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;[Warning] No unsigned number can be leq than </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">other</span><span class="p">)</span>
            <span class="n">traceback</span><span class="o">.</span><span class="n">print_stack</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Never</span><span class="p">()]</span>  <span class="c"># No unsigned number is less than 0</span>

        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AtMost</span><span class="p">(</span><span class="n">other</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">EUDVariable</span><span class="p">()</span>
            <span class="n">_Basic_SeqCompute</span><span class="p">((</span>
                <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span> <span class="o">&gt;=</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;[Warning] No unsigned int can be greater than </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">other</span><span class="p">)</span>
            <span class="n">traceback</span><span class="o">.</span><span class="n">print_stack</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">Never</span><span class="p">()]</span>  <span class="c"># No unsigned number is less than 0</span>

        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">IsValidSCMemAddr</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="n">other</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">EUDVariable</span><span class="p">()</span>
            <span class="n">_Basic_SeqCompute</span><span class="p">((</span>
                <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_VProc</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
    <span class="n">nexttrg</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Forward</span><span class="p">()</span>

    <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span>
        <span class="n">nextptr</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">GetVTable</span><span class="p">(),</span>
        <span class="n">actions</span><span class="o">=</span><span class="p">[</span><span class="n">actions</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">SetNextPtr</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">GetVTable</span><span class="p">(),</span> <span class="n">nexttrg</span><span class="p">)]</span>
    <span class="p">)</span>

    <span class="n">nexttrg</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">NextTrigger</span><span class="p">()</span>


<span class="c"># From vbuffer.py</span>
<span class="k">def</span> <span class="nf">EUDCreateVariables</span><span class="p">(</span><span class="n">varn</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">List2Assignable</span><span class="p">([</span><span class="n">EUDVariable</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">varn</span><span class="p">)])</span>


<span class="c"># _Basic_SeqCompute. Used only in eudv.py</span>
<span class="k">def</span> <span class="nf">_Basic_SeqCompute</span><span class="p">(</span><span class="n">assignpairs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">dst</span><span class="p">,</span> <span class="n">mdt</span><span class="p">,</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">assignpairs</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dstepd</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">EPD</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">dstepd</span> <span class="o">=</span> <span class="n">dst</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">EUDVariable</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mdt</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">:</span>
                <span class="n">_VProc</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="p">[</span>
                    <span class="n">src</span><span class="o">.</span><span class="n">QueueAssignTo</span><span class="p">(</span><span class="n">dstepd</span><span class="p">)</span>
                <span class="p">])</span>

            <span class="k">elif</span> <span class="n">mdt</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">:</span>
                <span class="n">_VProc</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="p">[</span>
                    <span class="n">src</span><span class="o">.</span><span class="n">QueueAddTo</span><span class="p">(</span><span class="n">dstepd</span><span class="p">)</span>
                <span class="p">])</span>

            <span class="k">elif</span> <span class="n">mdt</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">:</span>
                <span class="n">_VProc</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="p">[</span>
                    <span class="n">src</span><span class="o">.</span><span class="n">QueueSubtractTo</span><span class="p">(</span><span class="n">dstepd</span><span class="p">)</span>
                <span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">SetDeaths</span><span class="p">(</span><span class="n">dstepd</span><span class="p">,</span> <span class="n">mdt</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\varfunc\vbase.py : 44 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">c</span>


<span class="k">class</span> <span class="nc">VariableBase</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">GetVariableMemoryAddr</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;override&#39;</span><span class="p">)</span>

    <span class="c"># -------</span>

    <span class="k">def</span> <span class="nf">AtLeast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">AtMost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">AtMost</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Exactly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">Exactly</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="c"># -------</span>

    <span class="k">def</span> <span class="nf">SetNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">SetTo</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">AddNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">Add</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">SubtractNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">SetMemory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetVariableMemoryAddr</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">Subtract</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="c"># -------</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Exactly</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AtMost</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AtLeast</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</pre></div>
</td></tr></table><br><br><p><h2> eudtrg\varfunc\__init__.py : 13 lines </h2></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.eudv</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EUDVariable</span><span class="p">,</span>
    <span class="n">EUDCreateVariables</span><span class="p">,</span>

    <span class="c"># Some weird thing</span>
    <span class="n">EUDVarBuffer</span><span class="p">,</span>
    <span class="n">SetCurrentVariableBuffer</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.eudlv</span> <span class="kn">import</span> <span class="n">EUDLightVariable</span>
<span class="kn">from</span> <span class="nn">.eudsqc</span> <span class="kn">import</span> <span class="n">SeqCompute</span>
<span class="kn">from</span> <span class="nn">.eudf</span> <span class="kn">import</span> <span class="n">EUDFunc</span><span class="p">,</span> <span class="n">SetVariables</span>
</pre></div>
</td></tr></table><br><br>
    </body>
</html>
